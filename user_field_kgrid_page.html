<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: 3.6.3 K-Grid File Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="user_page.html">3 User Guide</a></li><li class="navelem"><a class="el" href="user_field_page.html">3.6 Field Files</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">3.6.3 K-Grid File Format </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="user_field_rgrid_page.html">3.6.2 R-Grid File Format</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_field_fd1d_page.html">3.6.4 Fd1d File Format</a> (Next) <br  />
</p>
<p >The PSCF CPU and GPU programs for periodic systems can also read and write files in format that gives the unsymmetrized discrete Fourier transform of the field associated with each monomer type. The required file format is very similar to that used for the coordinate space grid. The file consists of a header and a data section. The format of the header is identical to that used for the coordinate grid format, and includes a list of the number of grid points used in each direction, denoted by ngrid.</p>
<p >The data section contains the Fourier coefficients obtained by a discrete Fourier transform of each field at wavevectors given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \textbf{k}(n_1, \ldots, n_{D}) = \sum_{i=1}^{\textrm{D}} n_{i}\textbf{b}_{i} \]" src="form_32.png" width="135" height="40"/>
</p>
<p> where <img class="formulaInl" alt="$D$" src="form_33.png" width="10" height="10"/> is the dimensionality of the crystal (i.e., dim in the header file), <img class="formulaInl" alt="$\textbf{b}_{i}$" src="form_34.png" width="13" height="13"/> is a reciprocal lattice basis vector, <img class="formulaInl" alt="$N_{i}$" src="form_35.png" width="14" height="13"/> is the number of grid points along direction <img class="formulaInl" alt="$i$" src="form_0.png" width="5" height="9"/>, and <img class="formulaInl" alt="$n_{i}$" src="form_36.png" width="13" height="9"/> is an integer in the range <img class="formulaInl" alt="$0 \leq n_{D} \leq N_{1}/2$" src="form_37.png" width="85" height="14"/> for the last index and <img class="formulaInl" alt="$0 \leq n_{i} \leq N_{i} - 1$" src="form_38.png" width="88" height="13"/> for indices <img class="formulaInl" alt="$i &lt; D$" src="form_39.png" width="33" height="11"/>. The number of rows in the data section is equal to the total number of such wavevectors, and each row contains values of Fourier coefficients associated with a single wavevector, with coefficients for fields associated with different monomer types in different columnns.</p>
<p >Coefficients for different wavevectors are output in sequential order, using the last index (e.g., <img class="formulaInl" alt="$n_{3}$" src="form_40.png" width="14" height="9"/> for a 3D crystal) as the most rapidly varying (inner-most) loop index. This is implemented by a fortran loop of the form </p><div class="fragment"><div class="line"><span class="keywordflow">do</span> n1 = 0, ngrid(1) - 1</div>
<div class="line">  <span class="keywordflow">do</span> n2 = 0, ngrid(2) - 1</div>
<div class="line">    <span class="keywordflow">do</span> n3 = 0, ngrid(3)/2</div>
<div class="line">      [Read or <a class="code hl_function" href="group__Format__Module.html#ga9ccb226b62d2b848cd3233c7cee9ba3f">write</a> coefficients <span class="keywordflow">for</span> wavevector k(n1, n2, n3)]</div>
<div class="line">     enddo</div>
<div class="line">  enddo</div>
<div class="line">enddo</div>
<div class="ttc" id="agroup__Format__Module_html_ga9ccb226b62d2b848cd3233c7cee9ba3f"><div class="ttname"><a href="group__Format__Module.html#ga9ccb226b62d2b848cd3233c7cee9ba3f">Util::write</a></div><div class="ttdeci">void write(std::ostream &amp;out, Type data)</div><div class="ttdoc">Function template for output in a standard format.</div><div class="ttdef"><b>Definition:</b> <a href="write_8h_source.html#l00080">write.h:80</a></div></div>
</div><!-- fragment --><p >Note that this is not the same as the way that the k-grid files are written in the Fortran version of PSCF, which have the number of gridpoints halved in the first index (<code>n1</code> in the code above) rather than the last index, as is the case here. This means that k-grid files are not compatible between the two codes.</p>
<p ><br  />
 <a class="el" href="user_field_rgrid_page.html">3.6.2 R-Grid File Format</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_field_page.html">3.6 Field Files</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_field_fd1d_page.html">3.6.4 Fd1d File Format</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 26 2022 14:20:47 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
