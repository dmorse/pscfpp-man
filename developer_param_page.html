<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: 4.4 Parameter File I/O</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v0.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="developer_page.html">4 Developer Information</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">4.4 Parameter File I/O </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="developer_standards_page.html">4.3 Coding Standards</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="developer_test_page.html">4.5 Unit Tests</a> (Next) <br  />
</p>
<p >The format of the parameter file (discussed in <a class="el" href="user_param_page.html">3.2 Parameter Files</a>) consists of a set of nested blocks, in which each block contains the data required to initialize an instance of a particular class. Each class that reads data from the parameter file is derived from the <a class="el" href="classUtil_1_1ParamComposite.html" title="An object that can read multiple parameters from file.">Util::ParamComposite</a> base class, and must provide an implementation of one or the other (but not both) of the following two virtual functions: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> readParameters(std::istream&amp; in);</div>
<div class="line"><span class="keywordtype">void</span> readParam(std::istream&amp; in);</div>
</div><!-- fragment --><p> The readParameters() method to defines the file format for the body of a parameter file block, excluding the lines containing the opening and closing brackets. The readParam() method defines the file format for a parameter file block. The default implementation of ParamComposite::readParam() calls readParameters() and adds opening and closing lines. Most subclasses of ParamComposite re-implement the readParameters() method and rely on the default implementation of readParam() to provide the opening and closing lines. A few (including all the Manager classes) instead re-implement readParam().</p>
<p >The source code for the readParameters() or readParam() method of a class is thus the most reliable documentation of the format of the associated parameter file block. It is thus useful for users, as well as developers, to be able to read the implementation of these method, so that they can check the source code to resolve any questions about the file format. In the examples below, we discuss the implementation of a readParameters() function.</p>
<p >The implementation of readParameters() typically uses a several protected methods that are inherited from the parent <a class="el" href="classUtil_1_1ParamComposite.html" title="An object that can read multiple parameters from file.">Util::ParamComposite</a> class. These are: </p><ul style="list-style: none;">
<li>
read &lt; T &gt;(std::istream&amp; in, const char* label, T&amp; data) is a method template that reads an single parameter of type T.  </li>
<li>
readParamComposite(std::istream&amp; in, ParamComposite&amp; child) invokes the readParam() method of a child ParamComposite object.  </li>
</ul>
<p>In these methods, the parameter "in" represents an input stream. The parameter "label" is a string literal that represents the expect value of the label string for a parameter or a parameter block. Other more specialized read* methods to read parameters that are represented by arrays and matrices are discussed in the class documentation for <a class="el" href="classUtil_1_1ParamComposite.html" title="An object that can read multiple parameters from file.">Util::ParamComposite</a>.</p>
<p >As an example, consider a class A that has an int member variable var1_, a double member var2_, and a member thingy_ that is an instance of another class B: </p><div class="fragment"><div class="line"><span class="keyword">using</span> namepace <a class="code hl_namespace" href="namespaceUtil.html">Util</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>A : <span class="keyword">public</span> ParamComposite </div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// other methods</span></div>
<div class="line"> </div>
<div class="line">   <span class="keywordtype">void</span> readParameters(std::istream&amp; in);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// other methods</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> </div>
<div class="line">   <span class="keywordtype">int</span>    var1_;</div>
<div class="line">   <span class="keywordtype">double</span> var2_;</div>
<div class="line">   B      thingy_;</div>
<div class="line">}</div>
<div class="ttc" id="anamespaceUtil_html"><div class="ttname"><a href="namespaceUtil.html">Util</a></div><div class="ttdoc">Utility classes for scientific computation.</div><div class="ttdef"><b>Definition:</b> <a href="accumulators_8mod_source.html#l00001">accumulators.mod:1</a></div></div>
</div><!-- fragment --><p> We assume here that B is a also subclass of ParamComposite, which is associated with a nested subblock in the parameter file format for class A.</p>
<p >The parameter block format for class A might look like this: </p><div class="fragment"><div class="line">A{</div>
<div class="line">  var1      1</div>
<div class="line">  var2    1.5</div>
<div class="line">  B{</div>
<div class="line">    ...</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> where B{ ... } represents the (unspecified) parameter file format for class B.</p>
<p >The minimum implementation of A::readParam() required to parse this file format is show below: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> A::readParameters(std::istream&amp; in)</div>
<div class="line">{</div>
<div class="line">   read&lt;int&gt;(in, <span class="stringliteral">&quot;var1&quot;</span>, var1_);</div>
<div class="line">   read&lt;double&gt;(in, <span class="stringliteral">&quot;var2&quot;</span>, var2_);</div>
<div class="line">   readParamComposite(in, thingy_);</div>
<div class="line">}</div>
</div><!-- fragment --><p> For a real class, the implementation of readParam() might also contain code to validate input, allocate any required memory, and do whatever else is required to initialize an instance of A.</p>
<p >The expected label strings "var1", and "var2" are all passed as string literals to the relevant read* methods. Each of these methods throws an Exception, and thereby abort program execution, if the expected label is not found. The readParam() method of a ParamComposite also checks that class name before the opening bracket in the opening line of a parameter file block matches the expected class name, or compares this name to a list of possible names in the case of a polymorphic parameter file block.</p>
<p ><br  />
 <a class="el" href="developer_standards_page.html">4.3 Coding Standards</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">4 Developer Information</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="developer_test_page.html">4.5 Unit Tests</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 31 2022 13:32:18 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
