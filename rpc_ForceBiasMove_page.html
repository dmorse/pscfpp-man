<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: ForceBiasMove</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="index.html">PSCF - Polymer Self-Consistent Field</a></li><li class="navelem"><a href="psfts_page.html">Partial Saddle-Point Field Theoretic Simulation (PS-FTS)</a></li><li class="navelem"><a href="psfts_algorithm_page.html">Algorithms</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">ForceBiasMove </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <a class="el" href="classPscf_1_1Rpc_1_1ForceBiasMove.html" title="ForceBiasMove attempts a Brownian dynamics move.">ForceBiasMove</a> classes used by both the pscf_pc and pscf_pg programs implements a MC move for which the attempted move is generated by an <a class="el" href="rpc_ExplicitBdStep_page.html">explicit Euler Brownian dynamics step</a></p>
<p>Two closely analogous classes named <a class="el" href="classPscf_1_1Rpc_1_1ForceBiasMove.html" title="ForceBiasMove attempts a Brownian dynamics move.">Pscf::Rpc::ForceBiasMove</a> and <a class="el" href="classPscf_1_1Rpg_1_1ForceBiasMove.html" title="ForceBiasMove attempts a Brownian dynamics move.">Pscf::Rpg::ForceBiasMove</a> that are defined in different namespaces are used to implement this move algorithm for different programs. The <a class="el" href="classPscf_1_1Rpc_1_1ForceBiasMove.html" title="ForceBiasMove attempts a Brownian dynamics move.">ForceBiasMove</a> class defined in the <a class="el" href="namespacePscf_1_1Rpc.html" title="Real periodic fields, SCFT and PS-FTS (CPU).">Rpc</a> namespace is used in the pscf_pc program (using CPU hardware) and the class defined in the <a class="el" href="namespacePscf_1_1Rpg.html" title="SCFT and PS-FTS with real periodic fields (GPU)">Rpg</a> namespace is used in the pscf_pg program (using GPU acceleration). These two classes implement the same step algorithm and use the same parameter file format, which are documented below.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classPscf_1_1Rpc_1_1ForceBiasMove.html" title="ForceBiasMove attempts a Brownian dynamics move.">ForceBiasMove</a> (class API)</dd></dl>
<h1 class="doxsection"><a class="anchor" id="rpc_ForceBiasMove_algorithm_sec"></a>
Step Algorithm</h1>
<p>A general discussion of MC move algorithms for PS-FTS is given on a <a class="el" href="psfts_algorithm_page.html#psfts_algorithm_MC_sec">separate page</a>. As discussed there, each move consists of an unconstrained change in the fields, followed by application of a compressor to re-impose the incompressibility constraint. The decision about whether to accept or reject the move is based on the value of the Hamiltonian after incompressibility has been restored.</p>
<p>The <a class="el" href="classPscf_1_1Rpc_1_1ForceBiasMove.html" title="ForceBiasMove attempts a Brownian dynamics move.">ForceBiasMove</a> uses an explicit Euler Brownian dynamics (BD) step as an unconstrained move. The explicit Euler BD move is identical to the one implemented by the <a class="el" href="rpc_ExplicitBdStep_page.html">ExplicitBdStep</a> class defined in either the <a class="el" href="namespacePscf_1_1Rpc.html" title="Real periodic fields, SCFT and PS-FTS (CPU).">Rpc</a> or <a class="el" href="namespacePscf_1_1Rpg.html" title="SCFT and PS-FTS with real periodic fields (GPU)">Rpg</a> namespace. The only parameter required to generate such an attempted move is the mobility parameter used in this underlying BD step. This parameter is denoted by the label "mobility" in the parameter file and in the source code, and by the symbol \( \gamma \) in mathematical formulas.</p>
<p>The change in \( W_{-}({\bf r}) \) generated by an explicit BD step is given by the sum    </p><p class="formulaDsp">
\[    \Delta W_{-}({\bf r}) = - \gamma \delta H/\delta W_{-}({\bf r}) 
    + g({\bf r})
\]
</p>
<p> of a Gaussian distributed random component \( g({\bf r}) \) plus a "force bias" \( -\gamma \delta H/\delta W_{-}({\bf r}) \).</p>
<p>The acceptance criterion for a <a class="el" href="classPscf_1_1Rpc_1_1ForceBiasMove.html" title="ForceBiasMove attempts a Brownian dynamics move.">ForceBiasMove</a> is designed to satisfy detailed balance by taking into account the effect of the force bias on both the probability of generating a specific change \( \Delta W_{-}({\bf r}) \) and the probability of generating the hypothetical reverse move starting from the final state obtained at the end of the attempted move, after adjustment of \( W_{+} \) so as to satisfy the partial saddle-point constraint. Evaluation of the acceptance probability thus requires evalatuation of the force bias (i.e., the functional derivative) as well as the Hamiltonian value in the final state that is obtained after applying the compressor algorithm.</p>
<p>The use of a force bias allows for much higher acceptance rates than those obtained from the <a class="el" href="classPscf_1_1Rpc_1_1RealMove.html" title="RealMove generates spatially uncorrelated random field changes.">RealMove</a>, for choices of parameters that yield similar magnitude changes in the fields.</p>
<h1 class="doxsection"><a class="anchor" id="rpc_ForceBiasMove_parameter_sec"></a>
Parameter File</h1>
<p>The only parameters needed by this algorithm are the "probability" parameter, which determines the probability that a move of this type will be attempted, and a required parameter named "mobility", which is the mobility parameter of the explicit BD step. A typical example of an associated parameter file block is shown below. </p><div class="fragment"><div class="line">ForceBiasMove{</div>
<div class="line">  probability   0.5</div>
<div class="line">  mobility      0.005</div>
<div class="line">}</div>
</div><!-- fragment --><p> The format for this block is thus: </p><div class="fragment"><div class="line">ForceBiasMove{</div>
<div class="line">  probability  float (in range [0,1])</div>
<div class="line">  mobility     <span class="keywordtype">float</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> The meanings of both parameter are summarized briefly below: </p><table class="doxtable">
<tr>
<td><b> <a class="el" href="classUtil_1_1Label.html" title="A label string in a file format.">Label</a> </b> </td><td><b> Description </b> </td></tr>
<tr>
<td>probability </td><td>probability of attempting a step of this type </td></tr>
<tr>
<td>mobility </td><td>Mobility parameter of underlying attempted BD step </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
