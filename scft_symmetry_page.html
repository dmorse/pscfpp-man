<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Appendix: Space Group Symmetry</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="scft_page.html">Self-Consistent Field Theory</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Appendix: Space Group Symmetry</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="scft_fourier_page.html">Appendix: Periodic Functions and Fourier Series</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_basis_page.html">Appendix: Symmetry-Adapted Bases</a> (Next) &#160; &#160; &#160; &#160; <br  />
</p>
<p>The space group of a crystal is a set of symmetry operations under which the structure is invariant. Crystal symmetry operations, also known as space group operations, can generally involve combinations of point group operations and translations by fractions of a unit cell. Point group operations are linear operators that describe transformations such as inversion through the origin, reflection through a plane, or rotation around a symmetry axis by some fraction of a full rotation. Point group operations may be represented explicitly by matrices.</p>
<p>Below, we give a succinct discussion of space group symmetry, with an emphasis on aspects used in the PSCF software. Readers who have not encountered these ideas elsewhere may find it useful to also consult a textbook, for which we recommend the book <em>Structure of Materials: An Introduction to Crystallography, Diffraction and Symmetry</em> by Marc De Graef and Michael E. McHenry.</p>
<h1><a class="anchor" id="scft_symmetry_ops_sec"></a>
Crystal symmetry operations</h1>
<p><a class="anchor" id="scft_symmetry_operation_def"></a><b> Definition (Crystal symmetry operation) </b>: Every crystal symmetry operation \( A \) is a function that maps every position \( {\bf r} \) within a crystal onto a new position \( A({\bf r}) \), of the form   </p><p class="formulaDsp">
\[
   A({\bf r}) =  R {\bf r} + {\bf t}
\]
</p>
<p> in which \( R \) is an invertible linear operator that acts on the vector \( {\bf r} \) to its right by applying a point group operation (e.g., a reflection, rotation, or inversion), and in which \( {\bf t}\) is a translation vector. The translation vector associated with a space group symmetry operation can be zero, giving a pure point group operation, or can be a sum of translations by rational fractions of a unit cell along Bravais lattice basis vectors.</p>
<p><b> Notation (Vectors and dot products) </b>: Here and hereafter, we use bold faced symbols to denote real D-dimensional vectors such as \( {\bf r} \) or \( {\bf t} \). We define an inner-product space for vectors by defining the dot product \( {\bf a}\cdot{\bf b} \) of two vectors to be given by the usual Euclidean norm computed using a Cartesian vector components. The norm of a vector, denoted by \( |{\bf a}| \), is then given by the Cartesian norm   </p><p class="formulaDsp">
\[
     |{\bf a}| = \sqrt{{\bf a}\cdot{\bf a}}
\]
</p>
<p><b> Orthogonality of point group operations </b>: Point group operations are always orthogonal transformations. That is, for any point group operator \( R \),   </p><p class="formulaDsp">
\[
   |R{\bf v}| = |{\bf v}|
\]
</p>
<p> for any vector \( {\bf v} \).</p>
<p><b> Definition (Adjoint of a point group operator) </b> The adjoint of any linear operator \( R \) in the space of real D-dimensional vectors is denoted here by \( R^{\dagger} \). The adjoint is defined by the requirement that <a class="anchor" id="scft_symmetry_adjoint_def_eqn"></a>   </p><p class="formulaDsp">
\[
  (R^{\dagger}{\bf a}) \cdot {\bf b} = {\bf a} \cdot (R {\bf b})
\]
</p>
<p> for any two D-dimensional vectors \( {\bf a} \) and \( {\bf b} \) in this space.</p>
<p><a class="anchor" id="scft_symmetry_multiplication_def"></a><b> Definition (Multiplication of crystal symmetry operations) </b>: Multiplication of symmetry operations is defined such that the product \( AB \) of two symmetry operations \( A \) and \( B \) is the operation whose effect on a vector is given by applying \( B \) followed by \( A \). That is, if \( A \), \( B \), and \( C \) are crystal symmetry operations, such that   </p><p class="formulaDsp">
\[
   C = AB
\]
</p>
<p> then   </p><p class="formulaDsp">
\[
     C({\bf r}) \equiv A(B({\bf r})) \quad.
\]
</p>
<p> Multiplication of symmetry operations is not commutative: Generally, \( AB \neq BA \).</p>
<p><a class="anchor" id="scft_symmetry_multiplication_thrm"></a><b> Theorem C.1 (Multiplication rule for crystal symmetry operations) </b>: If \( A \), \( B \) are two symmetry operations    </p><p class="formulaDsp">
\[
   A = (R_{A}, {\bf t}_{A}) \quad
   B = (R_{B}, {\bf t}_{B}) \quad
\]
</p>
<p> and \( C = AB \) is their product, then   </p><p class="formulaDsp">
\[
   C = AB = (R_{C}, {\bf t}_{C}) \quad,
\]
</p>
<p> with    </p><p class="formulaDsp">
\[
   R_{C} = R_{A}R_{B} \quad
   {\bf t}_{C} = {\bf t}_{A} + R_{A}{\bf t}_{B} \quad.
\]
</p>
<p><em> Proof </em>: Observe that \( C({\bf r}) = A(B({\bf r})) \) for any vector \( {\bf r} \), and that     </p><p class="formulaDsp">
\[
   A(B({\bf r}))
   = A(R_{B}{\bf r} + {\bf t}_{B})
   = R_{A} R_{B} {\bf r} + R_{A} {\bf t}_{B} + {\bf t}_{A} \quad.
\]
</p>
<p><a class="anchor" id="scft_symmetry_identity_def"></a><b> Identity operation </b>: The identity operation, denoted by \( E \), is the trivial crystal symmetry operation that maps every position onto itself, so that   </p><p class="formulaDsp">
\[
   E({\bf r}) = {\bf r}  \quad.
\]
</p>
<p> This is represented by a pair   </p><p class="formulaDsp">
\[
   E = (I, 0) \quad,
\]
</p>
<p> in which we use \( I \) to denote the identity point group operation, for which the matrix representation in any basis is an identity matrix. Mutlplication of any other symmetry operation \( A \) by the identity leaves \( A \) unchanged, such that \( EA = AE = A \).</p>
<p><a class="anchor" id="scft_symmetry_identity_thrm"></a><b> Defininition (Inverse of a space group operation) </b>: Every crystal symmetry operation \( A \) has an inverse, denoted by \( A^{-1} \), which is defined such that   </p><p class="formulaDsp">
\[
   A^{-1}A = A A^{-1} = E \quad.
\]
</p>
<p> The identity element is equal its own inverse, since \( EE = E \).</p>
<p><b> Theorem C.2 (Inversion rule for crystal symmetry operations)</b> : If \(A\) is a crystal symmetry operation   </p><p class="formulaDsp">
\[
   A = (R, {\bf t})
\]
</p>
<p> with point group operation \(R\) and translation vector \({\bf t}\), then   </p><p class="formulaDsp">
\[
   A^{-1} = (R^{-1}, -R^{-1}{\bf t}) \quad.
\]
</p>
<p><em> Proof </em>: Use the <a class="el" href="#scft_symmetry_multiplication_thrm">multiplication rule</a> to confirm that \( A^{-1}A = A A^{-1} = (I, 0) = E \).</p>
<h1><a class="anchor" id="scft_symmetry_group_sec"></a>
Space groups</h1>
<p><b> Definition (Space group) </b> A space group \( S \) is a set of crystal symmetry operations for which multiplication is defined as discussed <a class="el" href="#scft_symmetry_multiplication_def">above</a>, and which obey the following rules:</p>
<ul>
<li>Inclusion of identity: \( S \) must include the identity \( E \)</li>
<li>Closure under inversion: If \( S \) contains an element \( A \), \( S \) must also contain \( A^{-1} \).</li>
<li>Closure under multiplication: If \( S \) contains \( A \) and \( B \), it must also contain the product \( A B \).</li>
</ul>
<p>The set of possible distinct crystallographic space groups is finite and known. There are 230 possible 3D space groups, 17 possible 2D plane groups, and 2 possible symmetry groups in 1D, as discussed <a class="el" href="scft_groups_page.html">here</a>. The pscfpp/data/groups directory contains a set of files that each list all of the symmetry operations for one of these groups.</p>
<h1><a class="anchor" id="scft_symmetry_components_sec"></a>
Bases and vector components</h1>
<p>Different vector bases are used in PSCF to define components of vectors that represent positions or translations and for vectors that represent reciprocal lattice wavevectors.</p>
<h2><a class="anchor" id="scft_symmetry_components_bravais_sub"></a>
Bravais Basis (Positions and Translations)</h2>
<p>It is convenient for to define components of position vectors such as a position \( {\bf r} \) or a translation vector \( {\bf t} \) using a basis of Bravais lattice basis vectors. We refer to this as a Bravais basis. Any position vector \( {\bf r} \) may be expressed in a Bravais basis as a sum   </p><p class="formulaDsp">
\[
  {\bf r} = \sum_{i=0}^{D-1} r_{i}{\bf a}_{i}
\]
</p>
<p> in which \( {\bf a}_{0},\ldots, {\bf a}_{D-1} \) are Bravais lattice basis vectors, while \( r_{0}, \ldots, r_{D-1} \) are components of \( {\bf r} \) in this basis, also known as reduced coordinates. Similarly, the translational vector \( {\bf t} \) associated with a space group symmetry may be expressed as a sum   </p><p class="formulaDsp">
\[
  {\bf t} = t_{0}{\bf a}_{0} + \cdots t_{D-1}{\bf a}_{D-1}
\]
</p>
<p> in which the components \( t_{0}, \ldots, t_{D-1} \) are all rational numbers (i.e., fractions) with small denominators, such as \( \pm 1/2 \), \( 1/4 \), \( 2/3 \), etc.</p>
<p>Notation: Here and hereafer, we use a notation in which the components of a vector \( {\bf a} \) in a specified basis are denoted by subscripted variables \( a_{0}, \ldots, a_{D-1} \), using bold- and non-bold faced versions of the same symbol for a vector and its components.</p>
<p>A representation of a point group operator \( R \) as a matrix may be defined by using a Bravais basis to define the components of the transformed vector \( R{\bf r} \) for any vector \( {\bf r} \). This gives a representation of the \( R{\bf r} \) as a sum     </p><p class="formulaDsp">
\[
   R {\bf r} =
   \sum_{i=0}^{D-1} \sum_{j=0}^{D-1}
   {\bf a}_{i} R_{ij} r_{j}
\]
</p>
<p> where \( (r_{0}, \ldots, r_{D-1}) \) are components of \( {\bf r} \) and \( R_{ij} \) denotes a matrix element of \( R \) in a Bravais basis. The matrix representation of a point group operation in a Bravais basis must have matrix elements that are all integers (usually 0, 1, or -1), in order to guarantee that this operation maps all Bravais lattice vectors onto other Bravais lattice vectors.</p>
<p><em> Relationship to source code </em>: PSCF stores the representation of each symmetry operation \( A \) internally as a pair   </p><p class="formulaDsp">
\[
    A = (R, {\bf t})
\]
</p>
<p> in which \( R \) is represented as a \( D \times D \) matrix with integer matrix elements and \( {\bf t} \) is represented as a vector with \( D \) components that are represented as rational numbers (i.e., ratios of two integers), in which elements of both \( R \) and \( t \) are defined in a Bravais basis. Each such space group symmetry is represented by an instantiation of a C++ class template Pscf::SpaceSymmetry for which the dimension of space \( D \) is a template parameter, giving a class Pscf::SpaceSymmetry&lt;D&gt;. Each component of the translation vector \( {\bf t} \) is represented by an instance of class <a class="el" href="classUtil_1_1Rational.html" title="A Rational number (a ratio of integers).">Util::Rational</a>, which represents a rational number.</p>
<h2><a class="anchor" id="scft_symmetry_components_reciprocal_sub"></a>
Reciprocal Basis (Wavevectors)</h2>
<p>It is convenient to express reciprocal lattice wavevectors in a basis of reciprocal lattice basis vectors, which we refer to as a reciprocal basis. In this representation, each reciprocal lattice wavevector \( G \) is expressed as a linear combination   </p><p class="formulaDsp">
\[
  {\bf G} = \sum_{i=0}^{D-1} G_{i}{\bf b}_{i}
\]
</p>
<p> in which \( {\bf b}_{0}, \ldots, {\bf b}_{D-1} \) are reciprocal lattice basis vectors, defined such that   </p><p class="formulaDsp">
\[
  {\bf a}_{i}\cdot{\bf b}_{j} = 2\pi \delta_{ij} \quad,
\]
</p>
<p> for all \( i, j = 0, \ldots, D-1\), and in which \( G_{0}, \ldots, G_{D-1} \) are integer components (Miller indices).</p>
<p>When a reciprocal basis is used for a wavevector \( {\bf G} \) and a Bravais basis is used for a position \( {\bf r} \), then the dot product \( {\bf G}\cdot{\bf r} \) may be expressed as a sum    </p><p class="formulaDsp">
\[
   {\bf G} \cdot {\bf r}
   = 2\pi \sum_{i=0}^{D-1} G_{i} r_{i} \quad,
\]
</p>
<p> where \( G_{0}, \ldots, G_{D-1} \) are the integer components of \( {\bf G} \) in a reciprocal basis and \( r_{0}, \ldots, r_{D-1} \) are components of \( {\bf r} \) in a Bravais basis (reduced coordinates).</p>
<h2><a class="anchor" id="scft_symmetry_adjoint_matrix_sub"></a>
Adjoint Operators</h2>
<p><b> Theorem C.3 (Matrix representation of an adjoint operator) </b>: Suppose \( R \) is a linear operator such as a point group operation in the inner-product space of D-dimensional real vectors, and that \( R^{\dagger} \) is the adjoint of \( R \). The matrix representation of \( R^{\dagger} \) defined using a reciprocal basis is given by the transpose of the matrix representation of \( R \) defined using a Bravais basis.</p>
<p><em> Proof </em>: Suppose that \( {\bf G} \) is a reciprocal lattice vector, \( R \) is a linear operator such as a point group operation, and   </p><p class="formulaDsp">
\[
  {\bf G}&#39; = R^{\dagger}{\bf G} \quad.
\]
</p>
<p> To define \( R^{\dagger}{\bf G} \), we consider the dot product     </p><p class="formulaDsp">
\[
   {\bf G}&#39;\cdot{\bf r} = 
   (R^{\dagger} {\bf G}) \cdot {\bf r} =
   {\bf G}\cdot (R{\bf r}) \quad,
\]
</p>
<p> for arbitrary \( {\bf G} \) and \( {\bf r} \) . By using a Bravais basis for \( {\bf r} \) and a reciprocal basis for \( {\bf G} \), we find that    </p><p class="formulaDsp">
\[
   {\bf G}&#39; \cdot {\bf r} = 2\pi
   \sum_{i=0}^{D-1} \sum_{j=0}^{D-1} G_{i}R_{ij}r_{j} \quad,
\]
</p>
<p> where \( (r_{0}, \ldots, r_{D-1}) \) are components of \( {\bf r} \) in a Bravais basis, \( (G_{0}, \ldots, G_{D-1}) \) are components of \( {\bf G} \) in a reciprocal basis, and \( R_{ij} \) denotes an element of the matrix representation of \( R \) in a Bravais basis. This expression implies that \( {\bf G}&#39; \) may be expanded in a reciprocal basis as a sum   </p><p class="formulaDsp">
\[
  {\bf G}&#39; = \sum_{j=0}^{D-1} G_{j}&#39; {\bf b}_{j}
\]
</p>
<p> with components     </p><p class="formulaDsp">
\[
  G_{j}&#39;
  = \sum_{i=0}^{D-1} G_{i} R_{ij} = \sum_{i=0}^{D-1} R_{ji}^{T} G_{i}
  \quad,
\]
</p>
<p> where \( R_{ji}^{T} \) denotes element \( (j, i) \) of the matrix transpose of the matrix representation of \( R \) in a Bravais basis, completing the proof.</p>
<h1><a class="anchor" id="scft_symmetry_symmfunc_sec"></a>
Transformation of fields</h1>
<p><b> Definition (Field) </b>: We refer to any complex-valued periodic function of D-dimensional position within a crystal as a <em> field</em>. A real field has real values at any position.</p>
<p><b> Notation (Transformation of fields) </b>: If \( f \) is a field and \( A \) is a crystal symmetry operation, then the notation   </p><p class="formulaDsp">
\[
    f&#39; = fA
\]
</p>
<p> indicates that \( f&#39; \) is a field for which   </p><p class="formulaDsp">
\[
  f&#39;({\bf r}) = f(A({\bf r}))
\]
</p>
<p> for all \( {\bf r} \).</p>
<p><a class="anchor" id="scft_symmetry_symmfunc_def"></a><b> Definition (Symmetric fields) </b>: A field \( f({\bf r}) \) is said to be symmetric or invariant under a space group \( S \) if \( fA = f \) or (equivalently)   </p><p class="formulaDsp">
\[
   f(A({\bf r})) = f({\bf r})
\]
</p>
<p> for every crystal symmetry operation \( A \in S \).</p>
<p>The following two simple theorems apply to such symmetric functions:</p>
<p><a class="anchor" id="scft_symmetry_symmfunc_mult_thrm"></a><b> Theorem C.4 (Symmetry is preserved by scalar multiplication)</b>: If \( f({\bf r}) \) is a field that is symmetric under a space group \( S \), and \( c \) is complex constant, then \( cf({\bf r}) \) is also symmetric under \( S \).</p>
<p><a class="anchor" id="scft_symmetry_symmfunc_conj_thrm"></a><b> Theorem C.5 (Symmetry is preserved by complex conjugation)</b>: If \( f({\bf r}) \) is a complex field that is symmetric under a space group \( S \), its complex conjugate \( f^{*}({\bf r}) \) is also invariant under \( S \). This also implies that the real and imaginary parts of a symmetric complex-valued function are also symmetric under \( S \).</p>
<p><em>Proofs</em> : Suppose \( A = (R, {\bf t}) \) be a symmetry operation in \( S \). If \( f(R{\bf r} + {\bf t}) = f({\bf r})\) for all \( {\bf r} \), then \( c f(R{\bf r} + {\bf t}) = c f({\bf r}) \) and \( f^{*}(R{\bf r} + {\bf t}) = f^{*}({\bf r}) \), proving both of the above theorems.</p>
<h1><a class="anchor" id="scft_symmetry_wave_sec"></a>
Transformation of plane waves</h1>
<p>To construct basis functions, we consider the effect of space group operations on a field that is expressed as a general Fourier series. As a first step, it useful to consider the effect of a symmetry operation on a single complex-exponential wave. The following definition and notation are used to simplify the discussion:</p>
<p><b> Definition (Plane wave) </b>: A wave or plane wave \( f \) is a complex field of the form   </p><p class="formulaDsp">
\[
   f({\bf r}) = ce^{i{\bf G}\cdot{\bf r}}
\]
</p>
<p> in which \( c \) is a constant prefactor and \( {\bf G} \) is a wavevector. A wave has the periodicity of a specified Bravais lattice if and only if \( {\bf G} \) is in the associated reciprocal lattice.</p>
<p><b> Notation (Wave) </b>: A wave \( f \) can be described compactly as a pair   </p><p class="formulaDsp">
\[
   f = ({\bf G}, c)
\]
</p>
<p> in which \( {\bf G} \) denotes the associated wavevector and \( c \) is the prefactor.</p>
<p><b> Theorem C.6 (Transformation of plane waves) </b>: If \( f = ({\bf G}, c) \) is a wave and \( A=(R,{\bf t}) \) is a space group symmetry operation, then \( fA \) is a wave   </p><p class="formulaDsp">
\[
   fA = ({\bf G}&#39;, c&#39;)
\]
</p>
<p> with a modified wavevector   </p><p class="formulaDsp">
\[
   {\bf G}&#39; = R^{\dagger}{\bf G}
\]
</p>
<p> and a modified prefactor   </p><p class="formulaDsp">
\[
   c&#39; =  c e^{i{\bf G} \cdot {\bf t}}  \quad.
\]
</p>
<p><em> Proof </em>: Let \( f&#39; = fA \) denote the field that is obtained by applying symmetry operation operation \( A = (R, {\bf t}) \) to a wave \( f({\bf r}) = c e^{i {\bf G}\cdot {\bf r}} \). The resulting function is given explicitly by     </p><p class="formulaDsp">
\[
   f&#39;({\bf r}) = f(A({\bf r}))
   =  c e^{i{\bf G} \cdot (R{\bf r} + {\bf t}) }
   \quad.
\]
</p>
<p> By using the definition of an adjoint to write   </p><p class="formulaDsp">
\[
   {\bf G}\cdot (R{\bf r}) \equiv (R^{\dagger}{\bf G})\cdot {\bf r}
\]
</p>
<p> we may rewrite this function as a plane wave   </p><p class="formulaDsp">
\[
   f&#39;({\bf r}) =  c&#39; e^{ i {\bf G}&#39; \cdot {\bf r}}
\]
</p>
<p> with values of \( {\bf G}&#39; \) and \( c&#39; \) given in the theorem statement.</p>
<p>It is straightforward to confirm that this transformation of waves is invertible: If \( f&#39; = fA \) then \( f = f&#39;A^{-1} \). Two waves that are related in this way can be said to related by the symmetry operation \( A \), or by \( A^{-1} \).</p>
<p><b> Notation (Transformation of wavevectors) </b>: If \( {\bf G} \) is a wavevector and \( A= (R, {\bf t}) \) is a space group symmetry operation, then we define \( {\bf G}A \) to be the wavevector of a wave that is obtained by applying symmetry operation \( A \) to a wave with wavevector \( {\bf G} \), giving   </p><p class="formulaDsp">
\[
  {\bf G}A \equiv R^{\dagger}{\bf G} \quad.
\]
</p>
<p> It is straightforward to show that, for two wavevectors \( {\bf G} \) and \( {\bf G}&#39; \) and a symmetry operation \( A \), the equations \( {\bf G}&#39; = {\bf G}A \) and \( {\bf G} = {\bf G}&#39;A^{-1} \) are equivalent. Two wavevectors that are related in this way can said to be related by symmetry operation \( A \) or \( A^{-1} \).</p>
<p>Observe that the notation defined above, in which the operator appears to the right of the wavevector on which it acts, allows us to treat application of symmetry operators to wavevectors as an associative operation. That is, if \( A = (R_{A}, {\bf t}_{A} )\) and \( B=(R_{B}, {\bf t}_{B} ) \) are crystal symmetry operations and \( {\bf G} \) is a wavevector, then     </p><p class="formulaDsp">
\[
   ({\bf G}A)B = R_{B}^{\dagger}(R_{A}^{\dagger}{\bf G}) = 
   (R_{A}R_{B})^{\dagger}{\bf G}
   = {\bf G}(AB) \quad,
\]
</p>
<p> where \( AB \) denotes a product of symmetry operations, defined such that \( (AB)({\bf r}) = A(B({\bf r})) \) for any \( {\bf r} \).</p>
<h1><a class="anchor" id="scft_symmetry_mesh_sec"></a>
Symmetry transformations on a mesh</h1>
<p>Numerical computations in the PSCF programs for periodic systems are performed using periodic fields that are actually defined only at positions corresponding to the the nodes of a regular mesh. Fourier transforms for such functions are defined by a discrete Fourier transform, using sums over mesh nodes rather than integrals. In order for us to define the transformation of a function that is defined on such a mesh by a crystal symmetry operations, we must require that set of positions occupied by nodes of the mesh be invariant under all symmetry operations in that group, in the following sense:</p>
<p><a class="anchor" id="scft_symmetry_invariant_def"></a><b> Definition (Invariant Mesh) </b>: A regular mesh of values for the reduced position coordinates within a unit cell of a crystal is said to be invariant under a crystal symmetry operation \( A \) if, for every position \( {\bf r} \) of a node of the mesh, the transformed position \( A({\bf r}) \) is also the location of a node of the original mesh. Such a mesh is said to be invariant under a space group \( S \) if it is invariant under every symmetry operation in space group \( S \).</p>
<p>If \( f \) is a function that is defined on the nodes of a mesh, and \( A \) is a symmetry operation, then a transformed function \( fA \) can be defined on the same mesh if and only if the mesh is invariant under \( A \). If a mesh is invariant under \( A \), then we may define a transformed function \( f&#39; = fA \) by requiring that \( f&#39;({\bf r}) = f(A({\bf r})) \) for all values of \( {\bf r} \) that lie on the nodes of the mesh, thereby obtaining a relationship between values of \( f \) and \( f&#39; \) on these nodes. Conversely, if \( f \) is defined on a mesh that is <em>not</em> invariant under symmetry operation \( A \), then we cannot define a transformed function \( f A \) on the same mesh.</p>
<p>To apply arguments about space group symmetry to functions that are defined only on the nodes of a mesh, it is thus necessary to require that we consider a mesh that is invariant under the space group of interest. In practice, this requirement imposes two types constraints on the users choice of values for the number of mesh points along each direction, or each Bravais lattice vector:</p>
<p>The first type of constraint requires that, if there exist symmetry operations in the space group for which the point group operation maps one Bravais lattice basis vector onto another of equal magnitude, an equal number of mesh points must be used along the two associated directions. Operations that can impose this type of constraint include diagonal reflections in cubic or tetragonal 3D lattices and 3 or 4 fold rotations. This requirement implies, for example, that equal numbers of mesh points must be used along all orthogonal directions in a 3D cubic or 2D square lattice, along directions associated with different Bravais basis vectors of a 2D hexagonal lattice, or along the two directions that are related by symmetry in a 3D tetragonal lattice.</p>
<p>A second type of constraint requires that the number of mesh points along each direction must be chosen so that the mesh is invariant under all translations associated with elements of the space group. For example, if a space group contains any symmetry operation for which the translation vector \( {\bf t} \) has a component associated with a particular direction that is equal to 1/4 when expressed in a Bravais basis, then the number of mesh points along that direction must be a multiple of 4.</p>
<p>PSCF requires that the user enter mesh dimensions that yield a mesh that is invariant under the space group, in the sense described above. If this condition is not satisfied, the function that constructs symmetry-adapted basis functions will print an error message indicating the nature of the problem and then halt execution.</p>
<p><br  />
 <a class="el" href="scft_fourier_page.html">Appendix: Periodic Functions and Fourier Series</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_page.html">Self-Consistent Field Theory</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="scft_basis_page.html">Appendix: Symmetry-Adapted Bases</a> (Next) &#160; &#160; &#160; &#160; </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 14 2025 16:24:04 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
