<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: R1d::NrIterator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="scft_page.html">Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="scft_param_page.html">Parameter Files</a></li><li class="navelem"><a class="el" href="scft_param_1d_page.html">Parameter File - pscf_1d</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">R1d::NrIterator</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A Pscf::R1d::NrIterator&lt;D&gt; object is an iterator that solves the SCFT equations using the Newton-Raphson method. The only user-defined parameters are the max number of iterations (maxItr) and the error tolerance (epsilon).</p>
<p>The cost of the NR algorithm used here increases rapidly with the number of grid points, and becomes inefficient for problems with greater than roughly 1000 grid points. The algorithm converges in very few iterations from a good initial guess, but has a high computational cost per iteration, and is not particularly robust in the face of a poor initial guess.</p>
<h1><a class="anchor" id="r1d_NrIterator_param_sec"></a>
Parameter File</h1>
<p>The parameter file format for an <a class="el" href="classPscf_1_1R1d_1_1NrIterator.html" title="Newton-Raphson Iterator for SCF equations.">R1d::NrIterator</a> object is: </p><div class="fragment"><div class="line">NrIterator{</div>
<div class="line">   epsilon     <a class="code hl_function" href="group__Pscf__Math__Complex__Module.html#gadc3b10b3f2a06e8f2aee5527031c076b">real</a></div>
<div class="line">   maxItr*     int (100 by <span class="keywordflow">default</span>)</div>
<div class="line">}</div>
<div class="ttc" id="agroup__Pscf__Math__Complex__Module_html_gadc3b10b3f2a06e8f2aee5527031c076b"><div class="ttname"><a href="group__Pscf__Math__Complex__Module.html#gadc3b10b3f2a06e8f2aee5527031c076b">Pscf::real</a></div><div class="ttdeci">RT real(CT const &amp;a)</div><div class="ttdoc">Return the real part of a complex number.</div></div>
</div><!-- fragment --><p> Note that maxItr is an optional parameter, which is set to 100 by default. Parameters are described below: </p><table class="doxtable">
<tr>
<td>epsilon  </td><td>Error tolerance.  </td></tr>
<tr>
<td>maxItr*  </td><td>maximum number of iterations attempted (optional, 100 by default)   </td></tr>
</table>
<p>Iteration stops when every element of the residual vector (described below) has an absolute magnitude less than epsilon.</p>
<h1><a class="anchor" id="r1d_NrIterator_residual_sec"></a>
Residual Definition</h1>
<p>This iterator defines nMonomer residual expressions at each grid point, and stops iteration when the resulting vector of residuals is zero to within some tolerance. In what follows, to describe how the residuals are defined , we use zero based indices monomer types, and use the notation \( M \) to denote the number of monomer types, which is labelled nMonomer in the parameter file. All but one of the residuals at each grid point are derived from the self-consistent field (SCF) equations, while the last residual at each grid point imposes incompressibility.</p>
<p>The SCF equations at each grid point require that a quantity \( g_{i} \) vanish for each mononomer type \( i = 0, \ldots, M - 1\), where    </p><p class="formulaDsp">
\[
    g_{i} \equiv
    \sum_{j=0}^{M-1} \chi_{ij}\phi_{j} + \xi - w_{i} 
\]
</p>
<p> where \( \phi_{i} \) and \( w_{i} \) are the volume fraction and chemical potential field for monomers of type i, \( \xi \) is a Langrange multiplier pressure field, and where all fields are evaluated at the same location (i.e., the same grid point). The first \( M \) residuals at each grid point, which we denote by \( r_{0}, \ldots, r_{M - 2} \), are given by differences   </p><p class="formulaDsp">
\[
  r_{i} = g_{i+1} - g_{0}
\]
</p>
<p> between values of \( g_{j} \) for monomer indices i+1 and 0.</p>
<p>The last residual at each grid point is given by the difference    </p><p class="formulaDsp">
\[
  r_{M-1} = 
  \sum_{i=0}^{M-1}\phi_{i} - 1
\]
</p>
<p> between the sum of volume fractions and unity.</p>
<h1><a class="anchor" id="r1d_NrIterator_canonical_sec"></a>
Closed Systems (Canonical Ensemble)</h1>
<p>The residual equations must be modified slightly for the case in which a value of phi rather than mu is specified for every molecular species, giving a closed system or a canonical statistical mechanical ensemble. In this case, it may be shown that the solution of the modified diffusion equation yields concentration fields for which the spatial average of the sum of volume fractions of all species, averaged over the domain volume, is always exactly equal to 1, for any choice of w fields. This means that, in this case, one of the incompressibility constraints is redundant, since the incompressibility constraint at the last grid point would automatically satisfied if the constraints at the other points were all satisfied. In addition, in this case, the solution of the SCF equations is also not unique, because the residual values can be shown to be invariant under a shift in the Lagrange multiplier field at all grid point points by any spatially homgeneous constant. To address both problems, in the case of a closed system, the incompressibility constraint at the last grid point is replaced by a requirement that the w field value for the last monomer type must equal zero at this grid point, by convention. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 14 2025 16:29:26 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
