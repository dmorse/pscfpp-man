<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Field File - R-Grid (Periodic)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="index.html">PSCF - Polymer Self-Consistent Field</a></li><li class="navelem"><a href="scft_page.html">Self-Consistent Field Theory</a></li><li class="navelem"><a href="scft_field_page.html">Field Files</a></li><li class="navelem"><a href="scft_field_periodic_page.html">Field File - Periodic Fields (pscf_pc and pscf_pg)</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Field File - R-Grid (Periodic) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="scft_field_basis_page.html">Field File - Symmetrized Basis (Periodic)</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_field_kgrid_page.html">Field File - K-Grid (Periodic)</a> (Next) <br  />
</p>
<p>The r-grid file format is used by the pscf_pc and pscf_pg programs to describe fields in a spatially periodic microstructure. This format outputs the values of set of fields on the nodes of a regular mesh that covers one unit cell of a periodic structure. This mesh is the same one as that used by the pseudo-spectral algorithm for solving the modified diffusion equation.</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_rgrid_hex_sec"></a>
Example: 2D Hex Phase</h1>
<p>Here is example of a converged omega field for a hex phase of a diblock copolymer melt:</p>
<div class="fragment"><div class="line"> format  1  0</div>
<div class="line">dim                 </div>
<div class="line">                   2</div>
<div class="line">crystal_system      </div>
<div class="line">           hexagonal</div>
<div class="line">N_cell_param        </div>
<div class="line">                   1</div>
<div class="line">cell_param          </div>
<div class="line">    1.7703537313E+00</div>
<div class="line">group_name          </div>
<div class="line">             P_6_m_m</div>
<div class="line">N_monomer           </div>
<div class="line">                   2</div>
<div class="line">mesh              </div>
<div class="line">                  24                  24</div>
<div class="line">       0.340581085      19.518839883</div>
<div class="line">       0.570887775      19.658020087</div>
<div class="line">       1.199229419      19.984609517</div>
<div class="line">       2.070864605      20.233012735</div>
<div class="line">       2.929754416      19.853514300</div>
<div class="line">            .                 .</div>
<div class="line">            .                 .</div>
<div class="line">            .                 .</div>
<div class="line">       0.999219800      19.890258066</div>
<div class="line">       0.570887775      19.658020087</div>
</div><!-- fragment --><p> <br  />
</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_rgrid_format_sec"></a>
File Format</h1>
<p>Like other field formats, this file format contains a header section with crystallographic information followed by a data section. The header section is similar that for the symmetry adapted format, except for two differences:</p>
<ul>
<li>The last variable in the header is an array "mesh" of integers giving the number of grid points in each direction.</li>
<li>The space_group parameter is optional element of the header for an r-grid field file.</li>
</ul>
<p>In this example, because it is a two-dimensional crystal (dim = 2), the mesh parameter contains two numbers, both equal to 24, indicating a grid in which there are 24 grid points along each coordinate axis. To describe a hexagonal phase, we use a non-orthogonal coordinate system in which each axis is parallel to one of the Bravais lattice vectors, which in a hexagonal phase have an angle of 60 degrees between them.</p>
<p>The group_name parameter, which is present in the above example, is an optional element of r-grid file. This parameter may be included to document that the field is invariant under a known space group, though the r-grid file format does not impose any space group symmetry. When a w-field in is read from an r-grid file by the READ_W_GRID command, however, the presence of any group_name parameter is actually ignored, and the field is treated as if it has no nontrivial space group symmetry.</p>
<p>The data section contains the values of fields associated with N_monomer monomer types at grid points given by    </p><p class="formulaDsp">
\[    \textbf{r}(n_1, \ldots, n_{D}) = \sum_{i=0}^{\textrm{D}-1}
    \frac{n_{i}}{N_{i}}\textbf{a}_{i}
\]
</p>
<p> where \(D\) is the dimensionality of the crystal (denoted by "dim" in the header file), \(\textbf{a}_{i}\)is a Bravais lattice vector, \(N_{i}\) is the number of grid points along direction \(i\), and \(n_{i}\) is an integer index in the range \(0 \leq n_{i} &lt; N_{i}\). <br  />
 The number of rows in the data section is equal to the total number of grid points. Each row in this section contains values of all field components at a single grid point. The number of columns is equal to the number of monomer types, so that data in column \(\alpha\), with columns numbered as \( \alpha = 0, 1, \ldots \), contains the values of the field associated with monomer type index \(\alpha\).</p>
<p>Grid points are listed in order using the first index \(n_{0}\) as the most rapidly varying (innermost) loop index. This order, which is the opposite of the order in which elements of an array are stored in in C/C++, is used to maintain backwards compatbility with order used in the file format defined in the older fortran version of PSCF. This is implemented for a three-dimensional crystal as a loop that can be given as pseudo-code of the form: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (n2 = 0; n2 &lt; N2; ++n2) {</div>
<div class="line">   <span class="keywordflow">for</span> (n1 = 0; n1 &lt; N1; ++n1) {</div>
<div class="line">      <span class="keywordflow">for</span> (n0 = 0; n0 &lt; N0; ++n0) {</div>
<div class="line">         [Read or write data at grid point r(n0, n1, n2)]</div>
<div class="line">      }</div>
<div class="line">   }</div>
<div class="line">}</div>
</div><!-- fragment --><p> in which capitalized symbols (N0, N1, N2) denote the number of grid points in each direction and lower case-variables (n0, n1, n2) denote indices for a particular grid point.</p>
<p><br  />
 <a class="el" href="scft_field_basis_page.html">Field File - Symmetrized Basis (Periodic)</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_field_page.html">Field Files</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="scft_field_kgrid_page.html">Field File - K-Grid (Periodic)</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
