<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Iteration Algorithms</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="index.html">PSCF - Polymer Self-Consistent Field</a></li><li class="navelem"><a href="scft_page.html">Self-Consistent Field Theory</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Iteration Algorithms </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="scft_theory_page.html">Self-Consistent Field Theory</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_sweep_page.html">Parameter Sweeps</a> (Next) <br  />
</p>
<p>The self-consistent field equations are non-linear equations that must be solved by an iterative method. The algorithm used for this purpose is referred to throughout the PSCF source code and documentation as an "iterator". The parameter file format for each PSCF program allows a user to use a selectable "Iterator" block of the parameer file to choose from among several available iterator algorithms.</p>
<p>Several of the iterator algorithms provided by PSCF rely on some variant of the Anderson mixing (AM) algorithm. General aspects of this algorithm are discussed on a <a class="el" href="pscf_AmIteratorTmpl_page.html">separate page</a>.</p>
<p>Different sets of algorithms are available for use with pscf_1d for one-dimension problems, and for the pscf_pc and pscf_pg programs for periodic systems, as described below:</p>
<h1 class="doxsection"><a class="anchor" id="scft_iterator_1d_sec"></a>
One-dimensional systems (pscf_1d)</h1>
<p>Users of pscf_1d may choose from among 3 SCFT iterators, named <a class="el" href="r1d_AmIterator_page.html">AmIterator</a>, <a class="el" href="r1d_NrIterator_page.html">NrIterator</a>, and <a class="el" href="r1d_BinaryRelaxIterator_page.html">BinaryRelaxiterator</a>. More detailed documentation of the input format for each available pscf_1d iterator is given in the links in the table below:</p>
<table class="doxtable">
<tr>
<td><b> Class </b> </td><td><b> Description </b> </td></tr>
<tr>
<td><a class="el" href="r1d_AmIterator_page.html">AmIterator</a> </td><td>Anderson-Mixing iterator (default) </td></tr>
<tr>
<td><a class="el" href="r1d_NrIterator_page.html">NrIterator</a> </td><td>Newton-Raphson iterator </td></tr>
<tr>
<td><a class="el" href="r1d_BinaryRelaxIterator_page.html">BinaryRelaxIterator</a> </td><td>Simple relaxation algorithm for AB (two monomer) systems, as described by Drolet and Fredrickson. </td></tr>
</table>
<p>The default iterator for pscf_1d is an Anderson-mixing algorithm that is implemented by a class named AmIterator. Because this is the default choice, it may be invoked by including an iterator block in the parameter file in which the first line contains either the generic label "Iterator" or the specific class name "AmIterator".</p>
<p>The NrIterator class implements a Newton-Raphson iterator. Under favorable conditions, this may converge in only a few steps, but the cost for each step is high, and grows rapidly with increasing number of grid points. This iterator is thus not efficient for large problems (more than approximately 1000 grid points).</p>
<p>The BinaryRelaxiterator class implements a simple relaxation iterator for AB systems with only two types of monomer, as described by F. Drolet and G.H. Fredrickson (Phys. Rev. Lett, vol 83, page 4317, 1999).</p>
<h1 class="doxsection"><a class="anchor" id="scft_iterator_periodic_sec"></a>
Periodic systems (pscf_pc and pscf_pg)</h1>
<p>The pscf_pc and pscf_pg programs each provide two Anderson mixing iterator algorithms named <a class="el" href="rpc_AmIteratorBasis_page.html">AmIteratorBasis</a> and <a class="el" href="rpc_AmIteratorGrid_page.html">AmIteratorGrid</a>, respectively. The AmIteratorBasis algorithm is the default iterator algorithm for either program, and so may be invoked by a block that starts with either the generic label "Iterator" or with a block that uses the specific label "AmIteratorBasis".</p>
<p>Descriptions of the parameter file formats for these two types of iterator may be found by following the links in the table below: </p><table class="doxtable">
<tr>
<td><b> Class </b> </td><td><b> Description </b> </td></tr>
<tr>
<td><a class="el" href="rpc_AmIteratorBasis_page.html">AmIteratorBasis</a> </td><td>Anderson Mixing iterator for periodic structures, formulated using a symmetry-adapted basis (default) </td></tr>
<tr>
<td><a class="el" href="rpc_AmIteratorGrid_page.html">AmIteratorGrid</a> </td><td>Anderson Mixing iterator for periodic structures, formulated using values defined on a spatial grid </td></tr>
</table>
<p>Either of these algorithms can be used either to solve the SCF equations in a rigid periodic unit cell or to simultaneously solve the SCF equations and optimize the unit cell parameters of a flexible unit cell so as to mininize the free energy density. For either algorithm, this choice is determined by the value of an optional boolean parameter named "isFlexible", which is true (i.e., flexible unit cell) by default.</p>
<p>Both of these iteration algorithms are both based on Anderson-mixing (AM) algorithms, but differ in their treatment of space-group symmetry:</p>
<p>The implementation of the <a class="el" href="rpc_AmIteratorBasis_page.html">AmIteratorBasis</a> algorithm uses an expansion of both chemical potential fields and the residual vector as arrays with elements that represent coefficients in symmetry-adapted Fourier expansions of the corresponding fields. This expansion can only represent fields that are invariant under all symmetry operations of the specified space-group. This algorithm thus searches for a solution with the specified space-group symmetry, which is automatically maintained throughout the iteration process. This algorithm thus requires a parameter file that contains a groupName parameter, and requires an initial guess for the w-fields that was input in symmetry-adapted basis field file format.</p>
<p>The AmIteratorGrid is an Anderson-mixing algorithm that does not impose any space group symmetry on either the initial guess or the solution. The implementation of AmIteratorGrid uses a representations of the w fields and residual vector as arrays whose elements represent values of fields on the nodes of a regular spatial grid. This iterator may be enabled by a parameter file block that starts with the label AmIteratorGrid. It may be used with a parameter file that does not contain a groupName parameter, and may use an initial guess that was input in either r-grid or basis format. Because the algorithm does not impose a space-group symmetry during iteration, the converged w-fields are not assumed to have any such symmetry, and thus cannot be output in symmetry-adapted basis format.</p>
<p><br  />
 <a class="el" href="scft_theory_page.html">Self-Consistent Field Theory</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_page.html">Self-Consistent Field Theory</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="scft_sweep_page.html">Parameter Sweeps</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
