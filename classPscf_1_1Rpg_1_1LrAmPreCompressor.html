<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Pscf::Rpg::LrAmPreCompressor&lt; D &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacePscf.html">Pscf</a></li><li class="navelem"><a class="el" href="namespacePscf_1_1Rpg.html">Rpg</a></li><li class="navelem"><a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">LrAmPreCompressor</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classPscf_1_1Rpg_1_1LrAmPreCompressor-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Pscf::Rpg::LrAmPreCompressor&lt; D &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__Pscf__NS__Module.html">Pscf namespace</a> &raquo; <a class="el" href="group__Pscf__Rpg__Module.html">Pscf::Rpg - Real Periodic Fields (GPU)</a> &raquo; <a class="el" href="group__Rpg__Fts__Module.html">Field Theoretic Simulation (FTS)</a> &raquo; <a class="el" href="group__Rpg__Fts__Compressor__Module.html">Compressors</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Anderson Mixing compressor with linear-response preconditioning.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="LrAmPreCompressor_8h_source.html">LrAmPreCompressor.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Pscf::Rpg::LrAmPreCompressor&lt; D &gt;:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classPscf_1_1Rpg_1_1LrAmPreCompressor.png" usemap="#Pscf::Rpg::LrAmPreCompressor_3C_20D_20_3E_map" alt=""/>
  <map id="Pscf::Rpg::LrAmPreCompressor_3C_20D_20_3E_map" name="Pscf::Rpg::LrAmPreCompressor_3C_20D_20_3E_map">
<area href="classPscf_1_1AmIteratorTmpl.html" alt="Pscf::AmIteratorTmpl&lt; Compressor&lt; D &gt;, DeviceArray&lt; cudaReal &gt; &gt;" shape="rect" coords="0,56,411,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4a34f8f23f0ffcbf55a21c2448b3c7e4" id="r_a4a34f8f23f0ffcbf55a21c2448b3c7e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a34f8f23f0ffcbf55a21c2448b3c7e4">LrAmPreCompressor</a> (<a class="el" href="classPscf_1_1Rpg_1_1System.html">System</a>&lt; D &gt; &amp;system)</td></tr>
<tr class="memdesc:a4a34f8f23f0ffcbf55a21c2448b3c7e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a4a34f8f23f0ffcbf55a21c2448b3c7e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9fd891ec23620585e63577e2ea65508" id="r_ae9fd891ec23620585e63577e2ea65508"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9fd891ec23620585e63577e2ea65508">~LrAmPreCompressor</a> ()</td></tr>
<tr class="memdesc:ae9fd891ec23620585e63577e2ea65508"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:ae9fd891ec23620585e63577e2ea65508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e4c5f443cae21eb5be59f301b642957" id="r_a6e4c5f443cae21eb5be59f301b642957"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e4c5f443cae21eb5be59f301b642957">readParameters</a> (std::istream &amp;in)</td></tr>
<tr class="memdesc:a6e4c5f443cae21eb5be59f301b642957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read all parameters and initialize.  <br /></td></tr>
<tr class="separator:a6e4c5f443cae21eb5be59f301b642957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ce2927dd057e404d8b8e3f076b22f0" id="r_a93ce2927dd057e404d8b8e3f076b22f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93ce2927dd057e404d8b8e3f076b22f0">setup</a> (bool isContinuation)</td></tr>
<tr class="memdesc:a93ce2927dd057e404d8b8e3f076b22f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize just before entry to iterative loop.  <br /></td></tr>
<tr class="separator:a93ce2927dd057e404d8b8e3f076b22f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab39a5e5bf9a5331bcf620aab6d7a4dc0" id="r_ab39a5e5bf9a5331bcf620aab6d7a4dc0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab39a5e5bf9a5331bcf620aab6d7a4dc0">compress</a> ()</td></tr>
<tr class="memdesc:ab39a5e5bf9a5331bcf620aab6d7a4dc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compress to obtain partial saddle point w+.  <br /></td></tr>
<tr class="separator:ab39a5e5bf9a5331bcf620aab6d7a4dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab947fdb802db965ba1b73ff3a884868c" id="r_ab947fdb802db965ba1b73ff3a884868c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab947fdb802db965ba1b73ff3a884868c">outputTimers</a> (std::ostream &amp;out)</td></tr>
<tr class="memdesc:ab947fdb802db965ba1b73ff3a884868c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write a report of time contributions used by this algorithm.  <br /></td></tr>
<tr class="separator:ab947fdb802db965ba1b73ff3a884868c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b05a0e574a285e9c7c00bc07be2c9e" id="r_aa3b05a0e574a285e9c7c00bc07be2c9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3b05a0e574a285e9c7c00bc07be2c9e">clearTimers</a> ()</td></tr>
<tr class="memdesc:aa3b05a0e574a285e9c7c00bc07be2c9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset / clear all timers.  <br /></td></tr>
<tr class="separator:aa3b05a0e574a285e9c7c00bc07be2c9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6386b2dc1feea005a8a5b1b4592e39a1" id="r_a6386b2dc1feea005a8a5b1b4592e39a1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6386b2dc1feea005a8a5b1b4592e39a1">computeError</a> (<a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; &amp;residTrial, <a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; &amp;fieldTrial, std::string <a class="el" href="classPscf_1_1AmIteratorTmpl.html#a571324a4ecfdff4941b20a9f0129dd2e">errorType</a>, int <a class="el" href="classPscf_1_1AmIteratorTmpl.html#a7cbc162e8785ff54fb1a2922a951ce6c">verbose</a>)</td></tr>
<tr class="memdesc:a6386b2dc1feea005a8a5b1b4592e39a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and return error used to test for convergence.  <br /></td></tr>
<tr class="separator:a6386b2dc1feea005a8a5b1b4592e39a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPscf_1_1AmIteratorTmpl"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classPscf_1_1AmIteratorTmpl')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPscf_1_1AmIteratorTmpl.html">Pscf::AmIteratorTmpl&lt; Compressor&lt; D &gt;, DeviceArray&lt; cudaReal &gt; &gt;</a></td></tr>
<tr class="memitem:ab33190953cf8dca75fd34f881779dc82 inherit pub_methods_classPscf_1_1AmIteratorTmpl" id="r_ab33190953cf8dca75fd34f881779dc82"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#ab33190953cf8dca75fd34f881779dc82">AmIteratorTmpl</a> ()</td></tr>
<tr class="memdesc:ab33190953cf8dca75fd34f881779dc82 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:ab33190953cf8dca75fd34f881779dc82 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7decf2817507d097a7ab80603e599856 inherit pub_methods_classPscf_1_1AmIteratorTmpl" id="r_a7decf2817507d097a7ab80603e599856"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a7decf2817507d097a7ab80603e599856">~AmIteratorTmpl</a> ()</td></tr>
<tr class="memdesc:a7decf2817507d097a7ab80603e599856 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:a7decf2817507d097a7ab80603e599856 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ffb94dd7fcca4eff1eacd4a266b9d4 inherit pub_methods_classPscf_1_1AmIteratorTmpl" id="r_ad9ffb94dd7fcca4eff1eacd4a266b9d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#ad9ffb94dd7fcca4eff1eacd4a266b9d4">readParameters</a> (std::istream &amp;in)</td></tr>
<tr class="memdesc:ad9ffb94dd7fcca4eff1eacd4a266b9d4 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read all parameters and initialize.  <br /></td></tr>
<tr class="separator:ad9ffb94dd7fcca4eff1eacd4a266b9d4 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae73358fa1ae70ca7c4c1e81216a48b3d inherit pub_methods_classPscf_1_1AmIteratorTmpl" id="r_ae73358fa1ae70ca7c4c1e81216a48b3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#ae73358fa1ae70ca7c4c1e81216a48b3d">solve</a> (bool isContinuation=false)</td></tr>
<tr class="memdesc:ae73358fa1ae70ca7c4c1e81216a48b3d inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Iterate to a solution.  <br /></td></tr>
<tr class="separator:ae73358fa1ae70ca7c4c1e81216a48b3d inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcac877e651d0d181b5329f39ad6059c inherit pub_methods_classPscf_1_1AmIteratorTmpl" id="r_afcac877e651d0d181b5329f39ad6059c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#afcac877e651d0d181b5329f39ad6059c">outputTimers</a> (std::ostream &amp;out)</td></tr>
<tr class="memdesc:afcac877e651d0d181b5329f39ad6059c inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log output timing results.  <br /></td></tr>
<tr class="separator:afcac877e651d0d181b5329f39ad6059c inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a2a0089b03ae9a3b694dc26e25c665 inherit pub_methods_classPscf_1_1AmIteratorTmpl" id="r_a66a2a0089b03ae9a3b694dc26e25c665"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a66a2a0089b03ae9a3b694dc26e25c665">clearTimers</a> ()</td></tr>
<tr class="memdesc:a66a2a0089b03ae9a3b694dc26e25c665 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear timers.  <br /></td></tr>
<tr class="separator:a66a2a0089b03ae9a3b694dc26e25c665 inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a571324a4ecfdff4941b20a9f0129dd2e inherit pub_methods_classPscf_1_1AmIteratorTmpl" id="r_a571324a4ecfdff4941b20a9f0129dd2e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a571324a4ecfdff4941b20a9f0129dd2e">errorType</a> () const</td></tr>
<tr class="memdesc:a571324a4ecfdff4941b20a9f0129dd2e inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obtain error type.  <br /></td></tr>
<tr class="separator:a571324a4ecfdff4941b20a9f0129dd2e inherit pub_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a5d9f133993e0aa0b18cd59938ccf8700" id="r_a5d9f133993e0aa0b18cd59938ccf8700"><td class="memTemplParams" colspan="2">template&lt;typename Type &gt; </td></tr>
<tr class="memitem:a5d9f133993e0aa0b18cd59938ccf8700"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classUtil_1_1ScalarParam.html">ScalarParam</a>&lt; Type &gt; &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a5d9f133993e0aa0b18cd59938ccf8700">readOptional</a> (std::istream &amp;in, const char *label, Type &amp;value)</td></tr>
<tr class="memdesc:a5d9f133993e0aa0b18cd59938ccf8700"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add and read a new optional ScalarParam &lt; Type &gt; object.  <br /></td></tr>
<tr class="separator:a5d9f133993e0aa0b18cd59938ccf8700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPscf_1_1AmIteratorTmpl"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_methods_classPscf_1_1AmIteratorTmpl')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPscf_1_1AmIteratorTmpl.html">Pscf::AmIteratorTmpl&lt; Compressor&lt; D &gt;, DeviceArray&lt; cudaReal &gt; &gt;</a></td></tr>
<tr class="memitem:aa196fc082b2d632873009e81dad40983 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_aa196fc082b2d632873009e81dad40983"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#aa196fc082b2d632873009e81dad40983">setMaxItr</a> (int maxItr)</td></tr>
<tr class="memdesc:aa196fc082b2d632873009e81dad40983 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set value of maxItr.  <br /></td></tr>
<tr class="separator:aa196fc082b2d632873009e81dad40983 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2516c6a0c2beb966ad3ed321bd7807ef inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a2516c6a0c2beb966ad3ed321bd7807ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a2516c6a0c2beb966ad3ed321bd7807ef">setMaxHist</a> (int maxHist)</td></tr>
<tr class="memdesc:a2516c6a0c2beb966ad3ed321bd7807ef inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set value of maxHist (number of retained previous states)  <br /></td></tr>
<tr class="separator:a2516c6a0c2beb966ad3ed321bd7807ef inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d483975ac4db7f3e9cd7023debedb44 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a4d483975ac4db7f3e9cd7023debedb44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a4d483975ac4db7f3e9cd7023debedb44">setErrorType</a> (std::string <a class="el" href="classPscf_1_1AmIteratorTmpl.html#a571324a4ecfdff4941b20a9f0129dd2e">errorType</a>)</td></tr>
<tr class="memdesc:a4d483975ac4db7f3e9cd7023debedb44 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set and validate value of errorType string.  <br /></td></tr>
<tr class="separator:a4d483975ac4db7f3e9cd7023debedb44 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9205a322c557c51cdc3ebb991ea64e9f inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a9205a322c557c51cdc3ebb991ea64e9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a9205a322c557c51cdc3ebb991ea64e9f">readErrorType</a> (std::istream &amp;in)</td></tr>
<tr class="memdesc:a9205a322c557c51cdc3ebb991ea64e9f inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read and validate the optional errorType string parameter.  <br /></td></tr>
<tr class="separator:a9205a322c557c51cdc3ebb991ea64e9f inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac28c346f90b36f7174dc798accb27be9 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_ac28c346f90b36f7174dc798accb27be9"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#ac28c346f90b36f7174dc798accb27be9">isValidErrorType</a> ()</td></tr>
<tr class="memdesc:ac28c346f90b36f7174dc798accb27be9 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a string is a valid error type.  <br /></td></tr>
<tr class="separator:ac28c346f90b36f7174dc798accb27be9 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce62f5d547473c35e039d16a13b8df3 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_afce62f5d547473c35e039d16a13b8df3"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#afce62f5d547473c35e039d16a13b8df3">norm</a> (<a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; const &amp;hist)</td></tr>
<tr class="memdesc:afce62f5d547473c35e039d16a13b8df3 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the L2 norm of a vector.  <br /></td></tr>
<tr class="separator:afce62f5d547473c35e039d16a13b8df3 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35b2f9b458a3b56f3ffcf55b6236552e inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a35b2f9b458a3b56f3ffcf55b6236552e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a35b2f9b458a3b56f3ffcf55b6236552e">allocateAM</a> ()</td></tr>
<tr class="memdesc:a35b2f9b458a3b56f3ffcf55b6236552e inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory required by AM algorithm, if necessary.  <br /></td></tr>
<tr class="separator:a35b2f9b458a3b56f3ffcf55b6236552e inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41bec1ca6bbac559d2e7469085f448a7 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a41bec1ca6bbac559d2e7469085f448a7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a41bec1ca6bbac559d2e7469085f448a7">clear</a> ()</td></tr>
<tr class="memdesc:a41bec1ca6bbac559d2e7469085f448a7 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear information about history.  <br /></td></tr>
<tr class="separator:a41bec1ca6bbac559d2e7469085f448a7 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3112579f0c4bde562b7b2d5c6f6428e2 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a3112579f0c4bde562b7b2d5c6f6428e2"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a3112579f0c4bde562b7b2d5c6f6428e2">computeError</a> (<a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; &amp;residTrial, <a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; &amp;fieldTrial, std::string <a class="el" href="classPscf_1_1AmIteratorTmpl.html#a571324a4ecfdff4941b20a9f0129dd2e">errorType</a>, int <a class="el" href="classPscf_1_1AmIteratorTmpl.html#a7cbc162e8785ff54fb1a2922a951ce6c">verbose</a>)</td></tr>
<tr class="memdesc:a3112579f0c4bde562b7b2d5c6f6428e2 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and return error used to test for convergence.  <br /></td></tr>
<tr class="separator:a3112579f0c4bde562b7b2d5c6f6428e2 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe889e87b6dae5982eca17e0749b58d inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a2fe889e87b6dae5982eca17e0749b58d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a2fe889e87b6dae5982eca17e0749b58d">computeError</a> (int <a class="el" href="classPscf_1_1AmIteratorTmpl.html#a7cbc162e8785ff54fb1a2922a951ce6c">verbose</a>)</td></tr>
<tr class="memdesc:a2fe889e87b6dae5982eca17e0749b58d inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and return error used to test for convergence.  <br /></td></tr>
<tr class="separator:a2fe889e87b6dae5982eca17e0749b58d inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317c3e88b6006282b757bd2f9fab06ab inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a317c3e88b6006282b757bd2f9fab06ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a317c3e88b6006282b757bd2f9fab06ab">residual</a> () const</td></tr>
<tr class="memdesc:a317c3e88b6006282b757bd2f9fab06ab inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current residual vector by const reference.  <br /></td></tr>
<tr class="separator:a317c3e88b6006282b757bd2f9fab06ab inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af65aca8b7d3bbb98e63dfcb30c8866ed inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_af65aca8b7d3bbb98e63dfcb30c8866ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#af65aca8b7d3bbb98e63dfcb30c8866ed">field</a> () const</td></tr>
<tr class="memdesc:af65aca8b7d3bbb98e63dfcb30c8866ed inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current field or state vector by const reference.  <br /></td></tr>
<tr class="separator:af65aca8b7d3bbb98e63dfcb30c8866ed inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cbc162e8785ff54fb1a2922a951ce6c inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a7cbc162e8785ff54fb1a2922a951ce6c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a7cbc162e8785ff54fb1a2922a951ce6c">verbose</a> () const</td></tr>
<tr class="memdesc:a7cbc162e8785ff54fb1a2922a951ce6c inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verbosity level, allowed values 0, 1, or 2.  <br /></td></tr>
<tr class="separator:a7cbc162e8785ff54fb1a2922a951ce6c inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a683919a1f3a8e161cb86417cbad0e399 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a683919a1f3a8e161cb86417cbad0e399"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a683919a1f3a8e161cb86417cbad0e399">totalItr</a> ()</td></tr>
<tr class="memdesc:a683919a1f3a8e161cb86417cbad0e399 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the total number of iterations needed to converge.  <br /></td></tr>
<tr class="separator:a683919a1f3a8e161cb86417cbad0e399 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324f73f1f646b9c14cce22efbb0cbbc1 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a324f73f1f646b9c14cce22efbb0cbbc1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a324f73f1f646b9c14cce22efbb0cbbc1">timerTotal</a> ()</td></tr>
<tr class="memdesc:a324f73f1f646b9c14cce22efbb0cbbc1 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total time.  <br /></td></tr>
<tr class="separator:a324f73f1f646b9c14cce22efbb0cbbc1 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950f0963a85ef9ed59bbc0516b9b9cd4 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a950f0963a85ef9ed59bbc0516b9b9cd4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a950f0963a85ef9ed59bbc0516b9b9cd4">timerMDE</a> ()</td></tr>
<tr class="memdesc:a950f0963a85ef9ed59bbc0516b9b9cd4 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get time solving modified diffusion equation (MDE).  <br /></td></tr>
<tr class="separator:a950f0963a85ef9ed59bbc0516b9b9cd4 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a9dc19560ec2f08e0f797dd42da8079 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a6a9dc19560ec2f08e0f797dd42da8079"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a6a9dc19560ec2f08e0f797dd42da8079">timerAM</a> ()</td></tr>
<tr class="memdesc:a6a9dc19560ec2f08e0f797dd42da8079 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total time for AM algorithm, excluding MDE solution.  <br /></td></tr>
<tr class="separator:a6a9dc19560ec2f08e0f797dd42da8079 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf03dc4406daaf5bf6f00c3eed416b4d inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_aaf03dc4406daaf5bf6f00c3eed416b4d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#aaf03dc4406daaf5bf6f00c3eed416b4d">timerResid</a> ()</td></tr>
<tr class="memdesc:aaf03dc4406daaf5bf6f00c3eed416b4d inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get time computing residual.  <br /></td></tr>
<tr class="separator:aaf03dc4406daaf5bf6f00c3eed416b4d inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8e83ed86addc299afd911061c9b9af inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a0d8e83ed86addc299afd911061c9b9af"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a0d8e83ed86addc299afd911061c9b9af">timerError</a> ()</td></tr>
<tr class="memdesc:a0d8e83ed86addc299afd911061c9b9af inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get time evaluating scalar error.  <br /></td></tr>
<tr class="separator:a0d8e83ed86addc299afd911061c9b9af inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85282947c4bd9b322b6c2c7adc12eef5 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a85282947c4bd9b322b6c2c7adc12eef5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a85282947c4bd9b322b6c2c7adc12eef5">timerCoeff</a> ()</td></tr>
<tr class="memdesc:a85282947c4bd9b322b6c2c7adc12eef5 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get time evaluating Anderson mixing coefficients.  <br /></td></tr>
<tr class="separator:a85282947c4bd9b322b6c2c7adc12eef5 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44600447d7ec6f74179602e010bb0cb6 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a44600447d7ec6f74179602e010bb0cb6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a44600447d7ec6f74179602e010bb0cb6">timerOmega</a> ()</td></tr>
<tr class="memdesc:a44600447d7ec6f74179602e010bb0cb6 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get time updating w fields.  <br /></td></tr>
<tr class="separator:a44600447d7ec6f74179602e010bb0cb6 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3987903c9536462dd9659df814f5e62c inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a3987903c9536462dd9659df814f5e62c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a3987903c9536462dd9659df814f5e62c">isAllocatedAM</a> () const</td></tr>
<tr class="memdesc:a3987903c9536462dd9659df814f5e62c inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Have data structures required by the AM algorithm been allocated?  <br /></td></tr>
<tr class="separator:a3987903c9536462dd9659df814f5e62c inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c4ae1412ec944d4189cb7c7b6a3171 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a21c4ae1412ec944d4189cb7c7b6a3171"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classUtil_1_1ScalarParam.html">ScalarParam</a>&lt; Type &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a21c4ae1412ec944d4189cb7c7b6a3171">read</a> (std::istream &amp;in, const char *label, Type &amp;value)</td></tr>
<tr class="memdesc:a21c4ae1412ec944d4189cb7c7b6a3171 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add and read a new required ScalarParam &lt; Type &gt; object.  <br /></td></tr>
<tr class="separator:a21c4ae1412ec944d4189cb7c7b6a3171 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d9f133993e0aa0b18cd59938ccf8700 inherit pro_methods_classPscf_1_1AmIteratorTmpl" id="r_a5d9f133993e0aa0b18cd59938ccf8700"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classUtil_1_1ScalarParam.html">ScalarParam</a>&lt; Type &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#a5d9f133993e0aa0b18cd59938ccf8700">readOptional</a> (std::istream &amp;in, const char *label, Type &amp;value)</td></tr>
<tr class="memdesc:a5d9f133993e0aa0b18cd59938ccf8700 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add and read a new optional ScalarParam &lt; Type &gt; object.  <br /></td></tr>
<tr class="separator:a5d9f133993e0aa0b18cd59938ccf8700 inherit pro_methods_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classPscf_1_1AmIteratorTmpl"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_attribs_classPscf_1_1AmIteratorTmpl')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPscf_1_1AmIteratorTmpl.html">Pscf::AmIteratorTmpl&lt; Compressor&lt; D &gt;, DeviceArray&lt; cudaReal &gt; &gt;</a></td></tr>
<tr class="memitem:ad0ab7a80b720e7d5138d3dec43e6cb6d inherit pro_attribs_classPscf_1_1AmIteratorTmpl" id="r_ad0ab7a80b720e7d5138d3dec43e6cb6d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPscf_1_1AmIteratorTmpl.html#ad0ab7a80b720e7d5138d3dec43e6cb6d">errorType_</a></td></tr>
<tr class="memdesc:ad0ab7a80b720e7d5138d3dec43e6cb6d inherit pro_attribs_classPscf_1_1AmIteratorTmpl"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of error criterion used to test convergence.  <br /></td></tr>
<tr class="separator:ad0ab7a80b720e7d5138d3dec43e6cb6d inherit pro_attribs_classPscf_1_1AmIteratorTmpl"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;int D&gt;<br />
class Pscf::Rpg::LrAmPreCompressor&lt; D &gt;</div><p>Anderson Mixing compressor with linear-response preconditioning. </p>
<p>Class <a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html" title="Anderson Mixing compressor with linear-response preconditioning.">LrAmPreCompressor</a> implements an Anderson mixing algorithm in which the residual is defined using a preconditioning scheme that would yield a Jacobian of unity if applied to a homogeneous system. The residual in the unpreconditioned form of Anderson mixing is a vector in which each that represents a deviations in the sum of volume fractions from unity. In this preconditioned algorithm, each Fourier component of this deviation is multiplied by the inverse of Fourier representation of the linear response of total concentration to changes in pressure in a homogeneous system of the same chemical composition as the system of interest. </p>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8h_source.html#l00047">47</a> of file <a class="el" href="LrAmPreCompressor_8h_source.html">LrAmPreCompressor.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4a34f8f23f0ffcbf55a21c2448b3c7e4" name="a4a34f8f23f0ffcbf55a21c2448b3c7e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a34f8f23f0ffcbf55a21c2448b3c7e4">&#9670;&#160;</a></span>LrAmPreCompressor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::LrAmPreCompressor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPscf_1_1Rpg_1_1System.html">System</a>&lt; D &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>system</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">system</td><td><a class="el" href="classPscf_1_1Rpg_1_1System.html" title="Main class for calculations that represent one system.">System</a> object associated with this compressor. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00028">28</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

</div>
</div>
<a id="ae9fd891ec23620585e63577e2ea65508" name="ae9fd891ec23620585e63577e2ea65508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9fd891ec23620585e63577e2ea65508">&#9670;&#160;</a></span>~LrAmPreCompressor()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::~<a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">LrAmPreCompressor</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00037">37</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6e4c5f443cae21eb5be59f301b642957" name="a6e4c5f443cae21eb5be59f301b642957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e4c5f443cae21eb5be59f301b642957">&#9670;&#160;</a></span>readParameters()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::readParameters </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;</td>          <td class="paramname"><span class="paramname"><em>in</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read all parameters and initialize. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>input filestream </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00042">42</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

</div>
</div>
<a id="a93ce2927dd057e404d8b8e3f076b22f0" name="a93ce2927dd057e404d8b8e3f076b22f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93ce2927dd057e404d8b8e3f076b22f0">&#9670;&#160;</a></span>setup()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::setup </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>isContinuation</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize just before entry to iterative loop. </p>
<p>This function is called by the solve function before entering the loop over iterations. Store the current values of the fields at the beginning of iteration</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">isContinuation</td><td>true iff continuation within a sweep </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classPscf_1_1AmIteratorTmpl.html#a0b99a48a0ab289af9769b615a1ae464a">Pscf::AmIteratorTmpl&lt; Compressor&lt; D &gt;, DeviceArray&lt; cudaReal &gt; &gt;</a>.</p>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00051">51</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

<p class="reference">References <a class="el" href="VecOp_8cu_source.html#l01039">Pscf::Prdc::Cuda::VecOp::eqV()</a>.</p>

</div>
</div>
<a id="ab39a5e5bf9a5331bcf620aab6d7a4dc0" name="ab39a5e5bf9a5331bcf620aab6d7a4dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab39a5e5bf9a5331bcf620aab6d7a4dc0">&#9670;&#160;</a></span>compress()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::compress </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compress to obtain partial saddle point w+. </p>
<dl class="section return"><dt>Returns</dt><dd>0 for convergence, 1 for failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00106">106</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

</div>
</div>
<a id="ab947fdb802db965ba1b73ff3a884868c" name="ab947fdb802db965ba1b73ff3a884868c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab947fdb802db965ba1b73ff3a884868c">&#9670;&#160;</a></span>outputTimers()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::outputTimers </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;</td>          <td class="paramname"><span class="paramname"><em>out</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write a report of time contributions used by this algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>output stream to which to write </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00258">258</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

</div>
</div>
<a id="aa3b05a0e574a285e9c7c00bc07be2c9e" name="aa3b05a0e574a285e9c7c00bc07be2c9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b05a0e574a285e9c7c00bc07be2c9e">&#9670;&#160;</a></span>clearTimers()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::clearTimers </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset / clear all timers. </p>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00268">268</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

</div>
</div>
<a id="a6386b2dc1feea005a8a5b1b4592e39a1" name="a6386b2dc1feea005a8a5b1b4592e39a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6386b2dc1feea005a8a5b1b4592e39a1">&#9670;&#160;</a></span>computeError()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="classPscf_1_1Rpg_1_1LrAmPreCompressor.html">Pscf::Rpg::LrAmPreCompressor</a>&lt; D &gt;::computeError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>residTrial</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; &amp;</td>          <td class="paramname"><span class="paramname"><em>fieldTrial</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string</td>          <td class="paramname"><span class="paramname"><em>errorType</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>verbose</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute and return error used to test for convergence. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">residTrial</td><td>current residual vector </td></tr>
    <tr><td class="paramname">fieldTrial</td><td>current field vector <br  />
 </td></tr>
    <tr><td class="paramname">errorType</td><td>type of error </td></tr>
    <tr><td class="paramname">verbose</td><td>verbosity level of output report. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error measure used to test for convergence. </dd></dl>

<p class="definition">Definition at line <a class="el" href="LrAmPreCompressor_8tpp_source.html#l00281">281</a> of file <a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a>.</p>

<p class="reference">References <a class="el" href="VecOp_8cu_source.html#l01672">Pscf::Prdc::Cuda::VecOp::addEqV()</a>, <a class="el" href="Log_8cpp_source.html#l00057">Util::Log::file()</a>, <a class="el" href="VecOp_8cu_source.html#l01323">Pscf::Prdc::Cuda::VecOp::subVS()</a>, <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>, and <a class="el" href="global_8h_source.html#l00051">UTIL_THROW</a>.</p>

</div>
</div>
<a id="a5d9f133993e0aa0b18cd59938ccf8700" name="a5d9f133993e0aa0b18cd59938ccf8700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d9f133993e0aa0b18cd59938ccf8700">&#9670;&#160;</a></span>readOptional()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<div class="memtemplate">
template&lt;typename Type &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classUtil_1_1ScalarParam.html">ScalarParam</a>&lt; Type &gt; &amp; Util::ParamComposite::readOptional </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Type &amp;</td>          <td class="paramname"><span class="paramname"><em>value</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add and read a new optional ScalarParam &lt; Type &gt; object. </p>
<p>This is equivalent to ScalarParam&lt;Type&gt;(in, label, value, false).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>input stream for reading </td></tr>
    <tr><td class="paramname">label</td><td>Label string </td></tr>
    <tr><td class="paramname">value</td><td>reference to new ScalarParam&lt; Type &gt; </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ParamComposite_8h_source.html#l00319">319</a> of file <a class="el" href="ParamComposite_8h_source.html">ParamComposite.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="LrAmPreCompressor_8h_source.html">LrAmPreCompressor.h</a></li>
<li><a class="el" href="LrAmPreCompressor_8tpp_source.html">LrAmPreCompressor.tpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 14 2025 16:24:05 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
