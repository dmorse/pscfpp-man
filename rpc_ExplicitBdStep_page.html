<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Rpc::ExplicitBdStep</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="psfts_page.html">Partial Saddle-Point Field Theoretic Simulation (PS-FTS)</a></li><li class="navelem"><a class="el" href="psfts_algorithm_page.html">Algorithms</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Rpc::ExplicitBdStep</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The ExplictBdStep classes used by both the pscf_pc and pscf_pg programs implements a simple explicit Euler Brownian dynamics step algorithm.</p>
<p>Two closely analogous classes named <a class="el" href="classPscf_1_1Rpc_1_1ExplicitBdStep.html" title="BdStep is an abstract base class for Brownian dynamics steps.">Pscf::Rpc::ExplicitBdStep</a> and <a class="el" href="classPscf_1_1Rpg_1_1ExplicitBdStep.html" title="BdStep is an abstract base class for Brownian dynamics steps.">Pscf::Rpg::ExplicitBdStep</a> that have the same class name but that are defined in different namespaces are used to implement this the same step algorithm for different programs. The ExplicitBdStep class defined in the Rpc namespace is used in the pscf_pc program (using CPU hardware) and the class defined in the Rpg namespace is used in the pscf_pg program (using GPU acceleration). These two analogous classes implement the same step algorithm and use the same parameter file format, which are documented below.</p>
<h1><a class="anchor" id="rpc_ExplicitBdStep_algorithm_sec"></a>
Step Algorithm</h1>
<p>A general discussion of conventions used in PSCF for BD step algorithms is given <a class="el" href="psfts_algorithm_page.html">here</a>.</p>
<p>The explicit Euler BD step algorithm for the common case of a standard AB system with two types of monomer is described by an update scheme for the field \( \omega_{0}({\bf r}) = \omega_{-}({\bf r}) \) at grid point location \( {\bf r} \) and time step \( n \) that is given by      </p><p class="formulaDsp">
\[
  \omega_{-}^{(n+1)}({\bf r}) =
  \omega_{-}^{(n)}({\bf r}) 
  - \gamma \frac{\delta H}{\delta \omega_{-}({\bf r})}
  + g^{(n)}({\bf r})
\]
</p>
<p> where \( \gamma \) is the BD mobility parameter,      </p><p class="formulaDsp">
\[
  \frac{\delta H}{\delta \omega_{-}({\bf r})}
  = \frac{1}{v} \left [
    \frac{2\omega_{-}({\bf r})}{\chi_{b}}
    - \Phi_{-}({\bf r}) \right ]
\]
</p>
<p> is the generalized force evaluated using the field configuration at time step \( n \), and \( g^{(n)}({\bf r}) \) is a random field displacement. The random displacement \( g^{(n)}({\bf r}) \) is chosen independently at each grid point and each BD step from a Gaussian distribution with a vanishing mean value, \( \overline{g^{(n)}({\bf r})} = 0 \), and a variance   </p><p class="formulaDsp">
\[
  \overline{[g^{(n)}({\bf r})]^2} = \gamma \Delta V \quad.
\]
</p>
<p> Here, \( \Delta V \) is the volume per grid point of the computational mesh, given by \( \Delta V = V/G \), where \( V \) is the total system volume and \( G \) is the number of grid points on the mesh.</p>
<p>This algorithm can be generalized to a system with \( M \) monomer types for which the first \( L \) eigenvalues of the projected chi matrix are negative, with \( L \leq M - 1 \). In this case, each field component \( \omega_{i}({\bf r}) \) associated with eigenvalue \( \lambda_{i} &lt; 0 \) of the projected \( \chi \) matrix, for \( i = 0, \ldots, L - 1 \), is updated via a scheme      </p><p class="formulaDsp">
\[
  \omega_{i}^{(n+1)}({\bf r}) =
  \omega_{i}^{(n)}({\bf r}) 
  - \gamma \frac{\delta H}{\delta \omega_{i}({\bf r})}
  + g_{i}^{(n)}({\bf r}) \quad.
\]
</p>
<p> with a separate random noise components for each such field component. The random noise components \( g_{i}^{(n)}({\bf r})\) with eigenvector indices \( i = 0, \ldots, L - 1 \) are chosen independently for each index value \( i \), each grid position \( {\bf r} \) and each time step \( n \) from a Gaussian distribution of zero mean and variance \( \overline{[g^{(n)}_{i}({\bf r})]^2} = \gamma \Delta V \).</p>
<h1><a class="anchor" id="rpc_ExplicitBdStep_parameter_sec"></a>
Parameter File</h1>
<p>The only parameter needed by this algorithm is a required parameter named "mobility", which gives the value of parameter denoted by \( \gamma \) in the above equations. A typical example of the contents of the block is shown below. below: </p><div class="fragment"><div class="line">ExplicitBdStep{</div>
<div class="line">  mobility     5.0e-3</div>
<div class="line">}</div>
</div><!-- fragment --><p> The format of this block is thus simply </p><div class="fragment"><div class="line">ExplicitBdStep{</div>
<div class="line">   mobility      <span class="keywordtype">float</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> The mobility parameter is required. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 14 2025 16:29:26 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
