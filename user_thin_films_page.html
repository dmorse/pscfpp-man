<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: 3.9 Thin Films</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="user_page.html">3 User Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">3.9 Thin Films </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="user_groups_page.html">3.8 Space Groups</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">4 Developer Information</a> (Next) <br  />
</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Overview</h1>
<p >A "thin film constraint" can be imposed on the system by modifying the iterator block of the parameter file. The thin film is modeled as a polymer melt confined between two parallel walls with a fixed distance between them. The walls are represented in the unit cell as a "mask" that occupies space in certain regions of the cell according to a pre-defined functional form. This mask technique allows for the periodic boundary conditions and MDE solver to be used without any modification; the modifications are contained entirely to the iterator.</p>
<p >The mask is included in the system by modifying the incompressibility constraint as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sum_{\alpha=1}^{N_{\rm species}} \rho_\alpha({\bf r}) = 1-\rho_{\rm mask}({\bf r}) \]" src="form_51.png" width="148" height="39"/>
</p>
<p> where the summation is over all distinct monomer species, <em>&rho;<sub>&alpha;</sub></em>(<b>r</b>) is the volume fraction of species <em>&alpha;</em> at position <b>r</b>, and <em>&rho;</em><sub>mask</sub>(<b>r</b>) is defined as: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho_{\rm mask}(z) = 0.5*\left( 1+ {\rm tanh} \left( 4*\frac{.5(T-L)+|z-\frac{L}{2}|}{t} \right) \right) \]" src="form_52.png" width="301" height="39"/>
</p>
<p> Here, we have defined the mask density as a function of <em>z</em>, which we define as the position along the direction normal to the walls. <em>L</em> is the length of the unit cell in this direction, and <em>T</em> is the total thickness of the wall in this direction. <em>t</em> defines the rate at which <em>&rho;</em><sub>mask</sub>(<em>z</em>) decays from 1 to 0 when passing from the wall region into the film. If <em>t</em> is small, the calculation will require high spatial resolution to converge, which can be computationally prohibitive, but a sufficiently large <em>t</em> will not be able to accurately model a rigid wall. A common compromise in literature is to choose 0.15<em>R</em><sub>g</sub> &le; <em>t</em> &le; 0.5<em>R</em><sub>g</sub>, where <em>R</em><sub>g</sub> is the radius of gyration of the polymer (for a one-component system).</p>
<p >The introduction of this mask has a significant effect on the symmetry of the unit cell, so the choice of unit cell and space group in the parameter file must be made with care. This is explained in great detail in the Space Groups section below. Also, although it is not necessary, we impose an additional constraint on the unit cells used for thin film calculations: one lattice basis vector must be oriented normal to the walls, and all other lattice basis vectors must be parallel to the walls. For example, if one were to use a hexagonal unit cell, the walls must be parallel to the <b>a</b> and <b>b</b> lattice vectors, because this is the only orientation of the walls for which the third lattice vector is normal to the walls. Additionally, the length of the lattice vector that is normal to the walls is not allowed to vary, so the thickness that the user defines will be maintained throughout the calculation even if the user chooses to have a flexible unit cell.</p>
<p >For further reading on thin film SCFT, see the two publications listed below, on which our implementation is largely based:</p><ul>
<li>Matsen, M. W. (1997). <em>J. Chem. Phys.</em>, <b>106</b>, 7781.</li>
<li>Khanna, V., <em>et al.</em> (2006). <em>Macromolecules</em>, <b>39</b>, 9346.</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Parameter File Input</h1>
<p >In the parameter file, the thin film constraint is included by modifying the iterator block. First, the word "Film" is appended to the end of the iterator name (e.g., "AmIteratorFilm" instead of "AmIterator"). Inside of the iterator block, the normal iterator parameters are listed first, followed by several additional parameters to define the mask. For now, AmIterator is the only iterator that has been implemented in the software, so the only thin film iterator is AmIteratorFilm. An example is given below to show how a thin film is written into the parameter file: </p><div class="fragment"><div class="line">System{</div>
<div class="line">   Mixture{</div>
<div class="line">      nMonomer   2</div>
<div class="line">      monomers[</div>
<div class="line">                 1.0  </div>
<div class="line">                 1.0 </div>
<div class="line">      ]</div>
<div class="line">      nPolymer   1</div>
<div class="line">      Polymer{</div>
<div class="line">         nBlock  2</div>
<div class="line">         blocks[</div>
<div class="line">                 0   0.25</div>
<div class="line">                 1   0.75</div>
<div class="line">         ]</div>
<div class="line">         phi     1.0</div>
<div class="line">      }</div>
<div class="line">   }</div>
<div class="line">   Interaction{</div>
<div class="line">      ...</div>
<div class="line">   }</div>
<div class="line">   Domain{</div>
<div class="line">      unitCell         tetragonal    2.0    4.2</div>
<div class="line">      mesh             32  32  68</div>
<div class="line">      groupName        P_4%m_m_m</div>
<div class="line">   }</div>
<div class="line">   AmIteratorFilm{</div>
<div class="line">      maxItr              1000</div>
<div class="line">      epsilon             1e-6</div>
<div class="line">      maxHist             50 </div>
<div class="line">      isFlexible          1</div>
<div class="line">      normalVecId         2</div>
<div class="line">      interfaceThickness  0.05     </div>
<div class="line">      wallThickness       0.2</div>
<div class="line">      chi[</div>
<div class="line">           10  10</div>
<div class="line">            0   0</div>
<div class="line">      ]</div>
<div class="line">      wallBasisOutFile    out/wall.bf</div>
<div class="line">      wallRGridOutFile    out/wall.rf</div>
<div class="line">   }</div>
<div class="line">   LinearSweep{</div>
<div class="line">      ns            20  </div>
<div class="line">      baseFileName  out/</div>
<div class="line">      nParameter    2</div>
<div class="line">      parameters[</div>
<div class="line">                    cell_param  1  0.5</div>
<div class="line">                    chi_wall    0  1  0.0</div>
<div class="line">      ]   </div>
<div class="line">   }</div>
<div class="line">}</div>
</div><!-- fragment --><p >In the example, we have constructed a parameter file that might be used to represent an AB diblock polymer self-assembled into a bcc structure confined to a thin film that is ~2 unit cells thick. This will be explained in more detail below. Also, see our parameter-level breakdown of the components of an <a class="el" href="pspc_AmIteratorFilm_page.html">Pspc::AmIteratorFilm</a> block.</p>
<h3><a class="anchor" id="autotoc_md4"></a>
Domain Block</h3>
<p >First, we draw your attention to the <code>Domain</code> block. Notice that this differs significantly from the <code>Domain</code> block that would be expected for a bcc structure in a neat melt. The space group has been downgraded from the cubic <em>Im</em>-3<em>m</em> group to tetragonal <em>P</em>4/<em>mmm</em>. See the Space Groups section below for more information about determining the appropriate space group symmetry for a thin film. Also notice that we have chosen specific and intentional values for the <b>c</b> lattice vector and the mesh discretization in that direction, which will be discussed further below.</p>
<h3><a class="anchor" id="autotoc_md5"></a>
Iterator Block</h3>
<p >Now, we proceed to the <code>AmIteratorFilm</code> block. The first four parameters in this block define the AmIterator object and do not pertain to the thin film constraint (from <code>maxItr</code> to <code>isFlexible</code>). Then we get to the variables that define the mask. The first required variable is <code>normalVecId</code>, indicating which of the 3 lattice basis vectors is oriented normal to the walls. The input should be either 0, 1, or 2, corresponding to the <b>a</b>, <b>b</b>, or <b>c</b> lattice vectors, respectively. In the example above, the <b>c</b> vector is normal to the wall. Importantly, the two vectors that are <em>not</em> normal to the wall (<b>a</b> and <b>b</b> in the example above) must be parallel to the wall. So, if <b>c</b> is normal to the wall, then the unit cell angles <em>&alpha;</em> and <em>&beta;</em> must both be 90&deg;. The software will throw an error if this condition is not met.</p>
<p >The next required inputs are <code>interfaceThickness</code> and <code>wallThickness</code>, which correspond to <em>t</em> and <em>T</em> in the expression for <em>&rho;</em><sub>wall</sub>(<em>z</em>) above. These values are defined in the same units as other length inputs (unit cell parameters, segment lengths). In the example, we have chosen <em>t</em> to be 0.1, or 0.25<em>R</em><sub>g</sub> based on information from the <code>Mixture</code> block, and we have chosen <em>T</em> to be 0.2, or 0.5<em>R</em><sub>g</sub>. Let us also briefly consider the parameter <em>L</em> (the length of the unit cell in the direction normal to the wall) in the context of the example parameter file above, now that we have defined <em>T</em>. Since we have declared that the <b>c</b> lattice basis vector is orthogonal to the wall, the length of <b>c</b> is equivalent to <em>L</em>. The parameter <em>L</em> is thus defined in the <code>Domain</code> block to be 4.2. However, because of the presence of the walls, the thickness of the actual polymer/solvent film is instead equal to <em>L&ndash;T</em>, or 4.0. If we expect that the bcc structure will have a cubic lattice parameter of ~2.0, then we are effectively targeting a film that is two unit cells thick.</p>
<p >Next, there is an optional input array <code>chi</code>. This allows the user to define a Flory-Huggins-like interaction parameter between each monomer species and the walls. If <code>chi</code> is not specified, then all values are set to zero (an athermal wall). For a system with <code>n</code> monomer species, the chi array will be <code>n</code> rows and two columns. Each row corresponds to a single monomer species, in the same order that they are listed in the <code>monomers[</code> block. The first column represents the chi parameter between wall 1 and each monomer species, while the second column represents the chi parameter between wall 2 and each monomer species (we define wall 1 to be the wall that intersects the origin). In the example above, we have two monomer species, with species indices 0 and 1. Wall 1 interacts slightly more favorably with the monomer species with index 1, while wall 2 interacts with a relatively strong favorability for species 1. If the two columns in <code>chi</code> are identical, then the walls are said to be "chemically identical."</p>
<p >The additional contribution to the overall free energy (per monomer) of the system arising from wall-polymer and wall-solvent interactions, which we will call <em>F</em><sub>wall</sub>, are calculated based on the chi values specified in the parameter file as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{F_{\rm wall}}{k_{\rm B}T}\frac{\nu}{V}=\frac{1}{V}\sum_{w=1}^{2} \sum_{\alpha=1}^{N_{\rm species}}\chi_{w\alpha}\int d{\bf r}\rho_w({\bf r}) \rho_\alpha({\bf r}) \]" src="form_53.png" width="241" height="39"/>
</p>
<p> where the index <em>w</em> denotes the wall (either wall 1 or wall 2), <em>&nu;</em> is the monomer reference volume, <em>&chi;<sub>w&alpha;</sub></em> is the chi interaction parameter between wall <em>w</em> and species <em>&alpha;</em> that is input from the parameter file, and <em>&rho;<sub>w</sub></em>(<b>r</b>) is the volume fraction of wall <em>w</em> at position <b>r</b> (note that this differs from <em>&rho;</em><sub>mask</sub>(<b>r</b>) above, which represents the volume fraction of <em>both</em> walls). It is important to note that the volume <em>V</em> in this expression is not the volume of the full unit cell, but rather the volume of space that is accessible to the polymers/solvents.</p>
<p >From an implementation standpoint, we actually model the chemical interactions between walls and polymers as an external field that is imposed on the system, affecting each monomer species differently. The shape of the external field in real space is identical to the density field of the wall, and its magnitude is dictated by the chi array defined by the user.</p>
<p >Finally, there are two optional inputs that can be used to write the mask field to a file. <code>wallBasisOutFile</code> and <code>wallRGridOutFile</code> specify the path/filename to which to write the mask field in symmetry-adapted basis format or real-space grid format, respectively. This can be useful if, for example, the user wishes to plot/visualize the shape of the wall in addition to the shape of the density profiles for each monomer species.</p>
<h3><a class="anchor" id="autotoc_md6"></a>
Sweep block</h3>
<p >We also briefly draw your attention to the Sweep block at the bottom of the example parameter file. To make it easier to efficiently explore the state space of thin film polymer systems, we have introduced two sweep parameters that are specific to thin film systems. First is <code>cell_param</code>, which allows for a sweep to be performed on any lattice parameter. The syntax for this sweep parameter is <code>cell_param i delta</code> where <code>i</code> is the index of the lattice parameter to be swept (starting from 0) and <code>delta</code> is the desired change in this parameter over the entire sweep. Note that <code>i</code> refers to the index of the parameter in the array that is input in the <code>unitCell</code> line of the parameter file. So, in the example above, <code>i</code> can only be 0 or 1 because there are only 2 lattice parameters specified on the <code>unitCell</code> line.</p>
<p >The second sweep parameter for thin films is <code>chi_wall</code>, which allows the user to sweep any of the values in the <code>chi</code> array that is input in the iterator block. The syntax for this sweep parameter is <code>chi_wall i j delta</code> where <code>i</code> and <code>j</code> specify the row and column indices of the chi value that will be swept (indexing starting from 0), respectively, and <code>delta</code> is the desired change in this parameter over the entire sweep. <code>i</code> must be less than n_monomer, and <code>j</code> must be either 0 or 1. In the example parameter file above, we show how to sweep the chi parameter in row 0, column 1, although we don't actually change the value (<code>delta</code> is 0.0) because that would break the symmetry of the space group that we've chosen, so the chi sweep is only included for illustrative purposes.</p>
<h3><a class="anchor" id="autotoc_md7"></a>
The effect of the parameter t</h3>
<p >It is important to note that the equation for <em>F</em><sub>wall</sub> above has an inherent linear dependence on <em>t</em>. For instance, consider a homopolymer melt where <em>&rho;</em><sub>polymer</sub> = 1 - <em>&rho;</em><sub>mask</sub> everywhere, and both walls are chemically identical. Then, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{F_{\rm wall}}{k_{\rm B}T}\frac{\nu}{V}= \frac{1}{V}\chi\int d{\bf r}\rho_{\rm mask}(1-\rho_{\rm mask}) \]" src="form_54.png" width="196" height="29"/>
</p>
<p> Using the expression for <em>&rho;</em><sub>mask</sub> above, one can show that the integral of <em>&rho;</em><sub>mask</sub>(1-<em>&rho;</em><sub>mask</sub>) is proportional to <em>t</em>. As such, the strength of the interactions between polymers/solvents and walls is dependent not only on &chi;<sub>&alpha;w</sub> but also on <em>t</em>. Because of this, it is strongly recommended to use the same value of <em>t</em> for all calculations that are to be compared to one another.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Variable Lattice Parameters</h3>
<p >When walls are added into the system, the user can still choose whether to fix the unit cell parameters or allow them to vary, but the implementation is slightly different. Specifically, the length of the lattice basis vector that is orthogonal to the wall (4.2 in the example above) is fixed, in order to force the thin film to maintain a constant thickness throughout the iteration process. Furthermore, we require that the other lattice basis vector(s) remain parallel to the walls. This implies the following:</p><ul>
<li>In 1D, the size of the unit cell is fixed.</li>
<li>In 2D, the length of the lattice basis vector parallel to the walls (either <b>a</b> or <b>b</b>) may vary, but the angle <em>&gamma;</em> between <b>a</b> and <b>b</b> is fixed at 90&deg;.</li>
<li>In 3D, the lengths of the lattice basis vectors that are parallel to the walls may vary, as can the angle between them. The two vectors in question depend on the choice of <code>normalVecId</code>. The length of the lattice basis vector that is normal to the wall (the vector indicated by <code>normalVecId</code>) is held fixed, and the remaining two angles are fixed at 90&deg;. This behavior is implemented automatically. If the user specifies that lattice parameters may vary, then the software will decide which lattice parameters are actually allowed to vary based on <code>normalVecId</code> and <code>unitCell</code>. If the user tries to define a unit cell that is incompatible with the rules above (<em>e.g.,</em> a 2D unit cell with <em>&alpha;</em> &ne; 90&deg;), the software will throw an error.</li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
Space Groups</h1>
<p >Although we are imposing a thin film constraint on the system, we still use periodic boundary conditions in all directions so that the symmetry-adapted basis functions used for bulk (non-thin film) calculations can be used without modification. However, the presence of two fixed walls in the system reduces the number of allowed symmetry operations for these unit cells, because the only allowed symmetry operations are those that leave the walls unchanged. Thus, the selection of the appropriate space group for a thin film requires more substantial thought than is the case for bulk systems.</p>
<h3><a class="anchor" id="autotoc_md10"></a>
Identifying the Correct Space Group</h3>
<p >The appropriate space group for a desired system can be identified by looking at the symmetry operations for the space group that describes the system in the bulk, removing those operations that are not allowed in the thin film (which differ depending on whether the walls are identical or not), and then finding the space group that contains only those symmetry operations that remain.</p>
<p >If, for example, the walls are in the <em>x-y</em> plane (param file contains "<code>normalVecId&#160;&#160;2</code>.") and the two walls are chemically identical, then symmetry operations that change <em>z</em> to <em>-z</em> are allowed because the walls are mirror images of each other. All other changes in <em>z</em> (<em>e.g.</em>, from <em>z</em> to <em>z</em>+1/2 in reduced coordinates) are forbidden, because these operations would result in the wall being moved to a different location than where it started. If the walls are chemically dissimilar, then the only symmetry operations that are permitted are those that leave <em>z</em> unchanged. The user is directed to online resources at <a href="https://www.cryst.ehu.es/">https://www.cryst.ehu.es/</a> and <a href="http://img.chem.ucl.ac.uk/sgp/mainmenu.htm">http://img.chem.ucl.ac.uk/sgp/mainmenu.htm</a> which provide, in great detail, tabulations of the symmetry operations for all space groups.</p>
<p >We can clarify further with an example, again considering the parameter file above for a thin film bcc structure. The space group for bcc in the bulk is <em>Im</em>-3<em>m</em>. We are imposing a wall that is parallel to the x-y plane, so the allowed symmetry operations for our thin film can only have (z -&gt; z) or (z -&gt; -z) transformations of the z coordinate (and the latter is only allowed for chemically identical walls). On <a href="http://img.chem.ucl.ac.uk/sgp/large/229az1.htm">this page</a> we can see the 96 symmetry operations for the <em>Im</em>-3<em>m</em> space group, and only 16 of them are allowed for the system with the wall present.</p>
<p >We then search for a space group with only these 16 symmetry operations. It will be in the tetragonal crystal system, because that is the shape of the unit cell that we expect for the thin film bcc structure. After searching through the tetragonal space groups, we find that <a href="http://img.chem.ucl.ac.uk/sgp/large/123az1.htm"><em>P</em>4/<em>mmm</em></a> is the space group we are looking for.</p>
<h3><a class="anchor" id="autotoc_md11"></a>
Relationship Between Unit Cell and Space Group</h3>
<p >An important detail to note is the difference between the space group and the unit cell. The unit cell shape only defines the lattice vectors along which the system has translational symmetry. By contrast, the space group defines all of the other allowed symmetry operations in the system, some of which are only allowed for unit cells of a certain shape. For example, a cubic space group (the highest possible symmetry) represents a set of symmetry operations that can only be applied to a cubic unit cell. However, this does not mean that a cubic <em>unit cell</em> must have cubic <em>symmetry</em>&mdash;it can also have the symmetry of any of the space groups associated with crystal systems of lower symmetry (<em>e.g.</em>, tetragonal). In the context of PSCF, this means that you can choose a unit cell and a space group that belong to different crystal systems, as long as the symmetry operations of that space group are all applicable to that unit cell. For example, a tetragonal unit cell could be used with a monoclinic space group. As another example, the triclinic space group <code>P_1</code>, which has no symmetry operations other than the identity, can be used alongside all possible choices of unit cell.</p>
<p >In the thin-film bcc example discussed above, it would be fine to declare a cubic unit cell with the <em>P</em>4/<em>mmm</em> space group; this would be used to simulate a bcc structure that is slightly less than 1 unit cell thick (because of the space occupied by the walls). However, to model a film with different thickness, a tetragonal unit cell is required, which keeps the <b>a</b> and <b>b</b> lattice basis vectors the same length but allows <b>c</b> to vary. An orthorhombic unit cell, however, would be incompatible with the <em>P</em>4/<em>mmm</em> space group; <em>P</em>4/<em>mmm</em> requires that <b>a</b> and <b>b</b> are the same length.</p>
<p >This brings up a final important consideration when setting up a PSCF system: the space group contains inherent choices of which lattice parameters are allowed to vary independently and which are not, which should be considered when choosing <code>normalVecId</code>. Tetragonal unit cells must have |<b>a</b>|=|<b>b</b>|, so the natural choice of <code>normalVecId</code> is 2, so that the lattice basis vector that is perpendicular to the film (<b>c</b>) is allowed to vary independently. In fact, the space group <em>P</em>4/<em>mmm</em> is not compatible with a <code>normalVecId</code> value of 0 or 1.</p>
<p >In 3D systems, it is recommended to choose 2 for <code>normalVecId</code>, except in the case of a monoclinic unit cell, which is more compatible with a <code>normalVecId</code> value of 1. This is because &beta; is the only angle allowed to vary in a monoclinic unit cell, but a choice of 0 or 2 for <code>normalVecId</code> would force &beta; to be 90&deg; and thus force the unit cell to be stuck in an orthorhombic shape.</p>
<h3><a class="anchor" id="autotoc_md12"></a>
Initial Guess</h3>
<p >We intend to develop a tool to generate an initial guess for thin film geometries using the form factor method and the level set method (see Arora, <em>et al.</em> (2016), <em>Macromolecules</em>, 49, 4675) for arbitrary particle and network phases. However, in the meantime, the recommended technique for generating an initial guess is to first converge the desired morphology as a bulk calculation, and generate a converged solution in rgrid format. Then, create a new rgrid with the desired mesh size/shape by duplicating the existing data periodically along any of the lattice basis vectors. For our bcc example above, we could take a 32x32x32 bcc solution in rgrid format, duplicate the data along the <em>z</em> direction to generate a 32x32x64 mesh of bcc data, and then add 4 more layers of data points in the <em>z</em> direction (2 on top and 2 on bottom) to represent the interior of the walls, all of which should have zero concentration for all species (as an initial guess). This leaves us with a 32x32x68 initial guess in rgrid format for the bcc thin film, which can subsequently be converted into an initial guess for the omega field in symmetry-adapted basis format by using the RGRID_TO_FIELD and RHO_TO_OMEGA commands in the command file.</p>
<h3><a class="anchor" id="autotoc_md13"></a>
Rules for Determining Allowed Space Groups</h3>
<p >Here we present a comprehensive list of the rules determining permitted/forbidden choices of unit cell and space group in a thin film system, which have been alluded to in the above discussion.</p>
<p >The systems that are compatible with the thin film constraint must obey the following rules:</p><ul>
<li>One lattice basis vector must be normal to the walls, and all other lattice basis vectors must be parallel to the walls (discussed above).<ul>
<li>This forces all 2D oblique unit cells to assume a rectangular shape, all 3D trigonal unit cells to assume a cubic shape, and all 3D triclinic unit cells to assume a monoclinic shape, so it is pointless to use oblique, trigonal, or triclinic unit cells.</li>
<li>If normalVecId = 0 or 2 for a monoclinic unit cell, then &beta; (the only flexible angle) is forced to be 90&deg;, forcing the unit cell to assume an orthorhombic shape, so normalVecId = 1 is the recommended choice for monoclinic unit cells.</li>
<li>Setting normalVecId = 0 or 1 for a hexagonal unit cell is not allowed, since &gamma;=120&deg;.</li>
</ul>
</li>
<li>The only permitted Bravais lattice sites are on the faces/edges of the unit cell that are parallel to the walls.<ul>
<li>This prohibits all 3D space groups with a face-centered or body-centered Bravais lattice, as well as all 2D space groups with a centered rectangular Bravais net.</li>
</ul>
</li>
<li>Mirror planes and two-fold rotation axes must be either parallel or perpendicular to the walls. They may only be parallel to the walls if the two walls are chemically identical.</li>
<li>3, 4, and 6-fold rotation axes are only permitted if they are perpendicular to the walls.<ul>
<li>This prohibits all 3D space groups in the cubic crystal system, as well as all 2D space groups in the square and hexagonal crystal systems).</li>
</ul>
</li>
<li>Glide planes and two-fold screw axes are permitted if they are parallel to the walls, and only if both walls are chemically identical. All other non-symmorphic symmetry operations (glides and screws) are forbidden.</li>
<li>Inversion centers and rotoinversions are only permitted if the walls are chemically identical.</li>
<li>The only allowed space groups in the trigonal crystal system are those with a hexagonal Bravais lattice (space groups starting with "P"). Trigonal space groups with a rhombohedral Bravais lattice (starting with "R") do not have any lattice vector that is normal to the other two. Although one can represent a rhombohedral Bravais lattice in a non-primitive hexagonal unit cell, this results in two Bravais lattice sites in the middle of the unit cell, which is not allowed. As such, neither representation of such a unit cell is compatible with thin film constraints. The distinction between crystal system, Bravais lattice, and unit cell can be confusing for the trigonal crystal system, so the reader is directed to the very helpful summary at <a href="https://en.wikipedia.org/wiki/Hexagonal_crystal_family">https://en.wikipedia.org/wiki/Hexagonal_crystal_family</a> for more details.</li>
</ul>
<h3><a class="anchor" id="autotoc_md14"></a>
List of Allowed Space Groups</h3>
<p >A comprehensive list of allowed space groups is given below. The entries that are listed in bold are those that are allowed for chemically dissimilar walls; all other entries are only allowed for chemically identical walls. Note that, in 3D, every bolded space group corresponds to a 2D plane group symmetry; there are exactly 17 space group symmetries for chemically dissimilar walls in 3D, just as there are 17 plane group symmetries for 2D unit cells.</p>
<p >In constructing this list, we assumed that normalVecId is set to 2 for orthorhombic, tetragonal, trigonal, and hexagonal space groups. For other choices of normalVecId, the allowed space groups will likely differ.</p>
<ul>
<li>1D:<ul>
<li>Lamellar (only relevant for studying lamellae parallel to the walls)<ul>
<li><code> <b>P_1</b> </code></li>
<li><code> P_-1 </code></li>
</ul>
</li>
</ul>
</li>
<li>2D:<ul>
<li>Oblique (<em>&gamma;</em> must be 90&deg;, use rectangular unit cell)<ul>
<li><code> <b>p_1</b> </code></li>
<li><code> p_2 </code></li>
</ul>
</li>
<li>Rectangular<ul>
<li><code> <b>p_m</b> </code> (normalVecId must be 1 if walls are chemically dissimilar)</li>
<li><code> p_g </code> (normalVecId must be 0)</li>
<li><code> p_2_m_m </code></li>
<li><code> p_2_m_g </code> (normalVecId must be 1)</li>
</ul>
</li>
</ul>
</li>
<li>3D:<ul>
<li>Triclinic<ul>
<li><code> <b>P_1</b> </code></li>
<li><code> P_-1 </code></li>
</ul>
</li>
<li>Monoclinic (normalVecId = 1, &beta; &ne; 90&deg;)<ul>
<li><code> <b>P_2</b> </code></li>
<li><code> P_1_m_1 </code></li>
<li><code> P_1_c_1 </code></li>
<li><code> P_1_2%m_1 </code></li>
<li><code> P_1_2%c_1 </code></li>
</ul>
</li>
<li>Monoclinic space group, orthorhombic unit cell (&beta; = 90&deg;)<ul>
<li><code> P_1_21_1 </code> (normalVecId must be 0 or 2)</li>
<li><code> C_1_2_1 </code> (normalVecId must be 2)</li>
<li><code> <b>P_1_m_1</b> </code> (normalVecId must be 0 or 2)</li>
<li><code> <b>P_1_c_1</b> </code> (normalVecId must be 0)</li>
<li><code> <b>C_1_m_1</b> </code> (normalVecId must be 2)</li>
<li><code> P_1_2%m_1 </code> (normalVecId can be 0, 1, or 2)</li>
<li><code> P_1_21%m_1 </code> (normalVecId must be 0 or 2)</li>
<li><code> C_1_2%m_1 </code> (normalVecId must be 2)</li>
<li><code> P_1_2%c_1 </code> (normalVecId must be 0 or 1)</li>
<li><code> P_1_21%c_1 </code> (normalVecId must be 0)</li>
</ul>
</li>
<li>Orthorhombic<ul>
<li><code> P_2_2_2 </code></li>
<li><code> P_21_21_2 </code></li>
<li><code> C_2_2_2 </code></li>
<li><code> <b>P_m_m_2</b> </code></li>
<li><code> <b>P_m_a_2</b> </code></li>
<li><code> <b>P_b_a_2</b> </code></li>
<li><code> <b>C_m_m_2</b> </code></li>
<li><code> P_m_m_m </code></li>
<li><code> P_b_a_n:1 </code></li>
<li><code> P_b_a_n:2 </code></li>
<li><code> P_m_m_a </code></li>
<li><code> P_b_a_m </code></li>
<li><code> P_m_m_n:1 </code></li>
<li><code> P_m_m_n:2 </code></li>
<li><code> C_m_m_m </code></li>
<li><code> C_m_m_a </code></li>
</ul>
</li>
<li>Tetragonal<ul>
<li><code> <b>P_4</b> </code></li>
<li><code> P_-4 </code></li>
<li><code> P_4%m </code></li>
<li><code> P_4%n:1 </code></li>
<li><code> P_4%n:2 </code></li>
<li><code> P_4_2_2 </code></li>
<li><code> P_4_21_2 </code></li>
<li><code> <b>P_4_m_m</b> </code></li>
<li><code> <b>P_4_b_m</b> </code></li>
<li><code> P_-4_2_m </code></li>
<li><code> P_-4_21_m </code></li>
<li><code> P_-4_m_2 </code></li>
<li><code> P_-4_b_2 </code></li>
<li><code> P_4%m_m_m </code></li>
<li><code> P_4%n_b_m:1 </code></li>
<li><code> P_4%n_b_m:2 </code></li>
<li><code> P_4%m_b_m </code></li>
<li><code> P_4%n_m_m:1 </code></li>
<li><code> P_4%n_m_m:2 </code></li>
</ul>
</li>
<li>Trigonal<ul>
<li><code> <b>P_3</b> </code></li>
<li><code> P_-3 </code></li>
<li><code> P_3_1_2 </code></li>
<li><code> P_3_2_1 </code></li>
<li><code> <b>P_3_m_1</b> </code></li>
<li><code> <b>P_3_1_m</b> </code></li>
<li><code> P_-3_1_m </code></li>
<li><code> P_-3_m_1 </code></li>
</ul>
</li>
<li>Hexagonal<ul>
<li><code> <b>P_6</b> </code></li>
<li><code> P_-6 </code></li>
<li><code> P_6%m </code></li>
<li><code> P_6_2_2 </code></li>
<li><code> <b>P_6_m_m</b> </code></li>
<li><code> P_-6_m_2 </code></li>
<li><code> P_-6_2_m </code></li>
<li><code> P_6%m_m_m </code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p ><br  />
 <a class="el" href="user_groups_page.html">3.8 Space Groups</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_page.html">3 User Guide</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">4 Developer Information</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 26 2022 14:20:47 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
