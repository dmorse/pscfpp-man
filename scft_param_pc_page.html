<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Parameter File - pscf_pc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="scft_page.html">Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="scft_param_page.html">Parameter Files</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Parameter File - pscf_pc</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="scft_param_1d_page.html">Parameter File - pscf_1d</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_param_pg_page.html">Parameter File - pscf_pg</a> (Next) <br  />
</p>
<p>The pscf_pc and pscf_pg programs for periodic systems use nearly identical parameter file formats, and so are discussed together here. The description given here only covers required and optional elements relevant to SCFT calculations. A complete description of the parameter file format for either of these programs, including optional elements that not relevant to SCFT, is given <a class="el" href="rpc_System_page.html">here</a>.</p>
<h1><a class="anchor" id="scft_param_pc_example_sec"></a>
Example</h1>
<p>The example show below is a typical parameter file for setting up an SCFT calculation for a perodic structure of known space group symmetry of a diblock copolymer melt using either pscf_pc or pscf_pg.</p>
<div class="fragment"><div class="line">System{</div>
<div class="line">  Mixture{</div>
<div class="line">    nMonomer  2</div>
<div class="line">    monomers[</div>
<div class="line">              A   1.0</div>
<div class="line">              B   1.0</div>
<div class="line">    ]</div>
<div class="line">    nPolymer  1</div>
<div class="line">    Polymer{</div>
<div class="line">      type    linear</div>
<div class="line">      nBlock  2</div>
<div class="line">      blocks[</div>
<div class="line">              0  0.25</div>
<div class="line">              1  0.75</div>
<div class="line">      ]</div>
<div class="line">      phi     1.0</div>
<div class="line">    }</div>
<div class="line">    ds   0.01</div>
<div class="line">  }</div>
<div class="line">  Interaction{</div>
<div class="line">    chi(</div>
<div class="line">          1   0   20.0</div>
<div class="line">    )</div>
<div class="line">  }</div>
<div class="line">  Domain{</div>
<div class="line">    mesh             32  32  32</div>
<div class="line">    lattice          cubic</div>
<div class="line">    groupName        I_m_-3_m</div>
<div class="line">  }</div>
<div class="line">  Iterator{</div>
<div class="line">    epsilon      1e-10</div>
<div class="line">    maxItr       100</div>
<div class="line">    maxHist      50</div>
<div class="line">    isFlexible   1</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="scft_param_pc_system_sec"></a>
File format</h1>
<p>The main <a class="el" href="classPscf_1_1Rpc_1_1System.html" title="Main class for SCFT or PS-FTS simulation of one system.">System</a> block of a parameter file for an SCFT calculation peformed using pscf_pc or pscf_pg has the same overall structure as that used for pscf_1d. The required elements for an SCFT calculation can be described by the format skeleton: </p><div class="fragment"><div class="line">System{</div>
<div class="line">  Mixture{ ...  }</div>
<div class="line">  Interaction{ ...  }</div>
<div class="line">  Domain{ ...  }</div>
<div class="line">  Iterator#*{ ... }</div>
<div class="line">  Sweep#*{ ... }</div>
<div class="line">}</div>
</div><!-- fragment --><p> As for pscf_1d, the <a class="el" href="classPscf_1_1Rpc_1_1Sweep.html" title="Solve a sequence of SCFT problems along a line in parameter space.">Sweep</a> block is optional, and <a class="el" href="classPscf_1_1Rpc_1_1Iterator.html" title="Base class for iterative solvers for SCF equations.">Iterator</a> and <a class="el" href="classPscf_1_1Rpc_1_1Sweep.html" title="Solve a sequence of SCFT problems along a line in parameter space.">Sweep</a> blocks (if present) are both selectable blocks. The above skeleton includes only blocks that are relevant for SCFT calculations, and excludes some optional elements that are used for FTS calculations. A complete description of the format for the main <a class="el" href="classPscf_1_1Rpc_1_1System.html" title="Main class for SCFT or PS-FTS simulation of one system.">System</a> block of pscf_pc parameter file is given <a class="el" href="rpc_System_page.html">here</a>.</p>
<p>Formats of the <a class="el" href="classPscf_1_1Rpc_1_1Mixture.html" title="Solver for a mixture of polymers and solvents.">Mixture</a> and <a class="el" href="classPscf_1_1Interaction.html" title="Flory-Huggins excess free energy model.">Interaction</a> blocks are the same for all PSCF programs, and have thus been discussed previously. Below, we discuss the contents of the <a class="el" href="classPscf_1_1Rpc_1_1Domain.html" title="Spatial domain and spatial discretization for a periodic structure.">Domain</a>, <a class="el" href="classPscf_1_1Rpc_1_1Iterator.html" title="Base class for iterative solvers for SCF equations.">Iterator</a>, and <a class="el" href="classPscf_1_1Rpc_1_1Sweep.html" title="Solve a sequence of SCFT problems along a line in parameter space.">Sweep</a> blocks.</p>
<h1><a class="anchor" id="scft_param_pc_domain_sec"></a>
Domain block</h1>
<p>The <a class="el" href="classPscf_1_1Rpc_1_1Domain.html" title="Spatial domain and spatial discretization for a periodic structure.">Domain</a> block contains information required to describe the unit cell of a periodic structure, the regular mesh that is used to discretize fields within each unit cell, and (optionally) an identifier for the space group of the desired solution. The parameter file format is discussed below, as well as in separate page <a class="el" href="rpc_Domain_page.html">here</a>.</p>
<p>An example of the format of this block is shown below: </p><div class="fragment"><div class="line">Domain{</div>
<div class="line">  mesh        32  32  32</div>
<div class="line">  lattice     cubic</div>
<div class="line">  groupName   I_m_-3_m</div>
<div class="line">}</div>
</div><!-- fragment --><p> The format for this block is </p><div class="fragment"><div class="line">Domain{</div>
<div class="line">   mesh        Array[int] (D elements)</div>
<div class="line">   lattice     <span class="keywordtype">string</span></div>
<div class="line">   groupName*  <span class="keywordtype">string</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> The groupName parameter is optional, but must be included to enable SCFT calculations that seek a solution of specified space group symmetry. The unitCell, mesh and groupName parameter lines are discussed separately below.</p>
<p><b> mesh </b></p>
<p>The value of the variable "mesh" is a vector of integers that specifies the number of grid points along each direction of the uniform spatial mesh used to discretize fields within each unit cell of the crystal. The number of integers is equal to the dimensionality D of the periodic unit cell. The format is </p><div class="fragment"><div class="line">mesh   N[0] .... N[D-1]</div>
</div><!-- fragment --><p> where N[i] is the number of grid points along axis number i, for i = 0 ,..., D-1.</p>
<p>The dimensions N[0], ... , N[D-1] of the spatial mesh are initialized to the values given in the parameter file and cannot be changed during the lifetime of a program, except by rerunning the program with a modified parameter file.</p>
<p><b> lattice </b></p>
<p>The value of the parameter "lattice" is given by string that specifies the desired crystal system type. The set of allowed values for this string depends on the dimensionality of space. There are 7 allowed values of the lattice string for a 3D structure, corresponding to the 7 types of 3D crystal system, with names given by the strings "cubic", "tetragonal", "orthorhombic", "hexagonal", "rhombohedral", "monoclinic", and "triclinic". The allowed values for a 2D system include "square", "rectangular", "hexagonal" "rhombic" and "oblique". There is only one allowed lattice system for a 1D crystal, which is referred to as "lamellar". A more detailed discussion of each of the possible lattice systems is given in a separate page that documents conventions for <a class="el" href="scft_unitcell_page.html">unit cells</a>.</p>
<p><b> groupName </b></p>
<p>The "spaceGroup" is an optional string parameter that, if present, identifies the crystallographic space group for the structure of interest. Each allowed value of the groupName string corresponds to a modified version of the name of a space group, as listed in the international tables of crystallography. In the above example, the groupName string I_m_-3_m is a modified form of the name \(Im\overline{3}m\) for the space group for a BCC lattice. PSCF uses a set of conventions for converting an international table symbol for a space group into a text string that involve insertion of underbars between logical elements and the use of - sign to represent an overbar, among other conventions. Allowed identifiers for crystallographic space groups are listed and discussed in more detail <a class="el" href="scft_groups_page.html">here</a>.</p>
<p>If groupName identifer is present, it is used construct a space group (i.e., a set of symmetry operations) and a symmetry-adapted Fourier basis. A symmetry-adapted Fourier basis is a set of functions of position that are all eigenfunctions of the Laplacian and are all invariant under all symmetry operations in the specified space group, which can be used as a basis for expanding functions with the specified symmetry. The algorithm used to construct such a basis requires knowledge of a set of initial values for the unit cell parameters. This symmetry-adapted basis is thus normally constructed immediately after the first time unit cell parameters are initialized, e.g., by reading the values given in a file that contains a description of a field.</p>
<p><b> Unit cell parameters (absence from parameter file) </b></p>
<p>To completely describe the Bravais lattice for a crystal with a known crystal system, one must assign values to a list of parameters that give the lengths of the edges of the unit cell and, for some crystal systems, angles between some of these edges. The number of unit cell parameters required to describe a unit cell is different for different lattice system. For example, a 3D cubic crystal can be described using a single parameter that gives the length of any edge of a cubic unit cell. Three parameters are required to describe an orthorhombic unit cell, to specify lengths of three orthogonal Bravais basis vectors, while 6 parameters are required for a triclinic unit cell, to specify 3 independent unit cell lengths and 3 angles. The unit cell parameters for each unit cell type are stored in an array that lists the required parameters in some pre-specified order. Conventions for the meaning of the required parameters and the order in which they are listed are described for each crystal system in a separate page of documentation about <a class="el" href="scft_unitcell_page.html">unit cells</a>.</p>
<p>Values for unit cell parameters are not specified in the parameter files for pscf_pc or pscf_pg. These parameters values are instead specified within the header section of files that describe periodic chemical potential fields (w-fields) or monomer concentration fields (c-cields). The unit cell parameters are thus normally first assigned values during execution of the first command in the command file that causes the program to read such a field from file. There also exists a command named SET_UNIT_CELL that a user can invoke to manually set or reset the unit cell parameter values at any point during processing of a command file. If the <a class="el" href="classPscf_1_1Rpc_1_1Domain.html" title="Spatial domain and spatial discretization for a periodic structure.">Domain</a> block of the parameter file contains a space group name, a symmetry-adapted Fourier basis for that space group is constructed immediately after the first time that unit cell parameters are assigned initial values by either mechanism (e.g., the first time a field is read from a file or the SET_UNIT_CELL command is invoked).</p>
<p>Unit cell parameters for a crystal are changed many times during SCFT calculations for systems with flexible unit cells, in which the unit cell parameters are adjusted so as to minimize the free energy density. At the end of such a calculation, converged values for the optimal unit cell parameters are normally output within the header of a file that contains the converged w-fields.</p>
<h1><a class="anchor" id="scft_param_pc_iterator_sec"></a>
Iterators</h1>
<p>The default <a class="el" href="classPscf_1_1Rpc_1_1Iterator.html" title="Base class for iterative solvers for SCF equations.">Iterator</a> for the pscf_pc and pscf_pg programs is based on an algorithm that uses an Anderson-Mixing (AM) iterator algorithm, and that imposes a specified space group symmetry. This default iterator can be invoked in pscf_pc using either the generic label "Iterator" or the specific label "AmIteratorBasis". This is currently the only iterator available in pscf_pc. A description of the parameter file format for this iterator is given <a class="el" href="rpc_AmIteratorBasis_page.html">here</a>.</p>
<p>The <a class="el" href="classPscf_1_1Rpc_1_1AmIteratorBasis.html" title="Rpc implementation of the Anderson Mixing iterator with symmetry.">AmIteratorBasis</a> is designed to search for a solution with a specified space group symmetry, and can only be used with a parameter file that contains a valid groupName parameter. The pscf_pg program, however, also provides an Anderson-Mixing algorithm named AmIteratorGrid that does not impose any space-group symmetry, and that can be used with a parameter file that does not contain a groupName string.</p>
<p>The <a class="el" href="classPscf_1_1Rpc_1_1Iterator.html" title="Base class for iterative solvers for SCF equations.">Iterator</a> block of the parameter file is formally optional (i.e., the program will finish reading the parameter file if it is omitted), but is required to enable SCFT calculations. An <a class="el" href="classPscf_1_1Rpc_1_1Iterator.html" title="Base class for iterative solvers for SCF equations.">Iterator</a> block is not needed to peform a field theoretic simulation.</p>
<h1><a class="anchor" id="scft_param_pc_sweep_sec"></a>
Sweep</h1>
<p>The <a class="el" href="classPscf_1_1Rpc_1_1Sweep.html" title="Solve a sequence of SCFT problems along a line in parameter space.">Sweep</a> block is another a block that (like the <a class="el" href="classPscf_1_1Rpc_1_1Iterator.html" title="Base class for iterative solvers for SCF equations.">Iterator</a> block for pscf_pc) has been programmed as a selectable block, but for which there is currently only one available algorithm. The only sweep algorithm that is currently available for use with either pscf_pc or pscf_pg is a general linear sweep algorithm, which is also the default algorithm. Such a linear sweep can thus be enabled by including a block that starts either with the generic label "Sweep" (as done in any examples shown here that include a sweep block) or the specific label "LinearSweep". The format of the associated parameter file block is described <a class="el" href="scft_param_sweep_page.html#scft_param_sweep_linear_sec">here</a>.</p>
<h1><a class="anchor" id="scft_param_pc_seealso_sec"></a>
See Also:</h1>
<ul>
<li>
<a class="el" href="rpc_System_page.html">System</a>  </li>
<li>
<a class="el" href="user_param_mixture_page.html">Mixture</a>  </li>
<li>
<a class="el" href="user_param_example_page.html#user_param_example_interaction">Interaction</a>  </li>
<li>
<a class="el" href="rpc_Domain_page.html">Domain</a>  </li>
<li>
<a class="el" href="rpc_AmIteratorBasis_page.html">AmIteratorBasis</a>  </li>
<li>
<a class="el" href="scft_param_sweep_page.html">Sweep</a>  <ul>
<li>
<a class="el" href="scft_param_sweep_page.html#scft_param_sweep_linear_sec">LinearSweep</a>  </li>
</ul>
</li>
</ul>
<p><br  />
 <a class="el" href="scft_param_1d_page.html">Parameter File - pscf_1d</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_param_page.html">Parameter Files</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="scft_param_pg_page.html">Parameter File - pscf_pg</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 14 2025 16:24:04 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
