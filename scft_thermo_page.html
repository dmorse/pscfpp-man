<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Thermodynamic Properties</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="scft_page.html">Self-Consistent Field Theory</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Thermodynamic Properties</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="scft_command_page.html">Command Files</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_unitcell_page.html">Crystal Unit Cells</a> (Next) <br  />
</p>
<p>The thermodynamic properties obtained for a converged SCFT solution are output by PSCF in a standard format that we refer to a thermo file block, or simply a thermo block. A thermo block can also be written to a specified file by the WRITE_THERMO command. A thermo block also appears within the log information that is written to standard output during execution of an ITERATE command, as well as within each of the <a class="el" href="#scft_thermo_state_sec">state</a> files that are created by a SWEEP command.</p>
<h1><a class="anchor" id="scft_thermo_format_sec"></a>
Thermo file block format</h1>
<p>An example of the thermo block format produced by an SCFT calculation for a periodic system is shown below:</p>
<div class="fragment"><div class="line">fHelmholtz    -2.75154924314e+01</div>
<div class="line">pressure       3.24415250701e+01</div>
<div class="line"> </div>
<div class="line">fIdeal        -3.44570175013e+01</div>
<div class="line">fInter         6.94152506994e+00</div>
<div class="line"> </div>
<div class="line">polymers:</div>
<div class="line">             phi                 mu</div>
<div class="line">    0   5.00000000000e-01   2.74031671637e+01</div>
<div class="line"> </div>
<div class="line">solvents:</div>
<div class="line">             phi                 mu</div>
<div class="line">    0   5.00000000000e-01  -3.51022037728e-01</div>
<div class="line"> </div>
<div class="line">cellParams:</div>
<div class="line">    0   1.62132469978e+01</div>
</div><!-- fragment --><p>The following section discusses each of the entries in this file format, describing the meaning of each property and the units and conventions used to define its numerical value.</p>
<h1><a class="anchor" id="scft_thermo_energetic_sec"></a>
Properties</h1>
<h2><a class="anchor" id="scft_thermo_helmholtz_sub"></a>
Helmholtz free energy</h2>
<p>The property "fHelmholtz" is a non-dimensional form of the Helmholtz free energy, which will be denoted here by the symbol \( \tilde{f} \). The reported value is actually the free energy per monomer reference volume in thermal energy units. That is, the value reported for "fHelmholtz" for a system with a total Helmholtz free energy \( F \) and associated volume \( V \) is given by ratio   </p><p class="formulaDsp">
\[
    \tilde{f} \equiv \frac{Fv}{Vk_{B}T}
\]
</p>
<p> where \( v \) is the monomer reference volume.</p>
<p>In the special case of a one-component block polymer melt for which the input parameters are given using the <a class="el" href="user_model_page.html#user_model_theorist_sub">theorists convention</a> that overall chain length is equal to 1.0, the monomer reference volume is equal to the volume per chain. In this case, the value reported for "fHelmholtz" is also the free energy per chain in thermal energy units, with \( k_{B}T = 1 \). More generally, in a mixture, one can obtain the free energy associated with the volume occupied by a molecular species by multiplying the overall contour length (for polymers) or size (for solvents) of the species by the value reported for "fHelmholtz".</p>
<h2><a class="anchor" id="scft_thermo_pressure_sub"></a>
Pressure and grand-canonical free energy</h2>
<p>The property "pressure" reported by PSCF is a non-dimensionalized thermodynamic pressure that is computed from the value of the grand-canonical free energy density. Consider a system that contains a total of \( N_{a} \) molecules of molecular species \( a \), and let \( \mu_{a} \) denote the chemical potential of species \( a \), for each polymer and solvent species. Let \( \Phi \) denote the so-called "grand" or "grand-canonical" free energy, defined as   </p><p class="formulaDsp">
\[
   \Phi \equiv F - \sum_{a}\mu_{a}N_{a} \quad,
\]
</p>
<p> in which the sum is taken over all polymer and solvent molecular species in the system. We define a thermodynamic pressure \( P \) via the identity   </p><p class="formulaDsp">
\[
    \Phi = -PV  \quad,
\]
</p>
<p> where \( V \) is total system volume. The property reported by PSCF as "pressure", which is denoted here by the symbol \( \tilde{p} \), is actually the value of the ratio   </p><p class="formulaDsp">
\[
    \tilde{p} = \frac{Pv}{k_{B}T} = -\frac{\Phi v}{Vk_{B}T} \quad.
\]
</p>
<p> The value of pressure reported by PSCF is thus \( -1 \) times the grand-canonical free energy per monomer reference volume, in thermal energy units.</p>
<h2><a class="anchor" id="scft_thermo_f_components_sub"></a>
Free energy components</h2>
<p>The next two parameters, "fIdeal" and "fInter", are individual components of the Helmholtz free energy. "fInter" is an interaction free energy, representing the contribution to the Helmholtz free energy arising from interactions between dissimilar monomer species. "fIdeal" is the contribution to the Helmholtz free energy from everything else. This can be thought of as the free energy of a non-interacting ideal gas of polymers in the self-consistent chemical potential fields.</p>
<p>In calculations with an external field, a third term will appear here: "fExt". This represents the contribution to the Helmholtz free energy arising from interactions between the monomer species and the external potential fields.</p>
<h2><a class="anchor" id="scft_thermo_species_sub"></a>
Polymer and solvent species</h2>
<p>The next two sections of the example given above are labeled "polymers" and "solvents". These are lists, with one row per chemical species, in which each row gives the species index, the overall volume fraction "phi", and the chemical potential "mu" of that chemical species. Note that the chemical potential values are in thermal energy units, so the numerical value reported for species \( a \) actually \( \mu_{a} / k_{B}T \).</p>
<h2><a class="anchor" id="scft_thermo_params_sub"></a>
Lattice parameters</h2>
<p>The final section, labeled "cellParams", lists the lattice parameters for the converged SCFT solution. This section appears in the output of SCFT calculations for periodic systems performed using pscf_pc or pscf_pg programs. It does not appear in the output of calculations for one-dimensional systems performed using pscf_1d, since the domain size is fixed by the user in pscf_1d calculations. In pscf_pc and pscf_pg calculations, some or all of the lattice parameters may be flexible, and are adjusted during the SCFT calculation so as to minimize the free energy density. In this case, the converged values of lattice parameters values that are allowed to vary are important output of the calculation. If an SCFT calculation is run with no flexible lattice parameters (i.e., a rigid unit cell) this section of the thermo block simply reports the lattice parameters values that were used as inputs. Input values for lattice parameters are normally provided within the header block of the file used to provide an initial guess for the monomer chemical potential fields (the w fields). The lattice parameters are reported in whatever <a class="el" href="user_model_page.html#user_model_length_sec">length units</a> were used in the input field and parameter files.</p>
<h1><a class="anchor" id="scft_thermo_state_sec"></a>
State files</h1>
<p>A "state" file is a type of file that is created for each state (i.e., each set of input parameters) during a <a class="el" href="scft_param_sweep_page.html">parameter sweep</a> performed by a SWEEP command. Each such state file is comprised of a parameter file block followed by a thermo file block. The parameter file block contains the input parameters used for the SCFT calculation at that state, with the Sweep block excluded, formatted in the nested curly-bracket syntax of a PSCF parameter file. The thermo block contains thermodynamic properties computed for the converged solution. Each state file thus gives all of the input <em>and</em> output parameters for a single calculation, fully describing that state. Names of state files that are generated by a SWEEP command contain an integer index followed by the file extension ".stt".</p>
<p>A state file can also be generated for an individual calculation (as opposed to a parameter sweep) by using the command WRITE_PARAM followed by the command WRITE_THERMO, while using the same file name argument for both commands. In the command file, this might look like </p><div class="fragment"><div class="line">WRITE_PARAM    out/state</div>
<div class="line">WRITE_THERMO   out/state</div>
</div><!-- fragment --><p> The WRITE_THERMO command is designed to append to the end of an existing file rather than overwrite it in order to allow both blocks to be written to a single file.</p>
<p>An example of the format of a state file is shown below for a system that forms a lamellar phase of a diblock copolymer in a selective solvent. </p><div class="fragment"><div class="line">System{</div>
<div class="line">  Mixture{</div>
<div class="line">    nMonomer                               3</div>
<div class="line">    monomers[</div>
<div class="line">                         6.07000000e+00</div>
<div class="line">                         6.07000000e+00</div>
<div class="line">                         6.07000000e+00</div>
<div class="line">    ]</div>
<div class="line">    nPolymer                               1</div>
<div class="line">    nSolvent                               1</div>
<div class="line">    Polymer{</div>
<div class="line">      type                              linear</div>
<div class="line">      nBlock                                 2</div>
<div class="line">      blocks[</div>
<div class="line">                                              0    3.500000000000e-01</div>
<div class="line">                                              1    6.500000000000e-01</div>
<div class="line">      ]</div>
<div class="line">      phi                   5.000000000000e-01</div>
<div class="line">    }</div>
<div class="line">    Solvent{</div>
<div class="line">      monomerId                              2</div>
<div class="line">      size                  2.000000000000e-02</div>
<div class="line">      phi                   5.000000000000e-01</div>
<div class="line">    }</div>
<div class="line">    ds                    1.000000000000e-02</div>
<div class="line">  }</div>
<div class="line">  Interaction{</div>
<div class="line">    chi(</div>
<div class="line">                           0    0   0.000000000000e+00</div>
<div class="line">                           1    0   3.000000000000e+01</div>
<div class="line">                           1    1   0.000000000000e+00</div>
<div class="line">                           2    0   3.000000000000e+01</div>
<div class="line">                           2    1   1.000000000000e+02</div>
<div class="line">                           2    2   0.000000000000e+00</div>
<div class="line">    )</div>
<div class="line">  }</div>
<div class="line">  Domain{</div>
<div class="line">    mesh                                       100</div>
<div class="line">    lattice                         lamellar</div>
<div class="line">    groupName                           P_-1</div>
<div class="line">  }</div>
<div class="line">  AmIterator{</div>
<div class="line">    epsilon               1.000000000000e-11</div>
<div class="line">    maxItr                               200</div>
<div class="line">    maxHist                               30</div>
<div class="line">    verbose                                1</div>
<div class="line">    isFlexible                             1</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">fHelmholtz    -2.75154924314e+01</div>
<div class="line">pressure       3.24415250701e+01</div>
<div class="line"> </div>
<div class="line">fIdeal        -3.44570175013e+01</div>
<div class="line">fInter         6.94152506994e+00</div>
<div class="line"> </div>
<div class="line">polymers:</div>
<div class="line">             phi                 mu</div>
<div class="line">    0   5.00000000000e-01   2.74031671637e+01</div>
<div class="line"> </div>
<div class="line">solvents:</div>
<div class="line">             phi                 mu</div>
<div class="line">    0   5.00000000000e-01  -3.51022037728e-01</div>
<div class="line"> </div>
<div class="line">cellParams:</div>
<div class="line">    0   1.62132469978e+01</div>
</div><!-- fragment --><p><br  />
 <a class="el" href="scft_command_page.html">Command Files</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="scft_page.html">Self-Consistent Field Theory</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="scft_unitcell_page.html">Crystal Unit Cells</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 28 2025 00:57:29 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
