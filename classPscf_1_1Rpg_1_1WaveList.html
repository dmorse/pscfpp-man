<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Pscf::Rpg::WaveList&lt; D &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacePscf.html">Pscf</a></li><li class="navelem"><a class="el" href="namespacePscf_1_1Rpg.html">Rpg</a></li><li class="navelem"><a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">WaveList</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classPscf_1_1Rpg_1_1WaveList-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Pscf::Rpg::WaveList&lt; D &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class to calculate and store properties of wavevectors.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="WaveList_8h_source.html">WaveList.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7addbb4f7476bdcedb5f0c22c1bf542b" id="r_a7addbb4f7476bdcedb5f0c22c1bf542b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7addbb4f7476bdcedb5f0c22c1bf542b">WaveList</a> ()</td></tr>
<tr class="memdesc:a7addbb4f7476bdcedb5f0c22c1bf542b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a7addbb4f7476bdcedb5f0c22c1bf542b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a428143ea231357f12ce620cc4f8222ba" id="r_a428143ea231357f12ce620cc4f8222ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a428143ea231357f12ce620cc4f8222ba">~WaveList</a> ()</td></tr>
<tr class="memdesc:a428143ea231357f12ce620cc4f8222ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:a428143ea231357f12ce620cc4f8222ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab285770a8210f4145e9847c0d5d83987" id="r_ab285770a8210f4145e9847c0d5d83987"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab285770a8210f4145e9847c0d5d83987">allocate</a> (<a class="el" href="classPscf_1_1Mesh.html">Mesh</a>&lt; D &gt; const &amp;m, <a class="el" href="classPscf_1_1Prdc_1_1UnitCell.html">UnitCell</a>&lt; D &gt; const &amp;c)</td></tr>
<tr class="memdesc:ab285770a8210f4145e9847c0d5d83987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory and set association with a <a class="el" href="classPscf_1_1Mesh.html" title="Description of a regular grid of points in a periodic domain.">Mesh</a> and UnitCell object.  <br /></td></tr>
<tr class="separator:ab285770a8210f4145e9847c0d5d83987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a29f9f9508d47d7af3be93ac7a27e4" id="r_aa3a29f9f9508d47d7af3be93ac7a27e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa3a29f9f9508d47d7af3be93ac7a27e4">clearUnitCellData</a> ()</td></tr>
<tr class="memdesc:aa3a29f9f9508d47d7af3be93ac7a27e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all internal data that depends on lattice parameters.  <br /></td></tr>
<tr class="separator:aa3a29f9f9508d47d7af3be93ac7a27e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853c8b93b4213f31ae4e8f30f839b9b9" id="r_a853c8b93b4213f31ae4e8f30f839b9b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a853c8b93b4213f31ae4e8f30f839b9b9">computeMinimumImages</a> ()</td></tr>
<tr class="memdesc:a853c8b93b4213f31ae4e8f30f839b9b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute minimum images of wavevectors.  <br /></td></tr>
<tr class="separator:a853c8b93b4213f31ae4e8f30f839b9b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae20352ec49ee5f07f78c5daed76ea678" id="r_ae20352ec49ee5f07f78c5daed76ea678"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae20352ec49ee5f07f78c5daed76ea678">computeKSq</a> ()</td></tr>
<tr class="memdesc:ae20352ec49ee5f07f78c5daed76ea678"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute sq.  <br /></td></tr>
<tr class="separator:ae20352ec49ee5f07f78c5daed76ea678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f3f77e30c5adaf78ea54ccd48590b5" id="r_a24f3f77e30c5adaf78ea54ccd48590b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a24f3f77e30c5adaf78ea54ccd48590b5">computedKSq</a> ()</td></tr>
<tr class="memdesc:a24f3f77e30c5adaf78ea54ccd48590b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute derivatives of |k|^2 w/ respect to unit cell parameters.  <br /></td></tr>
<tr class="separator:a24f3f77e30c5adaf78ea54ccd48590b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a775d3f0d6d1dde8246e9212fb528d6c0" id="r_a775d3f0d6d1dde8246e9212fb528d6c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; int &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a775d3f0d6d1dde8246e9212fb528d6c0">minImages</a> () const</td></tr>
<tr class="memdesc:a775d3f0d6d1dde8246e9212fb528d6c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the array of minimum images on the device by reference.  <br /></td></tr>
<tr class="separator:a775d3f0d6d1dde8246e9212fb528d6c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec0792c3e43412a982d595d1d51a65bd" id="r_aec0792c3e43412a982d595d1d51a65bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec0792c3e43412a982d595d1d51a65bd">kSq</a> () const</td></tr>
<tr class="memdesc:aec0792c3e43412a982d595d1d51a65bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the kSq array on the device by reference.  <br /></td></tr>
<tr class="separator:aec0792c3e43412a982d595d1d51a65bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff920c5d3f2637bdc78a860a321663f" id="r_a1ff920c5d3f2637bdc78a860a321663f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ff920c5d3f2637bdc78a860a321663f">dKSq</a> () const</td></tr>
<tr class="memdesc:a1ff920c5d3f2637bdc78a860a321663f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the full dKSq array on the device by reference.  <br /></td></tr>
<tr class="separator:a1ff920c5d3f2637bdc78a860a321663f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae80acd792b22b8408275ac4367074694" id="r_ae80acd792b22b8408275ac4367074694"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae80acd792b22b8408275ac4367074694">dKSq</a> (int i) const</td></tr>
<tr class="memdesc:ae80acd792b22b8408275ac4367074694"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the slice of the dKSq array for parameter i by reference.  <br /></td></tr>
<tr class="separator:ae80acd792b22b8408275ac4367074694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe0c1fe1fb78370f5fa85dcd43aa920a" id="r_abe0c1fe1fb78370f5fa85dcd43aa920a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; bool &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe0c1fe1fb78370f5fa85dcd43aa920a">implicitInverse</a> () const</td></tr>
<tr class="memdesc:abe0c1fe1fb78370f5fa85dcd43aa920a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the implicitInverse array by reference.  <br /></td></tr>
<tr class="separator:abe0c1fe1fb78370f5fa85dcd43aa920a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdee8b095017bb3b301368b719876994" id="r_afdee8b095017bb3b301368b719876994"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afdee8b095017bb3b301368b719876994">hasVariableAngle</a> () const</td></tr>
<tr class="memdesc:afdee8b095017bb3b301368b719876994"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does this unit cell have an angle that can change?  <br /></td></tr>
<tr class="separator:afdee8b095017bb3b301368b719876994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e26f27c073244e0e566d4f41d955de" id="r_a37e26f27c073244e0e566d4f41d955de"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37e26f27c073244e0e566d4f41d955de">isAllocated</a> () const</td></tr>
<tr class="memdesc:a37e26f27c073244e0e566d4f41d955de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has memory been allocated for arrays?  <br /></td></tr>
<tr class="separator:a37e26f27c073244e0e566d4f41d955de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d6748e2919f07c4b78a7ab5d4717c7" id="r_ae4d6748e2919f07c4b78a7ab5d4717c7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4d6748e2919f07c4b78a7ab5d4717c7">hasMinimumImages</a> () const</td></tr>
<tr class="memdesc:ae4d6748e2919f07c4b78a7ab5d4717c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Have minimum images been computed?  <br /></td></tr>
<tr class="separator:ae4d6748e2919f07c4b78a7ab5d4717c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d10f8bdc0d3f925869bbf9520900cbb" id="r_a3d10f8bdc0d3f925869bbf9520900cbb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d10f8bdc0d3f925869bbf9520900cbb">hasKSq</a> () const</td></tr>
<tr class="memdesc:a3d10f8bdc0d3f925869bbf9520900cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has the kSq array been computed?  <br /></td></tr>
<tr class="separator:a3d10f8bdc0d3f925869bbf9520900cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af61949b3d5d4d3e0c4e6fc1542e9b6" id="r_a0af61949b3d5d4d3e0c4e6fc1542e9b6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0af61949b3d5d4d3e0c4e6fc1542e9b6">hasdKSq</a> () const</td></tr>
<tr class="memdesc:a0af61949b3d5d4d3e0c4e6fc1542e9b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has the dKSq array been computed?  <br /></td></tr>
<tr class="separator:a0af61949b3d5d4d3e0c4e6fc1542e9b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;int D&gt;<br />
class Pscf::Rpg::WaveList&lt; D &gt;</div><p>Class to calculate and store properties of wavevectors. </p>
<p>In particular, minimum images, square norms of wavevectors (kSq), and derivatives of the square norms of wavevectors with respect to the lattice parameters (dKSq) are calculated and stored by this class. Any time the lattice parameters change the <a class="el" href="#aa3a29f9f9508d47d7af3be93ac7a27e4" title="Clear all internal data that depends on lattice parameters.">clearUnitCellData()</a> method should be called, which will effectively reset the <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html" title="Class to calculate and store properties of wavevectors.">WaveList</a> object so that the wavevector properties will need to be recalculated before being used. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00038">38</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7addbb4f7476bdcedb5f0c22c1bf542b" name="a7addbb4f7476bdcedb5f0c22c1bf542b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7addbb4f7476bdcedb5f0c22c1bf542b">&#9670;&#160;</a></span>WaveList()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::WaveList </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8tpp_source.html#l00410">410</a> of file <a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a>.</p>

</div>
</div>
<a id="a428143ea231357f12ce620cc4f8222ba" name="a428143ea231357f12ce620cc4f8222ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a428143ea231357f12ce620cc4f8222ba">&#9670;&#160;</a></span>~WaveList()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::~<a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">WaveList</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8tpp_source.html#l00421">421</a> of file <a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab285770a8210f4145e9847c0d5d83987" name="ab285770a8210f4145e9847c0d5d83987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab285770a8210f4145e9847c0d5d83987">&#9670;&#160;</a></span>allocate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::allocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPscf_1_1Mesh.html">Mesh</a>&lt; D &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPscf_1_1Prdc_1_1UnitCell.html">UnitCell</a>&lt; D &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>c</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory and set association with a <a class="el" href="classPscf_1_1Mesh.html" title="Description of a regular grid of points in a periodic domain.">Mesh</a> and UnitCell object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>spatial discretization mesh (input) </td></tr>
    <tr><td class="paramname">c</td><td>crystallographic unit cell (input) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WaveList_8tpp_source.html#l00425">425</a> of file <a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="MeshIterator_8h_source.html#l00141">Pscf::MeshIterator&lt; D &gt;::atEnd()</a>, <a class="el" href="MeshIterator_8tpp_source.html#l00061">Pscf::MeshIterator&lt; D &gt;::begin()</a>, <a class="el" href="UnitCellBase_8h_source.html#l00344">Pscf::Prdc::UnitCellBase&lt; D &gt;::nParameter()</a>, <a class="el" href="MeshIterator_8h_source.html#l00122">Pscf::MeshIterator&lt; D &gt;::position()</a>, <a class="el" href="MeshIterator_8h_source.html#l00136">Pscf::MeshIterator&lt; D &gt;::rank()</a>, <a class="el" href="Mesh_8h_source.html#l00229">Pscf::Mesh&lt; D &gt;::size()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="aa3a29f9f9508d47d7af3be93ac7a27e4" name="aa3a29f9f9508d47d7af3be93ac7a27e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3a29f9f9508d47d7af3be93ac7a27e4">&#9670;&#160;</a></span>clearUnitCellData()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::clearUnitCellData </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear all internal data that depends on lattice parameters. </p>
<p>Sets hasKSq_ and hasdKSq_ to false, and sets hasMinimumImages_ to false if hasVariableAngle == true. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8tpp_source.html#l00479">479</a> of file <a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a>.</p>

</div>
</div>
<a id="a853c8b93b4213f31ae4e8f30f839b9b9" name="a853c8b93b4213f31ae4e8f30f839b9b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853c8b93b4213f31ae4e8f30f839b9b9">&#9670;&#160;</a></span>computeMinimumImages()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::computeMinimumImages </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute minimum images of wavevectors. </p>
<p>(Also calculates kSq.)</p>
<p>The minimum images may change if a lattice angle in the unit cell is changed, so this method should be called whenever such changes occur. The method <a class="el" href="#afdee8b095017bb3b301368b719876994" title="Does this unit cell have an angle that can change?">hasVariableAngle()</a> identifies whether the minimum images may change under changes in the lattice parameters.</p>
<p>In the process of computing the minimum images, the square norm |k|^2 for all wavevectors is also calculated and stored, so it is not necessary to call computeKSq after calling this method. computeKSq is provided to allow calculation of kSq without recalculating minimum images. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8tpp_source.html#l00489">489</a> of file <a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="MeshIterator_8h_source.html#l00141">Pscf::MeshIterator&lt; D &gt;::atEnd()</a>, <a class="el" href="MeshIterator_8tpp_source.html#l00061">Pscf::MeshIterator&lt; D &gt;::begin()</a>, <a class="el" href="DeviceArray_8h_source.html#l00412">Pscf::DeviceArray&lt; Data &gt;::cArray()</a>, <a class="el" href="Log_8cpp_source.html#l00057">Util::Log::file()</a>, <a class="el" href="MeshIterator_8h_source.html#l00122">Pscf::MeshIterator&lt; D &gt;::position()</a>, <a class="el" href="MeshIterator_8h_source.html#l00136">Pscf::MeshIterator&lt; D &gt;::rank()</a>, <a class="el" href="ThreadArray_8cu_source.html#l00087">Pscf::ThreadArray::setThreadsLogical()</a>, <a class="el" href="ThreadArray_8cu_source.html#l00058">Pscf::ThreadArray::setThreadsPerBlock()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="ae20352ec49ee5f07f78c5daed76ea678" name="ae20352ec49ee5f07f78c5daed76ea678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae20352ec49ee5f07f78c5daed76ea678">&#9670;&#160;</a></span>computeKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::computeKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute sq. </p>
<p>norm |k|^2 for all wavevectors, using existing min images. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8tpp_source.html#l00561">561</a> of file <a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="DeviceArray_8h_source.html#l00412">Pscf::DeviceArray&lt; Data &gt;::cArray()</a>, <a class="el" href="ThreadArray_8cu_source.html#l00087">Pscf::ThreadArray::setThreadsLogical()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="a24f3f77e30c5adaf78ea54ccd48590b5" name="a24f3f77e30c5adaf78ea54ccd48590b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24f3f77e30c5adaf78ea54ccd48590b5">&#9670;&#160;</a></span>computedKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::computedKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute derivatives of |k|^2 w/ respect to unit cell parameters. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8tpp_source.html#l00602">602</a> of file <a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="DeviceArray_8h_source.html#l00460">Pscf::DeviceArray&lt; Data &gt;::capacity()</a>, <a class="el" href="DeviceArray_8h_source.html#l00412">Pscf::DeviceArray&lt; Data &gt;::cArray()</a>, <a class="el" href="ThreadArray_8cu_source.html#l00087">Pscf::ThreadArray::setThreadsLogical()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="a775d3f0d6d1dde8246e9212fb528d6c0" name="a775d3f0d6d1dde8246e9212fb528d6c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a775d3f0d6d1dde8246e9212fb528d6c0">&#9670;&#160;</a></span>minImages()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; int &gt; const  &amp; <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::minImages </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the array of minimum images on the device by reference. </p>
<p>The array has size kSize * D, where kSize is the number of grid points in reciprocal space. The array is unwrapped into a linear array in an index-by-index manner, in which the first kSize elements of the array contain the first index of each minimum image, and so on. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00230">230</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="aec0792c3e43412a982d595d1d51a65bd" name="aec0792c3e43412a982d595d1d51a65bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec0792c3e43412a982d595d1d51a65bd">&#9670;&#160;</a></span>kSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const  &amp; <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::kSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the kSq array on the device by reference. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00238">238</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="a1ff920c5d3f2637bdc78a860a321663f" name="a1ff920c5d3f2637bdc78a860a321663f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff920c5d3f2637bdc78a860a321663f">&#9670;&#160;</a></span>dKSq() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; cudaReal &gt; const  &amp; <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::dKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the full dKSq array on the device by reference. </p>
<p>The array has size kSize * nParams, where kSize is the number of grid points in reciprocal space and nParams is the number of lattice parameters. The array is unwrapped into a linear array in which the first kSize elements of the array contain dKSq for the first lattice parameter, and so on. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00246">246</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="ae80acd792b22b8408275ac4367074694" name="ae80acd792b22b8408275ac4367074694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae80acd792b22b8408275ac4367074694">&#9670;&#160;</a></span>dKSq() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const  &amp; <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::dKSq </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the slice of the dKSq array for parameter i by reference. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>index of lattice parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00254">254</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="abe0c1fe1fb78370f5fa85dcd43aa920a" name="abe0c1fe1fb78370f5fa85dcd43aa920a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe0c1fe1fb78370f5fa85dcd43aa920a">&#9670;&#160;</a></span>implicitInverse()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; bool &gt; const  &amp; <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::implicitInverse </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the implicitInverse array by reference. </p>
<p>This array is defined on a k-grid mesh, with a boolean value for each gridpoint. The boolean represents whether the inverse of the wave at the given gridpoint is an implicit wave. Implicit here is used to mean any wave that is outside the bounds of the k-grid. </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00262">262</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="afdee8b095017bb3b301368b719876994" name="afdee8b095017bb3b301368b719876994"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdee8b095017bb3b301368b719876994">&#9670;&#160;</a></span>hasVariableAngle()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::hasVariableAngle </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does this unit cell have an angle that can change? </p>
<p>The minimum images can only change if one of the lattice parameters is an angle that may vary. Therefore, this method checks the crystal system and returns true if there are any angles that may vary. </p>

</div>
</div>
<a id="a37e26f27c073244e0e566d4f41d955de" name="a37e26f27c073244e0e566d4f41d955de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e26f27c073244e0e566d4f41d955de">&#9670;&#160;</a></span>isAllocated()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::isAllocated </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Has memory been allocated for arrays? </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00149">149</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

</div>
</div>
<a id="ae4d6748e2919f07c4b78a7ab5d4717c7" name="ae4d6748e2919f07c4b78a7ab5d4717c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d6748e2919f07c4b78a7ab5d4717c7">&#9670;&#160;</a></span>hasMinimumImages()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::hasMinimumImages </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Have minimum images been computed? </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00155">155</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

</div>
</div>
<a id="a3d10f8bdc0d3f925869bbf9520900cbb" name="a3d10f8bdc0d3f925869bbf9520900cbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d10f8bdc0d3f925869bbf9520900cbb">&#9670;&#160;</a></span>hasKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::hasKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Has the kSq array been computed? </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00161">161</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

</div>
</div>
<a id="a0af61949b3d5d4d3e0c4e6fc1542e9b6" name="a0af61949b3d5d4d3e0c4e6fc1542e9b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af61949b3d5d4d3e0c4e6fc1542e9b6">&#9670;&#160;</a></span>hasdKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Rpg_1_1WaveList.html">Pscf::Rpg::WaveList</a>&lt; D &gt;::hasdKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Has the dKSq array been computed? </p>

<p class="definition">Definition at line <a class="el" href="WaveList_8h_source.html#l00167">167</a> of file <a class="el" href="WaveList_8h_source.html">WaveList.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="rpg_2solvers_2Block_8h_source.html">rpg/solvers/Block.h</a></li>
<li><a class="el" href="rpg_2solvers_2Mixture_8h_source.html">rpg/solvers/Mixture.h</a></li>
<li><a class="el" href="rpg_2solvers_2Polymer_8h_source.html">rpg/solvers/Polymer.h</a></li>
<li><a class="el" href="WaveList_8h_source.html">WaveList.h</a></li>
<li><a class="el" href="WaveList_8tpp_source.html">WaveList.tpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 14 2025 16:24:05 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
