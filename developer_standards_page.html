<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Coding Standards</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="developer_page.html">Developer Information</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Coding Standards </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="developer_build_page.html">Build System</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="developer_param_page.html">Parameter File I/O</a> (Next) <br  />
</p>
<p >This file documents programming and formatting conventions that should be used in the source code of PSCF:</p>
<h1><a class="anchor" id="file_section"></a>
File Names</h1>
<ul>
<li>Header files that may be included in other files use file extension *.h</li>
<li>Compilable C++ source files use extension *.cpp</li>
<li>Files that contain definitions of member functions for class templates are sometimes separated from the header file and given names that end in an extension *.tpp</li>
<li>One class per file: Avoid including definitions or definitions involving more than one public class in a single file.</li>
<li>Use the same base name for e header and implementation for the same class: The header and source files for a class named MyClass should be MyClass.h and MyClass.cpp. If MyClass is class template, some of the implementatiom may be defined in a file MyClass.tpp.</li>
<li>Place the header and implementation files for each class or class template in the same directory within the src/ directory tree.</li>
<li>Use header guards in all header files.</li>
</ul>
<h1><a class="anchor" id="name_section"></a>
Symbol Names</h1>
<ul>
<li>Names of functions and variables are lower case camel, as in "myVariable" or "myData".</li>
<li>Names of user-defined types (class, typedef, and enum) and namespaces are upper case camel, as in "MyClass" or "Util".</li>
<li>Names of private or protected class member variables must end with with a trailing underscore, like "data_" or "outputFile_".</li>
<li>Public static constant class member variable names are upper case camel, as in "MaxDimension".</li>
<li>Use plural nouns for names of arrays and other containers. A private array of Monomer objects might thus be named "monomers_".</li>
<li>Names of pointer variables end with a suffix Ptr. A local Thing* pointer variable within a function might thus be called "thingPtr". A Thing* pointer that is a private or protected class member variable might be called "thinkPtr_". Do not use this convention for pointers that point at C arrays (and avoid bare C-arrays): The suffix "Ptr" denotes a pointer that will point at a single object.</li>
<li>Names of preprocessor macros are upper case, with underscores between words.</li>
<li>Use the same parameter names in the declaration of a function and in the corresponding definition.</li>
<li>Names of functions that are not simple accessors (discussed below) should usually be verbs.</li>
<li>The name of a "setter" class member function that is passed a value for a non-public member variable should begin with the prefix "set". <br  />
 The name of the function parameter that holds the new value should be the same as the name of the non-public member variable, without any trailing underscore. The same convention is used whether the value is passed by value or by reference. For example: <div class="fragment"><div class="line"><span class="keywordtype">void</span> Thing::setData(<span class="keywordtype">int</span> data)</div>
<div class="line">{  data_ = data; }</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Thing::setPosition(<span class="keyword">const</span> Vector &amp;position)</div>
<div class="line">{  position_ = position; }</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Thing::setMolecule(Molecule &amp;molecule)</div>
<div class="line">{  moleculePtr_ = &amp;molecule; }</div>
</div><!-- fragment --></li>
<li>The name of a simple accessor ("getter") class member function that returns a non-public member variable by value or by reference should simply be the name of the member variable, without any trailing underscore. PSCF thus does NOT use the convention of appending a prefix "get" to the names of accessor functions. The same name convention is use for accessors that return by value, const reference, or non-const reference. Thus, for example: <div class="fragment"><div class="line"><span class="keywordtype">int</span> Thing::data()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{  <span class="keywordflow">return</span> data_; }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> Vector&amp; Thing::position()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{  <span class="keywordflow">return</span> position_; }</div>
<div class="line"> </div>
<div class="line">Vector&amp; Thing::position()</div>
<div class="line">{  <span class="keywordflow">return</span> position_; }</div>
<div class="line"> </div>
<div class="line">Molecule&amp; Thing::molecule()</div>
<div class="line">{  <span class="keywordflow">return</span> *moleculePtr_; }</div>
</div><!-- fragment --></li>
<li>The name of the preprocessor macro used in a header guard should be the name of the namespace followed by the file name, in upper case with underscores between words. A header file named "SillyClass.h" that contains a class Util::SillyClass in namespace <a class="el" href="namespaceUtil.html" title="Utility classes for scientific computation.">Util</a> should be enclosed with header guards like this: <pre class="fragment">#ifndef UTIL_SILLY_CLASS_H
#define UTIL_SILLY_CLASS_H

namespace Util
{

   class SillyClass : public Base
   {
      \\ ....
   }

}
#endif
</pre></li>
</ul>
<h1><a class="anchor" id="format_section"></a>
Code Formatting:</h1>
<ul>
<li>Indent exactly 3 spaces per level. Do NOT use any tabs (ever).</li>
<li>For control structures (if, for, while, etc.), place the opening brace at the end of a line, and the closing brace on a line by itself, aligned with the beginning of the opening line, like this: <div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; end; ++i) {</div>
<div class="line">   doSomething();</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>For functions with more than one line, put the opening brace on a separate line, and align opening and closing braces, like this: <div class="fragment"><div class="line"><span class="keywordtype">int</span> SillyClass::sillyMethod(<span class="keywordtype">int</span> param1, <span class="keywordtype">int</span> max)</div>
<div class="line">{</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; max; ++i) {</div>
<div class="line">      param1++;</div>
<div class="line">   }</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">if</span> (param1 &gt; 0) {</div>
<div class="line">      <span class="keywordflow">return</span> 0;</div>
<div class="line">   } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">   }</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>For one-line functions, the function definition may be given on a single line, like this: <div class="fragment"><div class="line"><span class="keyword">inline</span> <span class="keywordtype">int</span> SillyClass::data()</div>
<div class="line">{  <span class="keywordflow">return</span> data_; }</div>
</div><!-- fragment --></li>
<li>Set off the operators =, ==, &lt;, &gt;, +, and - by one space on either side, with occasional exceptions. Multipication (*) and division (/) operators may or may not be set off by white space. Make some exceptions to avoid line wraps.</li>
<li>Use one space to separate keywords, parentheseses, and opening braces in conditional statements. Use one space after each semi-colon in for-loop statements, and one space after each comma in function parameter lists.</li>
<li>Do not follow opening parentheses or precede closing parentheses by a space. Do not add whitespace space before commas or semicolons.</li>
<li>Consecutive function declarations or definitions within a file, along with associated documentation blocks, should be separated by a single blank line.</li>
<li>Break lines less than 80 characters per line whenever possible, to preserve readability in printouts and small laptop terminal screens.</li>
<li>Wrap every source file in the src/ directory in a namespace block. Start the namespace declaration in the first column.</li>
<li>In class definitions, align "public:", "protected:", and "private:" declarations with the beginning of the class definition statement, and with the closing brace. List public members first, then protected, then private. Within each block, list member variables first, then member functions</li>
<li>List any friend declarations at the end of a class definition in a "pseudo-block" that is preceded by a comment "//friends:" on a line by itself, after the private members. The "//friends:" comment should be aligned with "public:" and "private:" declarations.</li>
<li>Inline method definitions should usually be given outside the class definition, within the header file. The word "inline" should be added to this function definition, but not the function declaration.</li>
<li>Example (with doxygen documentation): <pre class="fragment">#ifndef UTIL_SILLY_CLASS_H
#define UTIL_SILLY_CLASS_H

namespace Util
{

   /**
   * A truly pointless class.
   */
   class SillyClass : public Base
   {

   public:

      /**
      * The first method.
      *
      * \param param1 a globble
      * \param param2 a gloob
      */
      int method1(int param1, double param2);

      /**
      * Get buddy (by reference)
      */
      const Buddy&amp; buddy() const;

   protected:

      /**
      * Get buddy  by non const reference)
      */
      Buddy&amp; buddy();

   private:

      int      data1_;
      Buddy* buddyPtr_;

   //friends:

      friend class Buddy;

   };

   // Inline methods

   inline const Buddy&amp; SillyClass::buddy() const
   {  return *buddyPtr_; }

   inline Buddy&amp; SillyClass::buddy()
   {  return *buddyPtr_; }

}
#endif
</pre></li>
</ul>
<h1><a class="anchor" id="Dox_section"></a>
Documentation (via doxygen):</h1>
<p >PSCF uses the doxygen (www.doxygen.org) utility to create html documentation from documentations blocks that are extracted from the source code. Doxygen will extracts any multi-line comment that begin with a slash and two asterisks ("/**"), or single line comments that begin with three slashes ("///"). See comments in the following example: </p><pre class="fragment">   /**
   * This comment will be extracted by doxygen (note the extra asterisk)
   */

   /// So is this one (note the extra slash)

   /*
   * This comment, however, will not be extracted by doxygen.
   */

   // Nor will this one.</pre><p> Comments within functions that you do not wish to be extracted by doxygen should use the usual form for C comments, using only a single asterisk for multi-line comments or only two slashes for for single line comments, as indicated in the above example.</p>
<ul>
<li>Create dOxygen documentation blocks for public and protected named quantities, i.e., all classes, public and protected member functions, protected member variables, namespaces, global functions, typedefs, enums, and constants.</li>
<li>The doxygen documentation block for a class should appear immediately above the first line of the class definition.</li>
<li>The doxygen documentation block for a class member function should be immediately above the function declaration, within the class definition, in the header file.</li>
<li>Prefer doxygen multiline comments for documentation of classes and class member functions.</li>
<li>Document all parameters of public and protected functions, using the dOxygen param keyword.</li>
<li>The documentation for every class and public or protected function should begin with a brief single-sentence description, which must end with a period and be followed by a blank line. The brief description should usually not extend beyond one line. This brief description is often sufficient. If needed, more detailed discussion may be given in one or more subsequent paragraphs, separated by blank lines.</li>
</ul>
<p >Example: </p><pre class="fragment">   /**
   * Align the universe.
   *
   * This is a longer discussion of what the method does, and of how and
   * why it does it. It may also contain a discussion of assumptions, and
   * of the algorithm.
   *
   * A longer discussion may contain two or more paragraphs, separated by
   * blank lines.
   *
   * \param thing1 value of some quantity
   * \param thing2 flag to determine what to do with thing1
   * \return shift in the position of the universe
   */
   double alignUniverse(double thing1, bool thing2);</pre><ul>
<li>Document private class member variables using either the multi-line or single line doxygen format. Documemtation of private members does not normally appear in the html documentation, but can be included if desired. Documentation of the meaning of member variables is important for developers who must read the implementation, though not strictly necessary for users.</li>
<li>Do not use doxygen-style comments for the function definitions that are given outside the class definition. Use a conventional C/C++ comment format (with one asterisk or two slashes) above each such function definition, like this: <pre class="fragment">   /*
   * Brief reminder of purpose. Possibly comments on implementation.
   */
   void MyClass:myFunction(int param)
   {
       // Do something here
   }</pre></li>
</ul>
<h1><a class="anchor" id="interface_section"></a>
Interface Design</h1>
<ul>
<li>Make all nonstatic class member variables private or (less frequently) protected.</li>
<li>Pass and return primitive C/C++ data types by value. Pass primitive data types to functions by non-const reference only when they must be modified within the function.</li>
<li>Pass objects (class instances) to functions by reference, not by value. Pass by const reference if the object is not modified.</li>
<li>Prefer references over pointers as function parameters. Pass pointers to functions only if: i) a null value for the pointer is a meaningful possibility, or ii) the pointer contains an address that must be re-assigned within the function.</li>
<li>Prefer references over pointers as function return values. Return a pointer only if a null pointer is a meaningful possibility.</li>
<li>Practice strict "const correctness". Mark function parameters and class member functions as const whenever possible.</li>
<li>Read-only access to a member variable of a primitive C/C++ type should be provided (when needed) by an accessor function that returns the member variable by value. Read-only access to an object (class instance) that is owned by a class may be provided by an accessor function that returns the object by const reference. Read-write access to an object may be provided by an accessor that returns the object by non-const reference. Simple accessors that return by value or const references should be declared as const functions. For example, if a class has an int member variable data_ and a member object_ that is an instance of class Object, you might consider providing any or (none) of the following methods: <div class="fragment"><div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> Thing::data()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{  <span class="keywordflow">return</span> data_; }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> Object&amp; Thing::object()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{  <span class="keywordflow">return</span> object_; }</div>
<div class="line"> </div>
<div class="line">Object&amp; Thing::&amp;object_()</div>
<div class="line">{  <span class="keywordflow">return</span> object_; }</div>
</div><!-- fragment --></li>
<li>Providing an accessor function that returns a non-const reference to a member object is equivalent to making the member public, and should be used when this is the desired behavior. Do not instead simply make the data member a public member.</li>
</ul>
<p >Accessors that return non-const references provide pseudo-public access to data members (i.e., variables or objects). The advantages of this scheme over simply making selected data members public are: </p><ul>
<li>
Uniform interface: All members must be accessed through accessors, so users need not remember which members are public and which are accessed through accessor functions.  </li>
<li>
Uniform name conventions: The name of the accessor that returns a member is always the name of the member variable, without amy underscore. This allows us to use an underscore to mark member variable names, without exposing underscored names outside the class implementation.  </li>
<li>
Uniform access: The same name convention is used for accessors that return by value, const reference, or reference, but the compiler can still enforce access control.  </li>
<li>
Implementation hiding: The same convention is for functions that access members of a class and those that access objects athrough a pointer. Use of accessor functions also makes it possible to add and remove sanity checks for debugging, such as checks that pointers are not null. </li>
</ul>
<ul>
<li>Write access to a class instance may sometimes instead be provided by an explicit "set" function. The use of a set function is preferable when one needs to check preconditions or carry out operations necessary to guarantee data validity.</li>
</ul>
<h1><a class="anchor" id="data_section"></a>
Data Structures</h1>
<ul>
<li>Use the C++ iostream classes for all file IO. For consistency, avoid the C fscan() and fprint() methods. Use the wrapper classes in the src/util/format directory to simplify coding of formatted output to ostreams.</li>
<li>Use std::string to represent character strings whenever possible.</li>
<li>Prefer the array container templates in src/util/containers over bare C arrays and STL containers. STL containers such as std::vector should be used when there is not an equivalent home-brewed container. Our preference for the home-brewed containers is based on the fact that: <ul>
<li>
Our home-brewed containers provide optional bounds checking, which is enabled only when NDEBUG is not defined.  </li>
<li>
Unlike std::vector, the most commonly used home-brewed array template DArray is not automatically resizable, and so will never be silently moved to a new location in memory. </li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="header_section"></a>
Header File Includes</h1>
<ul>
<li>In header files, prefer forward class declarations over inclusion of class headers when possible. Forward declarations are sufficient for classes or class templates that used in the header file only in function declarations (as parameter or return types) or in the declaration of types for pointer member variables. Header files inclusion is generally necessary for base classes, member objects, and classes that are used in the implementation of inline functions.</li>
<li>Header files that provide information required in another C++ file should normally be included explicitly, even if it is known that they would be indirectly included via another included header file. Reliance on indirect inclusion is fragile, and explicit inclusion helps document the dependency. Exceptions are: <ul>
<li>
A class implementation file MyClass.cpp may rely on indirect inclusion of header files that are included by the corresponding header file MyClass.h  </li>
<li>
A derived class may sometimes rely on indirect inclusion of header files that are included by a base class.  </li>
<li>
The <a class="el" href="Exception_8h_source.html">Exception.h</a> header is should always be included indirectly by inclusion of <a class="el" href="global_8h.html" title="File containing preprocessor macros for error handling.">src/util/global.h</a>.  </li>
</ul>
</li>
<li>Use explicitly qualified names for standard library symbols such as std::string in function parameter lists and return values. Use this convention both in function declarations and functions definitions.</li>
<li>Never use a "using std" statement to load the entire C++ standard library namespace into a header file.</li>
</ul>
<h1><a class="anchor" id="error_section"></a>
Error Handling</h1>
<ul>
<li>Include the file &lt;<a class="el" href="global_8h.html" title="File containing preprocessor macros for error handling.">util/global.h</a>&gt; in all files that use C assert() statements or that can throw exceptions. This automatically includes the "Exception.h" and "Log.h" header files, defines the UTIL_THROW(..) macro that is used to throw exceptions, and enables assert() statements if UTIL_DEBUG is defined,</li>
<li>For checks that are intended only for debugging, use C assert() statements or enclose the test in a ifndef UTIL_DEBUG .... endif conditional compilation block.</li>
<li>Use the UTIL_THROW macro defined in <a class="el" href="global_8h.html" title="File containing preprocessor macros for error handling.">src/util/global.h</a> to throw Exception objects for all errors, except those caught in debugging mode by C assert() statements. Like the standard assert() macro, this macro prints a message and showing the file and line number from which an Exception is thrown, as an aid to debugging.</li>
<li>Do not Exceptions for control flow. Exceptions should be used only for errors, and should normally cause the program to terminate.</li>
</ul>
<p ><br  />
 <a class="el" href="developer_build_page.html">Build System</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">Developer Information</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="developer_param_page.html">Parameter File I/O</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Mar 4 2023 20:01:03 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
