<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: EinsteinCrystalPerturbation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="index.html">PSCF - Polymer Self-Consistent Field</a></li><li class="navelem"><a href="psfts_page.html">Partial Saddle-Point Field Theoretic Simulation (PS-FTS)</a></li><li class="navelem"><a href="psfts_perturb_page.html">Perturbations</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">EinsteinCrystalPerturbation </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="classPscf_1_1Rpc_1_1EinsteinCrystalPerturbation.html" title="Perturbation for Einstein crystal thermodynamic integration method.">EinsteinCrystalPerturbation</a> class templates in namespaces <a class="el" href="namespacePscf_1_1Rpc.html" title="Real periodic fields, SCFT and PS-FTS (CPU).">Rpc</a> and <a class="el" href="namespacePscf_1_1Rpg.html" title="SCFT and PS-FTS with real periodic fields (GPU)">Rpg</a> are designed to enable use of Einstein crystal method of computing free energies by thermodynamic integration.</p>
<dl class="section see"><dt>See also</dt><dd><ul>
<li>
<a class="el" href="classPscf_1_1Rpc_1_1EinsteinCrystalPerturbation.html" title="Perturbation for Einstein crystal thermodynamic integration method.">Rpc::EinsteinCrystalPerturbation</a> (Class)  </li>
<li>
<a class="el" href="psfts_perturb_page.html">Manual Page</a>  </li>
</ul>
</dd></dl>
<h1 class="doxsection"><a class="anchor" id="rpc_EinsteinCrystalPerturbation_algorithm_sec"></a>
Theory</h1>
<p>The <a class="el" href="classPscf_1_1Rpc_1_1EinsteinCrystalPerturbation.html" title="Perturbation for Einstein crystal thermodynamic integration method.">EinsteinCrystalPerturbation</a> class defines a perturbation for a system with two types of monomer (nMonomer = 2) of the form   </p><p class="formulaDsp">
\[  H_{1} = (1-\lambda)[ H_{{\rm EC}} - H_{0} ]
\]
</p>
<p> in which \( \lambda \) is a parameter in the range \( \lambda \in [0, 1] \), \( H_{0} \) is the standard unperturbed Hamiltonian and \( H_{{\rm EC}} \) is the Einstein crystal Hamiltonian, described below. Adding this to the unperturbed Hamiltonian gives a total Hamiltonian   </p><p class="formulaDsp">
\[   H = \lambda H_{0} + (1-\lambda) H_{{\rm EC}}
\]
</p>
<p> that interpolates linearly between the Einstein crystal Hamiltonian and unperturbed Hamiltonians, giving the Einstein crystal in the limit \( \lambda = 0 \) and recovering the unperturbed standared model in the limit \( \lambda = 1 \).</p>
<p>The Einstein crystal Hamiltonian for a standard AB system with two monomer types and chi(0,0) = chi(1,1) = 0 is defined as an integral     </p><p class="formulaDsp">
\[  H_{{\rm EC}} =
  \int d{\bf r} \frac{1}{v \epsilon} 
  [ W_{-}({\bf r}) - W_{-}^{({\bf r})}({\bf r}) ]^2
\]
</p>
<p> in which \( W_{-}({\bf r}) = [w_{0}({\bf r}) - w_{1}({\bf r})]/2 \) is the exchange field, \( W_{-}^{({\bf r})}({\bf r}) \) is a "reference" exchange field configuration, and \( \epsilon \) is a user-supplied parameter that controls the strength of fluctuations about the reference field. By default, if the user does not supply a value for \( \epsilon \), it is set equal to \( \chi \).</p>
<p>The current version of the Einstein crystal method can also be applied to systems with more than two types of monomer if the projected chi matrix has no positive eigenvalues. In this more general situation, the Einstein crystal Hamiltonian is      </p><p class="formulaDsp">
\[  H_{{\rm EC}} = \sum_{i=0}^{M-2} 
  \int d{\bf r} 
   \frac{M}{2 v \epsilon_{i}} 
  [ W_{i}({\bf r}) - W_{i}^{({\bf r})}({\bf r}) ]^2
\]
</p>
<p> in which \( M \) is the number of monomer types (i.e., nMonomer), \( W_{i}({\bf r}) \) is the field component associated with eigenvector \( i \) of the projected \( \chi \) matrix, \( W_{i}^{({\bf r})}({\bf r}) \) is the corresponding component of the "reference" field configuration, and \( \epsilon_{0}, \ldots \epsilon_{M-2} \) are parameters that controls the strength of fluctuations about the reference field. <br  />
 By default, if the user does not provide values for the \( M - 1 \) required \( \epsilon \) parameters, then \( \epsilon_{i} = -\lambda_{i} \) for all \( i = 0, \ldots, M -2 \), where \( \lambda_{i} \) is eigenvalue \( i \) of the projected chi matrix. This generalized definition, and default values for parameters, includes the description of a standard AB system that is given above as a special case, with \( \epsilon = \epsilon_{0} \).</p>
<p>The reference field configuration must be read from a file during setup of a simulation, and so the name of that file must be provided as parameter in the parameter file.</p>
<h1 class="doxsection"><a class="anchor" id="rpc_EinsteinCrystalPerturbation_parameter_sec"></a>
Parameter File</h1>
<p>The parameter file format for this class is shown below: </p><div class="fragment"><div class="line">EinsteinCrystalPerturbation{</div>
<div class="line">  lambda               real</div>
<div class="line">  epsilon*             Array[ real ] </div>
<div class="line">  referenceFieldFile   <span class="keywordtype">string</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> Note that the epsilon parameter array is optional. If this array is absent, \( \epsilon_i = -\lambda_{i} \) by default, which reduces to a \( \epsilon_{0} = \chi \) for a standard AB system. Meanings of these parameters are described briefly below: </p><table class="doxtable">
<tr>
<td><b> <a class="el" href="classUtil_1_1Label.html" title="A label string in a file format.">Label</a> </b> </td><td><b> Description </b> </td></tr>
<tr>
<td>lambda </td><td>charging parameter in range 0 [Einstein Crystal] to 1 [unperturbed] </td></tr>
<tr>
<td>epsilon </td><td>array of values for coefficients used in harmonic penalty (optional) </td></tr>
<tr>
<td>referenceFieldName </td><td>name of file containing reference field configuration </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
