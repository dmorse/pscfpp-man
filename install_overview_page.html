<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Installation Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="install_page.html">Installation</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Installation Overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="install_source_page.html">Source Code</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="install_environment_page.html">Environment Variables</a> (Next) <br  />
</p>
<p >Below is a brief overview of instructions for compiling all of the PSCF programs using default settings. The directions given here and in subsequent pages assume that you have already cloned the pscfpp repository and installed all required dependencies. The descriptions assume that the root directory of the repository is named pscfpp/. You are free to rename the root directory before running or rerunning the setup script.</p>
<p >Below, have divided the instructions i a set of instructions for compiling and installing the programs that use only CPU hardware, and additional instructions for compiling programs that use an NVIDIA GPU.</p>
<h1><a class="anchor" id="install_overview_setup_sec"></a>
Preliminary Setup</h1>
<p >The following steps must be taken after installing required dependencies but before atttempting to compile any part of PSCF:</p>
<ul>
<li><b>Set environment variables:</b> Modify the users PATH and PYTHONPATH unix environment variables so as to include pscfpp/bin directory in the PATH (the unix shell command search path) and so as to include pscfpp/lib/python in the PYTHONPATH (the Python module search path). This is discussed in greater detail <a class="el" href="install_environment_page.html">here</a>.</li>
<li><b>Navigate to root directory:</b> Change directory (cd) to the pscfpp/ root directory.</li>
<li><p class="startli"><b>Setup:</b> Invoke the "setup" script from the pscfpp/ root directory. To setup the build system with default compiler options appropriate to most linux systems, enter the command </p><div class="fragment"><div class="line">./setup</div>
</div><!-- fragment --><p> from the root directory. Note the use of the prefix "./" before the name of the script, which indicates that the operating system should look for this script in the present working directory.</p>
<p class="startli">Alternatively, to customize compiler options, one may invoke the setup script with a filename argument that is the name of a compiler configuration file that contains non-default compiler options, as discussed <a class="el" href="install_setup_page.html">here</a>). An environment appropriate for compiling on a Mac OS X system with Apple silicon hardware (e.g., an M1 or M2 chip) in which the dependencies were installed using the homebrew package mamager can be created by entering </p><div class="fragment"><div class="line">./setup mac-si-homebrew</div>
</div><!-- fragment --><p> from the pscfpp/ directory.</p>
</li>
</ul>
<h1><a class="anchor" id="install_overview_CPU_sec"></a>
Compiling C++ Code (CPU Hardware)</h1>
<p >We recommend that users first compile only the programs in PSCF that use standard CPU hardware, leaving compilation GPU-enabled C++/CUDA programs as a separate step.</p>
<p >Compilation of GPU-enabled CUDA code is disabled by default after the setup operation described above. To compile only C++ CPU programs, but no GPU-enabled code, you may simply enter </p><div class="fragment"><div class="line">make all</div>
</div><!-- fragment --><p> from the pscfpp/ directory immediately after running the setup script. <br  />
 If successful, this will install executables named "pscf_fd", "pscf_pc1", "pscf_pc2" and "pscf_pc3" in the pscfpp/bin directory. <br  />
</p>
<p >Compiling all the PSCF C++ code using "make all" takes a little time (e.g., 2 to 3 minutes on a 2020 Mac air laptop with an M1 chip). This can be completed more quickly on a multi-core machine by using the -j option of the "make" command to use multiple CPU cores in parallel to compile different C++ files. The argument of the -j option is the number of cores that should be used, if available. For example, you could enter </p><div class="fragment"><div class="line">make -j8 all </div>
</div><!-- fragment --><p> to use all 8 CPU cores of an 8-core computer to compile PSCF.</p>
<p >Entering "make all" or "make -jn all" from the pscfpp/ root directory, as described above, will create a large number of intermediate object (*.o), dependency (*.d) and library (*.a) files in subdirectories of the pscfpp/bld directory, in addition to the executable files that are created in the pscfpp/bin directory.</p>
<h1><a class="anchor" id="install_overview_GPU_sec"></a>
Compiling C++/CUDA Code (GPU Hardware)</h1>
<p >The GPU-enabled C++/CUDA programs provided as part of PSCF can only be compiled on computers that have an NVIDIA development kit installed, and can only be run on machines that have an appropriate NVIDIA GPU and CUDA driver software. Before compiling this code, the user must enable compilation of CUDA code and set the appropriate target GPU architecture, as described below. The following instructions assume that you have already completed the setup steps described above.</p>
<ul>
<li><p class="startli"><b>Enable compilation of GPU-enabled programs:</b> To enable compilation of CUDA code for GPU-enabled programs on a machine that is set up to allow this, enter </p><div class="fragment"><div class="line">./configure -c1</div>
</div><!-- fragment --><p> from the pscfpp/ root directory. If you later want to disable compilation of CUDA code, instead enter </p><div class="fragment"><div class="line">./configure -c0</div>
</div><!-- fragment --><p> Commands issued by the configure script set variables that affect subsequent behavior of the build system and compiler. Usage of the configure script is discussed in more detail <a class="el" href="install_configure_page.html">here</a>.</p>
<p class="startli">To check if CUDA compilation is currently enabled, change directory to the pscfpp/bld directory, and enter </p><div class="fragment"><div class="line">.\configure -q</div>
</div><!-- fragment --><p> from that directory. This should yield a report indicating whether the "debugging" and "CUDA" options are currently set to be enabled (ON) or disabled (OFF) for code built in the bld/ directory (the default build directory).</p>
</li>
<li><b>Set the target GPU architecture:</b> CUDA must be compiled for a particular target GPU architecture. To set the target architecture to correspond to the GPU on your computer, you must change directory to pscfpp/ root directory and issue a command of the form <div class="fragment"><div class="line">.\configure -a [architecture id]  </div>
</div><!-- fragment --> where [architecture id] denotes a string that identifies the architecture of the GPU for which you are compiling. Valid values of this string have the form "sm_IJ", where IJ denotes a integer string that represents the NVIDIA "compute capability" for the target GPU. You can look up the compute capabability for the type of NVIDIA GPU installed on your computer by consulting the <a href="https://developer.nvidia.com/cuda-gpus">NVIDIA developer documentation</a>. The compute capability for an NVIDIA GPU is a number of the form I.J in which I is an integer major version number and J is a minor version number. The architecture id required as an argument of the -a option, however, uses a string of the form sm_IJ that drops the dot between the major and minor version. For example, an NVIDIA K40 GPU has a compute capability of 3.5. To set this as the target architecture, one would enter <div class="fragment"><div class="line">./configure -a sm_35</div>
</div><!-- fragment --> from the pscfpp/ directory, using "sm_35" as the architecture id.</li>
<li><b>Compile all programs (including GPU-enabled programs):</b> After enabling CUDA compilation and setting the appropriate architecture, you can compile all programs, inluding GPU enabled programs, by simply re-entering "make all" or <div class="fragment"><div class="line">make -jn all</div>
</div><!-- fragment --> from within the pscfpp/ root directory, where "n" is the number of CPU cores to be used during compilation.</li>
</ul>
<p >If successful, the "make all" command will install executables files named "pscf_pg1", "pscf_pg2" and "pscf_pg3" in the pscfpp/bin directory in addition to the files "pscf_fd", "pspc_pc1", "pscf_pc2" and "pscf_pc3" that are created by compiling only C++ code.</p>
<p >Several of the above steps is discussed in more detail in the following pages.</p>
<h1><a class="anchor" id="user_overview_inout_sec"></a>
Out-of-source vs. In-Source Compilation</h1>
<p >The above instructions explain how to perform an "out-of-source" build in which intermediate files created during compilation process are placed in the pscfpp/bld directory tree. It is also possible to perform an "in-source" build in which these files are instead placed in the pscfpp/src directory that also contains all C++ and CUDA source code files. The option of in-source compilation is discussed in more detail <a class="el" href="install_inout_page.html">here</a>. We recommend the use of out-of-source compilation for package users who are not actively working on development. Some developers may find in-source compilation more convenient during development.</p>
<p ><br  />
 <a class="el" href="install_source_page.html">Source Code</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="install_page.html">Installation</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="install_environment_page.html">Environment Variables</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 20 2023 00:52:46 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
