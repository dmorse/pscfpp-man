<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Appendix: Symmetry-Adapted Bases</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="user_page.html">User Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Appendix: Symmetry-Adapted Bases </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="user_symmetry_page.html">Appendix: Space Group Symmetry</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">Developer Information</a> (Next) <br  />
</p>
<p >PSCF allows users to input and output chemical potential and monomer concentration fields using an expansion in basis functions in which each basis function is an eigenfunction of the Laplacian that is invariant under all symmetry operations of a specified space group. We refer to the resulting basis as a symmetry-adapted Fourier basis, and the expansion as a symmetry-adapted Fourier series. This page discusses the mathematics underlying the construction of such a basis. The discussion of symmetry-adapted basis functions given here uses concepts and notation introduced in a separate appendix about <a class="el" href="user_symmetry_page.html">crystal symmetry</a>, which should be read before this page.</p>
<p >The discussion given here uses a notation appropriate to periodic fields that are continuous functions of position within a D-dimensional vector space. We discuss below how all of the main results can also be interpreted so as to apply to symmetry-adapted basis functions that are defined on the nodes of a regular mesh, subject to a few restrictions that we discuss.</p>
<h1><a class="anchor" id="user_basis_mesh_sec"></a>
Continuous vs. Discretized Functions</h1>
<p >Numerical computations in the PSCF programs for periodic systems are performed using periodic fields that are actually defined only at positions corresponding to the the nodes of a regular computational mesh. Fourier amplitudes for such discretized functions are defined by discrete Fourier transforms.</p>
<p >For simplicity, the discussion given here is presented using a notation that is appropriate to fields that are continuous functions of position in a D-dimensional space. All of the concepts, definitions and theorems presented here, however, can be shown to be equally applicable to functions that are defined only on the nodes of a regular mesh if the following assumptions and constraints are understood to apply:</p>
<ul>
<li>The mesh on which functions are defined must be invariant under all elements of the space group of interest, in the sense defined <a class="el" href="user_symmetry_page.html#user_symmetry_invariant_def">here</a>. This is necessary to allow us to unambigously define the effect of crystal symmetry operations upon a discretized function.</li>
<li>Values of functions of position must be understood to only be defined for positions that lie on nodes of the mesh. In this context, any statement that some condition is satisfied for all* values of a position \( {\bf r} \) must be understood to mean that it is satisfied for all nodes of the mesh. For example, we define a real field for this purpose to be a field that has real values at all nodes of the mesh.</li>
<li>Plane waves and Fourier amplitudes must be understood to be defined using discrete Fourier transforms.</li>
<li>Wavevectors that are aliases of one another must be understood to be equal, i.e., to be different ways of representing the same quantity, and to thus satisfy an equality in any equation. This is equivalent to saying that each integer component of a crystal wavevector in a reciprocal basis is defined only modulo the number of grid points along the associated direction. When the wavevectors are said to be "distinct" or "inequivalent", this must be understood to imply in this context that they are not aliases of one another.</li>
<li>The norm \( |{\bf G} |\) of a reciprocal lattice wavevector \( {\bf G} \), when needed, is defined to be the norm of a <a class="el" href="user_fourier_page.html#user_fourier_minindex_sub">minimal image</a> of \( {\bf G} \), i.e., the norm of an alias with integer components chosen so as to minimize the usual definition of the norm as \( |{\bf G}| = \sqrt{{\bf G}\cdot{\bf G}} \).</li>
<li>Some expressions that involve an integral over a unit cell of a crystal, e.g., to define orthogonality, must be replaced by analogous expressions that involve a sum over all nodes of of the mesh used to represent a single unit cell.</li>
</ul>
<p >If interpreted using these assumptions and constraints, all of the definitions and theorems presented in this appendix can be applied to periodic functions that are defined on the nodes of an appropriate mesh, as well as for continuous periodic functions.</p>
<p >The requirement that the computational mesh be invariant under all elements of the relevant space group imposes constraints on allowed choices for the dimensions of the mesh (i.e., the number of grid points along each direction) used to describe a structure with a known symmetry. As a simple example, this requirement implies that one must use equal numbers of grid points along the three orthogonal direction of a mesh used to simulate a cubic crystal. The existence of symmetry operations that involve translations by fractions of a unit cell imposes other constraints that can require the number of grid points along some directions to be multiples of some small integer. For example, a mesh for a BCC crystal must use equal even numbers of grid points in all directions in order to correctly represent operations that map the origin to the body-centered point. These constraints on mesh dimensions are discussed in somewhat more detail <a class="el" href="user_symmetry_page.html#user_symmetry_invariant_def">here</a>.</p>
<p >The algorithm that PSCF uses to construct symmetry-adapted basis functions will fail if the parameter file contains a list of mesh dimensions and a space group identifier that are incompatible, because the mesh would not be invariant under all operations of the chosen space group. If the mesh dimensions and space group are found to be incompatible, the pscf_pc and pscf_pg programs will write a message to the log file that explains the nature of the error, and then halt execution.</p>
<h1><a class="anchor" id="user_basis_star_sec"></a>
Wavevector Stars</h1>
<p >The first step in the algorithm used by PSCF to construct symmetry adapted basis functions is to partition the set of all distinct reciprocal lattice vectors used in the Fourier expansion of periodic functions into non-intersecting subsets of wavevectors that are related to one another by symmetry group operation. We refer to each each such set of symmetry-related wavevectors as a star.</p>
<p >Two simple examples may help illustrate the idea:</p>
<ul>
<li>In a 1D crystal with inversion symmetry (a centrosymmetric lamellar phase), any two nonzero, distinct wavevectors \( {\bf G} \) and \( -{\bf G} \) are related by inversion symmetry and thus form a star containing these two wavevectors.</li>
<li>In a 3D cubic crystal, all of the wavevectors with Miller indices that are related to a particular set of non-negative integers \( \{hkl\} \) by changes in sign of one or more indices and/or permutations are related by symmetry elements of a cubic crystal. The number of wavevectors in such a star is always equal to or less than 48 if the integers i, j, and k are all nonzero and unequal, and is less than 48 if any of the integers h, k, and l are equal to zero or if any pair of these integers are equal.</li>
</ul>
<p >Wavevectors in a star are always related by point group operations associated with elements of the space group. Because point group operations are always orthogonal transformations, wavevectors in the same star are always vectors of equal norm. When this statement is applied to wavevectors used to describe functions that are defined on a mesh, the norm must be understood to be the norm of a minimal image of each wavevector.</p>
<p ><a class="anchor" id="user_basis_star_defn"></a><b> Definition (Star) </b>: A <em>star</em> star \( T \) of a space group \( S \) is a set of distinct reciprocal lattice vectors with the following two properties:</p>
<ul>
<li>Closure under \( S \): For each wavevector \({\bf G} \in T\) and each symmetry operation \( A \in S\), \( {\bf G}A \in T \).</li>
<li>Connectivity: For each pair of wavevectors \( {\bf G} \) and \( {\bf G}&#39; \) in \( T \), there exists a symmetry operation \( A \in S \) such that \( {\bf G}&#39; = {\bf G} A \).</li>
</ul>
<p >Comment: If two wavevectors \( {\bf G} \) and \( {\bf G}&#39;\) are related by any sequence of symmetry operations in \( S \), then \( {\bf G} \) and \( {\bf G}&#39; \) are also related by a single symmetry operation in \( S \) that is given by the product of the operations in that sequence. The requirement that any two wavevectors in a star be related by a single symmetry operation is thus completely equivalent to a requirement that they be related by some sequence of symmetry operations.</p>
<p ><a class="anchor" id="user_basis_star_intersect_thrm"></a><b> Theorem D.1 (Intersecting Stars are Equal) </b>: If \( T \) and \( T&#39; \) are both star functions of a space group \( S \) with \( T \cap T&#39; \neq \emptyset \), then \( T = T&#39; \).</p>
<p ><em> Proof </em>: Suppose that \( T \cap T&#39; \neq 0 \). Suppose that \( {\bf G} \) and \( {\bf G}&#39;\) are wavevectors such that \( {\bf G} \in T \cap T&#39; \) and \( {\bf G}&#39; \in T&#39; \). Because both \( {\bf G} \) and \( {\bf G}&#39; \) are in \( T&#39; \), there must exist \( A \in S \) such that \( {\bf G}&#39; = {\bf G}A \). Because \( T \) is closed under multiplication by elements of \( S \), this implies that \( {\bf G}&#39; \in T \), or that every vector in \( T&#39; \) is also in \( T \), or \( T&#39; \subseteq T \). By reversing the roles of \( T \) and \( T&#39; \), by assuming that \( {\bf G} \in T \cap T&#39; \) and \( {\bf G}&#39; \in T \), we may also show by analogous arguments that \( T \subseteq T&#39; \), and thus that \( T = T&#39; \).</p>
<p ><a class="el" href="user_basis_page.html#user_basis_star_intersect_thrm">Theorem D.1</a> is logically equivalent to the statement that unequal stars must have an empty intersection. It also implies that a star cannot be proper subset of another star.</p>
<p ><a class="anchor" id="user_basis_star_generate_thrm"></a><b> Theorem D.2 (Generating a Star from a Wavevector) </b>: Suppose that \( {\bf G}_{0} \) is a reciprocal lattice wavevector, and \( S \) is a space group. Let \( Q \) be the set of all wavevectors such that for each \( {\bf G} \in Q \) there exists \( A \in S \) such that \( {\bf G} = {\bf G}_{0}A \). Set \( Q \) is a star of \( S \) that contains \( {\bf G}_{0} \).</p>
<p ><em> Proof </em>: Because \( S \) must contain the identity element \( E \), and \( {\bf G}_{0} = {\bf G}_{0}E \), \( Q \) must contain \( {\bf G}_{0} \). To prove that \( Q \) is a star, we must prove closure under \( S \) and connectivity, as defined in the above definition of a <a class="el" href="user_basis_page.html#user_basis_star_defn">star</a>.</p>
<p >Proving closure: Suppose \( {\bf G} \) is a wavector in \( Q \) and that \( A \) and \( B \) are elements of \( S \), such that \( {\bf G} = {\bf G}_{0} A \). Let \( {\bf G}&#39; = {\bf G}B  = {\bf G}_{0}(AB) \). Observe that \( AB \in S \), because \( S \) is closed under multiplication. This implies that \( {\bf G}B \in Q \) for any \( {\bf G} \in Q \) and \( B \in S \), proving that \( Q \) is closed under \( S \).</p>
<p >Proving connectivity: Consider \( {\bf G}, {\bf G} &#39;\in Q\), for which there exist \( A, B \in S \) such that \( {\bf G} = {\bf G}_{0}A \) and \( {\bf G}&#39; = {\bf G}_{0}B \). Observe that \( {\bf G}&#39; = {\bf G}C \) where \( C = A^{-1}B \), and that \( C \in S \).</p>
<p ><a class="anchor" id="user_basis_star_unique_thrm"></a><b> Theorem D.3 (Every Wavevector Belongs to a Unique Star) </b>: If \( {\bf G} \) is a reciprocal lattice wavevector and \( S \) is a space group, then \( {\bf G} \) belongs to exactly one star of \( S \).</p>
<p ><em> Proof </em>: Let \( T \) denote the set that is generated by applying all the elements of \( S \) to \( {\bf G} \). By <a class="el" href="user_basis_page.html#user_basis_star_generate_thrm">theorem D.2</a>, \( T \) is a star of \( S \) that contains \({\bf G} \). Suppose \( T&#39; \) is also a star of \( S \) such that \( {\bf G} \in T&#39; \). This implies \( T \cap T&#39; \neq \emptyset \) and thus, by <a class="el" href="user_basis_page.html#user_basis_star_intersect_thrm">theorem D.1</a> , that \( T = T&#39; \).</p>
<h1><a class="anchor" id="user_basis_star_functions_sec"></a>
Star Functions</h1>
<p >A star function is a linear superposition of waves with wavevectors in a star with coefficients chosen such that the superposition is symmetric under the space group.</p>
<p ><a class="anchor" id="user_basis_starfunc_def"></a><b> Definition (Star Function) </b>: Suppose \( T \) is a star of a space group \( S \) that contains \( M \) wavevectors, such that \( T = \{ {\bf G}_{0}, \ldots, {\bf G}_{M-1} \} \). A <em>star function</em> associated with \( T \) is defined to be a nonzero function \( \phi({\bf r}) \) that is symmetric under \( S \) and that is equal to a superposition <a class="anchor" id="user_basis_starfunc_eqn"></a> </p><p class="formulaDsp">
\[
   \phi(\textbf{r}) =
   \sum_{j=0}^{M-1} c_{j} e^{i\textbf{G}_{j} \cdot \textbf{r}}
\]
</p>
<p> of waves with wavevectors in \( T \), with complex coefficients \( c_{0}, \ldots, c_{M-1} \). The constant \( c_{j} \) in such a sum is referred to as the coefficient associated wtih wavevector \( {\bf G}_{j} \).</p>
<p >Some properties of star functions follow immediately from the their definitions as superpositions of waves with wavevectors that belong to a star.</p>
<p ><b> Theorem D.4 (Star Functions are Eigenfunctions of the Laplacian )</b>: Every star function \( \phi({\bf r}) \) associated with a star \( T \) of a space group \( S \) satisfies an eigenfunction equation  </p><p class="formulaDsp">
\[
   -\nabla^{2}\phi({\bf r}) = \lambda\phi({\bf r})
\]
</p>
<p> in which the eigenvalue \(\lambda\) is equal to the square magnitude of any of wavevectors in star \( T \).</p>
<p ><em> Proof: </em> Each star function is a superposition of waves with wavevectors that are related by unitary point group operations, and are thus wavevectors of equal magnitude. Because these waves are all thus eigenfunctions of the Laplacian with equal eigenvalues, any superposition of these waves is also an eigenfunction of the Laplacian with the same eigenvalue.</p>
<p ><b> Theorem D.5 (Star Functions of Different Stars are Orthogonal ) </b>: If \( f({\bf r}) \) and \( g({\bf r}) \) are star functions associated with different stars of the same space group, then they are orthogonal, in the sense that  </p><p class="formulaDsp">
\[
    \int d^{D}r \; f^{*}({\bf r}) g({\bf r}) = 0 \quad,
\]
</p>
<p> where the integral is taken over one unit cell of the lattice. An analogous statement holds for functions that are defined on the nodes of a regular mesh, with orthogonality defined by the vanishing of a sum over nodes of one unit cell of the mesh, rather than an integral.</p>
<p ><em> Proof </em>: Orthogonality of star functions follows from the fact that waves with different wavevectors are orthogonal in the same sense, and that the intersection of different stars is an empty set. Orthogonality is defined using an integral over one unit cell for periodic functions, as in the theorem statement, and using an analogous sum over nodes of the mesh for functions that are defined on a mesh.</p>
<p >The relationship among coefficients in this expansion of a star function may be determined by requiring that the function be symmetric under the specified space group.</p>
<p ><a class="anchor" id="user_basis_starfunc_phase_thrm"></a><b> Theorem D.6 (Relationships Among Coefficients in a Star Function) </b>: Suppose that \( \phi({\bf r}) \) is a star function associated with a star \( T = \{ {\bf G}_{0}, \ldots, {\bf G}_{M-1} \} \) of space group \( S \) that contains \( M \) wavevectors. Suppose \( {\bf G}_{j} \) and \( {\bf G}_{k} \) are wavevectors in \( T \) and that \( A = (R, {\bf t}) \) is a symmetry operation in \( S \), for which  </p><p class="formulaDsp">
\[
   {\bf G}_{k} = {\bf G}_{j}A \quad.
\]
</p>
<p> The coefficients for the waves associated with wavevectors \( {\bf G}_{j} \) and \( {\bf G}_{k} \) must satisfy <a class="anchor" id="user_basis_phase_eqn"></a> </p><p class="formulaDsp">
\[
   c_{k} = c_{j} e^{ i{\bf G}_{j}\cdot{\bf t} } \quad.
\]
</p>
<p> where \( c_{j} \) denotes the coefficient of the wave with wavevector \( {\bf G}_{j} \) in the superposition of the form given in the above <a class="el" href="user_basis_page.html#user_basis_starfunc_def">definition of a star function</a>.</p>
<p ><em>Proof</em>: Suppose that  </p><p class="formulaDsp">
\[
   \phi(\textbf{r}) =
   \sum_{j=1}^{M} c_{j} e^{i\textbf{G}_{j} \cdot \textbf{r}}
\]
</p>
<p> is a star function associated with star \( T \) of a space group that \( S \) that contains a symmetry element \( A = (R,{\bf t}) \). The transformed star function \( \phi A \) can be expressed as a superposition  </p><p class="formulaDsp">
\[
   \phi(A({\bf r})) =
   \phi( R{\bf r} + {\bf t} ) = \sum_{j=0}^{M-1} c_{j}
   e^{ i\textbf{G}_{j}R \cdot \textbf{r}}
   e^{i{\bf G}_{j} \cdot {\bf t}}
   \quad.
\]
</p>
<p> The equation relating \( c_{j} \) and \( c_{k} \) follows from the requirement that coefficients of corresponding waves be equal in the expansions of \( \phi \) and \( \phi A \).</p>
<p ><b> Corollary: </b> The relationships among coefficients obtained in <a class="el" href="user_basis_page.html#user_basis_starfunc_phase_thrm">Theorem D.6</a> imply that the coefficients associated with different waves in a star function must all have equal absolute magnitude,  </p><p class="formulaDsp">
\[
    |c_{1}| = |c_{2}| = \cdots |c_{M}| \quad.
\]
</p>
<p ><a class="anchor" id="user_basis_phaserel_def"></a><b> Definition (Phase Relationship) </b>: The equation relating the coefficients of two waves within a star given in <a class="el" href="user_basis_page.html#user_basis_starfunc_phase_thrm">Theorem D.6</a> is referred to here as a <em> phase relationship </em> between these waves, or between the associated wavevectors.</p>
<p ><a class="anchor" id="user_basis_phasefactor_def"></a><b> Definition (Phase Factor) </b>: The quantity  </p><p class="formulaDsp">
\[
    e^{i{\bf G}\cdot {\bf t}}
\]
</p>
<p> is referred to as the phase factor generated by applying a symmetry operator \( A = (R,{\bf t}) \) to wavevector \( {\bf G} \), while \( {\bf G}\cdot {\bf t} \) is the corresponding phase change.</p>
<p ><b> Theorem D.7 (Multiplication Rule for Phase Factors) </b>: Suppose \( {\bf G} \), \( {\bf G}&#39; \) and \( {\bf G}&#39;&#39;\) are wavevectors in the same star of a space group \( S \), and are related by symmetry operations \( A, B, C \in S\) such that \( C = AB \) and  </p><p class="formulaDsp">
\[
    {\bf G}&#39; = {\bf G}A  \quad, \quad
    {\bf G}&#39;&#39; = {\bf G}&#39;B = {\bf G}C
\]
</p>
<p> where \( A = (R_{A}, {\bf t}_{A}) \), \( B = (R_{B}, {\bf t}_{B}) \), and \( C = AB = (R_{C}, {\bf t}_{C}) \). The phase factor generated by applying \( C \) to \( {\bf G} \) is given by the product  </p><p class="formulaDsp">
\[
  e^{i{\bf G}\cdot {\bf t}_{C}}
  = e^{i{\bf G} \cdot {\bf t}_{A}}
    e^{i{\bf G}&#39;\cdot {\bf t}_{B}}
  \quad,
\]
</p>
<p> of the phase factor \(e^{i {\bf G}\cdot{\bf t}_{A}} \) generated by applying \( A \) to \( {\bf G} \) and the factor \( e^{i {\bf G}&#39;\cdot{\bf t}_{B}} \) generated by applying \( B \) to \( {\bf G}&#39; \).</p>
<p ><em>Proof</em>: Recall that, for \( C = AB \), \( R_{C} =  R_{A}R_{B} \) and \( {\bf t}_{C} = {\bf t}_{A} + R_{A}{\bf t}_{B} \). Using the fact that \( {\bf G}A = R_{A}^{\dagger}{\bf G} \), where \( R_{A}^{\dagger} \) is the <a class="el" href="user_symmetry_page.html#user_symmetry_adjoint_def_eqn">adjoint</a> of \( R_{A} \), observe that  </p><p class="formulaDsp">
\[
   {\bf G}&#39;\cdot {\bf t}_{B}
   = (R_{A}^{\dagger}{\bf G}) \cdot {\bf t}_{B}
   = {\bf G}\cdot R_{A} {\bf t}_{B} \quad.
\]
</p>
<p> Combining these relationships yields  </p><p class="formulaDsp">
\[
  {\bf G}\cdot {\bf t}_{C}
  = {\bf G} \cdot ( {\bf t}_{A} + R_{A} {\bf t}_{B} )
  = {\bf G} \cdot {\bf t}_{A} + {\bf G}&#39;\cdot {\bf t}_{B}
  \quad.
\]
</p>
<p> This additive relationship of phase changes yields a multiplicative relationship for phase factors.</p>
<h2><a class="anchor" id="user_basis_cancel_sub"></a>
Cancelled Stars</h2>
<p >The set of phase relationships among waves in a star of \( M \) wavevectors is a homogeneous system of linear equations for the coefficients \( c_{1}, \ldots, c_{M} \). This system of equations always has a trivial solution in which all of the coefficients are zero. For some stars of some space groups, this trivial solution is the only one.</p>
<p ><b> Definition (Cancelled Star) </b>: A star of a space group is said to be <em>cancelled</em> if the only solution to the relationships among the coefficients of waves in the star function is the trivial solution  </p><p class="formulaDsp">
\[
   c_{1} = c_{2} = \cdots = c_{M} = 0
   \quad,
\]
</p>
<p> for which the coefficients of all waves are zero.</p>
<p >The stars of a space group that are cancelled are the same as the ones for which systematic cancellations of scattering intensities are observed in scattering experiments. Nonzero star functions do not exist for cancelled stars. The Fourier series expansion of periodic functions with a specified space group symmetry in a basis of star functions thus uses only star functions that are associated with uncancelled stars (i.e., those that are not cancelled).</p>
<p ><em> Centered Lattices </em>: The simplest reason for cancellation of stars in PSCF occurs in the case of face- or body-centered lattices if one uses a conventional Bravais lattice with orthogonal Bravais basis vectors that yield a non-primitive conventional unit cell (e.g., simple cubic or tetragonal) that contains two or more primitive unit cells. In these cases, the associated space group must contain symmetry operations of the form \((I, {\bf t})\) that simply translate the structure by a fraction of a unit cell along each Bravais lattice direction. For example, a a body-centered-cubic lattice can be described by a simple cubic Bravais lattice and space group that includes a centering operation \((I, {\bf t})\) with \({\bf t} = (1/2, 1/2, 1/2)\). This sort of description, which is used by default by PSCF, leads to cancellation of stars of wavevectors that belong to the reciprocal lattice of the lattice with a non-primitive unit cell (e.g., simple cubic) but that actually do not belong to the reciprocal lattice of the centered lattice.</p>
<p ><b> Definition (Unary Contradiction) </b>: Suppose \( {\bf G} \) is a wavevector in a star of space group \( S \) and \( A = (R, {\bf t}) \) is a symmetry operation in \( S \) with \( {\bf t} \neq 0 \) that maps \( {\bf G} \) onto itself, such that \( {\bf G} = {\bf G}A \). The existence of such a symmetry leads to a phase relationship  </p><p class="formulaDsp">
\[
   c = e^{i{\bf G}\cdot {\bf t}} c \quad.
\]
</p>
<p> This is said to cause <em> unary contradiction </em> for wavevector \( {\bf G} \) if  </p><p class="formulaDsp">
\[
   e^{i{\bf G}\cdot{\bf t}} \neq 1  \quad,
\]
</p>
<p> since in this case, the only solution to this phase relationship is the trivial solution \( c = 0 \).</p>
<p ><b> Theorem D.8 (Unary Contradictions Infect Entire Stars) </b>: If \( T \) is a star of space group \( S \) and a unary contradiction exists for any wavevector in \( T \), then a unary contradiction exists for every wavevector in \( T \).</p>
<p ><em> Proof </em>: Suppose that \( {\bf G} \) is a wavevector in \( T \) for which there exists a symmetry operation \( A = (R_{A}, {\bf t}_{A}) \) such that \( {\bf G}={\bf G}A \) and \( \exp ( i {\bf G} \cdot {\bf t}_{A} ) \neq 1 \), giving a unary contradiction for \({\bf G}\). Suppose that \( {\bf G}&#39; \) is a different wavevector in \( T \), for which there must exist an operation \( B = ( R_{B}, {\bf t}_{B} ) \) in \( S \) such that \( {\bf G} = {\bf G}&#39;B^{-1} \). There thus exists a symmetry \( C = B^{-1}AB \) such that \({\bf G}&#39; = {\bf G}&#39; C \) that can be shown to lead to a phase relationship \( c&#39; = c&#39; e^{ i{\bf G}\cdot{\bf t}_{A} } \) for the coefficient \( c&#39; \) of the wave with wavevector \( {\bf G}&#39; \). This implies the existence of a unary contradiction for any wavevector \( {\bf G}&#39; \in T \).</p>
<p >Cancellation of a star will also occur if there exist any pair of wavevectors in the same star that are related by two symmetry operation that generate contradictory phase relationships between those wavevevectors. We refer to this as a binary contradiction.</p>
<p ><b> Definition (Binary Contradiction) </b>: Suppose \( {\bf G} \) and \( {\bf G}&#39; \) are two different wavevectors in a star of space group \( S \) that are related by two different symmetry operations \( A, B \in S \), such that  </p><p class="formulaDsp">
\[
   {\bf G}&#39; = {\bf G}A = {\bf G}B  \quad,
\]
</p>
<p> where \( A = (R_{A}, {\bf t}_{A}) \) and \( B = (R_{B}, {\bf t}_{B}) \). The phase relationships generated by applying these symmetry operations to a wave with wavevector \({\bf G}\) are said to yield a <em>binary contradiction</em> if application of \( A \) and \( B \) to \({\bf G}\) yield unequal phase factors  </p><p class="formulaDsp">
\[
   e^{i{\bf G}\cdot{\bf t}_{A}} \neq e^{i{\bf G}\cdot {\bf t}_{B}}
   \quad.
\]
</p>
<p> The existence of one or more such binary contradictions among the phase relationships associated with a star implies that the star is cancelled.</p>
<p ><b> Theorem D.9 (Binary Contradictions Imply Unary Contradictions) </b>: If the phase relationships among the wavevectors in a star contain one or more binary contradictions, then there also exists a unary contradiction for every wavevector in the star.</p>
<p ><em>Proof</em>: Suppose that a star \( T \) of space group \( S \) contains two distinct wavevectors \( {\bf G} \) and \( {\bf G}&#39; \) and that \( S \) contains two distinct operations \( A = (R_{A}, {\bf t}_{A}) \) and \( B = (R_{B}, {\bf t}_{B}) \) such that \( {\bf G}&#39; = {\bf G}A = {\bf G} B \), and such that \( e^{i{\bf G}\cdot{\bf t}_{A}} \neq e^{i{\bf G}\cdot {\bf t}_{B}} \), leading to a binary contradiction. Let \( C = AB^{-1} \) and observe that \( {\bf G} = C{\bf G} \). Applying \( C \) to a wave \( f({\bf r}) = c e^{i{\bf G}\cdot {\bf r}} \) generates a transformed wave  </p><p class="formulaDsp">
\[
   f(A(B^{-1}({\bf r})) =
   c e^{i{\bf G}\cdot ({\bf t}_{A} - {\bf t}_{B})}
   e^{i{\bf G}\cdot {\bf r}}
   \quad,
\]
</p>
<p> with the same wavevector. Requiring that \( f(A(B^{-1}({\bf r})) = f({\bf r}) \) have equal prefactors within the expansion of a star function generates an inconsistency if and only if  </p><p class="formulaDsp">
\[
  e^{i{\bf G} \cdot ({\bf t}_{A} - {\bf t}_{B})} \neq 1 \quad.
\]
</p>
<p> Observe that this is equivalent to the criterion for the existence of a pairwise contradiction involving wavevectors \( {\bf G} \) and \( {\bf G}&#39; \). Existence of a binary contradiction for \({\bf G} \) and \({\bf G}&#39;\) thus implies the existence of a unary contradiction for either \({\bf G}\) or \({\bf G}&#39;\). By theorem D.8, existence of a binary contradiction thus implies the existence of a unary contradiction for every wavevector in the star.</p>
<p >The algorithm used by PSCF to identify cancelled stars tests for the existence of unary contradictions for any wave in the star.</p>
<h2><a class="anchor" id="user_basis_noncancel_sub"></a>
Uncancelled Stars</h2>
<p ><a class="anchor" id="user_basis_starfunc_dimension_thrm"></a><b> Theorem D.10 (Dimension of the System of Phase Relationships) </b>: If \( T \) is a star of space group \( S \) that contains \( M \) wavevectors, and the phase relationships among wavevectors in \( T \) do not contain any unary contradictions, than the star is not cancelled, and phase relationships among wavevectors in \( T \) form a homogeneous system of \( M - 1 \) independent linear equations for the coefficients of waves in an associated star function. A full set of independent phase relationships is provided by the phase relationships between any one wavevector in \( T \) and the other \( M - 1 \) wavevectors in \( T \).</p>
<p ><em> Proof </em>: The assumption that there are no unary contradictions among the phase relationships between wavevectors in \( T \) implies that there are also no binary contradictions, by Theorem D.9. Let \( {\bf G}_{0}, {\bf G}_{1}, \ldots, {\bf G}_{M-1} \) denote the wavevectors in \( T \), listed in some arbitrarily chosen order. Let \( c_{i} \) denote the coefficient of the wave with wavevector \( {\bf G}_{i} \) in the definition of an associated star function. For each \( j = 1, \ldots, M-1 \), there must exist a symmetry operation \( A_{j} = (R_{j}, {\bf t}_{j}) \) such that  </p><p class="formulaDsp">
\[
   {\bf G}_{j} = {\bf G}_{0} A_{j}  \quad.
\]
</p>
<p> If the number of symmetry operations in \( S \) is greater than \( M \), then there may exist two or more symmetry operations that generate the same wavevector \( {\bf G}_{j} \) when applied to \( {\bf G}_{0} \). If so, we may define \( {\bf A}_{j} \) to be any one of these operations, and the assumption that there are no binary contradictions implies that different choices will lead to equivalent phase relationships. The phase relationships between \( {\bf G}_{0} \) and the other vectors in \( T \) gives a set of \( M - 1 \) independent linear homogeneous equations for the coefficients, each of which is an equation of the form  </p><p class="formulaDsp">
\[
   c_{j} = c_{0}e^{i{\bf G}_{0}\cdot{\bf t}_{j}}
\]
</p>
<p> for some \( i &gt; 0 \). Suppose that \( {\bf G}_{j} \) and \( {\bf G}_{k} \) are two wavevectors in \( T \), with \( j \neq 0 \) and \( k \neq 0 \). We may identify a symmetry relationship between these two vectors by noting that  </p><p class="formulaDsp">
\[
   {\bf G}_{k} = {\bf G}_{j} A^{-1}_{j}A_{k} \quad.
\]
</p>
<p> This symmetry relationship yields a corresponding phase relationship  </p><p class="formulaDsp">
\[
    c_{k} = c_{j} e^{-i{\bf G}_{0}\cdot {\bf t}_{j}}
                  e^{i{\bf G}_{0}\cdot {\bf t}_{k}}
          = c_{0} e^{i{\bf G}_{0}\cdot {\bf t}_{k}}
\]
</p>
<p> that is equivalent to a combination of the phase relationships between \({\bf G}_{0}\) and \({\bf G}_{j}\) and \({\bf G}_{k} \). Expanding the system of \(M-1\) binary phase relationships that involve the coefficient \( c_{0} \) by adding additional phase relationships that do not involve \( c_{0} \) is thus found to leave the dimension or rank of the system of equations unchanged. In a star with no unary or binary contradictions, the set of all phase relationships thus forms a system of exactly \( M - 1\) independent homogeneous linear equations for \( M \) coefficients. The resulting system of equations always has a non-empty set of nontrivial solutions, and is thus not cancelled.</p>
<p ><a class="anchor" id="user_basis_starfunc_uniqueness_thrm"></a><b> Theorem D.11 (Uniqueness of Star Functions to Within a Constant) </b>: If two functions \( f({\bf r}) \) and \( g({\bf r}) \) are both nonzero star functions associated with a single star \( T \) of a space group \( S \), then  </p><p class="formulaDsp">
\[
   g({\bf r}) = c f({\bf r})
\]
</p>
<p> for some nonzero complex constant \( c \).</p>
<p ><em> Proof </em>: Consider a star \( T \) with \( M \) distinct wavevectors \( {\bf G}_{1}, \ldots, {\bf G}_{M}  \). By theorem D.10, the phase relationships of an an uncancelled star form a system of \( M -1 \) homogeneous equations for \( M \) unknown coefficients. The set of solutions for the resulting set of equations is thus a vector space with dimension 1. This corresponds to a set of solutions that can all be expressed as \( c f({\bf r}) \), in which \( c \) is a complex constant and \( f({\bf r}) \) is any single nonzero solution.</p>
<h1><a class="anchor" id="user_basis_closed_sec"></a>
Closed Stars</h1>
<p ><b> Definition (Closed Stars) </b>: A set of wavevectors \( T \) is <em>closed</em> under inversion if, for every wavevector \( {\bf G} \in T \), \( -{\bf G} \in T\).</p>
<p >The following theorem simplifies the treatment of closed stars:</p>
<p ><a class="anchor" id="user_basis_closed_real_thrm"></a><b> Theorem D.12 (Closed Stars Yield Real Star Functions) </b>: If \( \phi({\bf r}) \) is a star function associated with a star that is closed under inversion, then there exists a complex constant \( c \) for which \( c \phi({\bf r}) \) is a real-valued function of position \( {\bf r} \).</p>
<p ><em> Proof </em>: Suppose that \( \phi({\bf r}) \) is a nonzero star function associated with a star \( T \), and is thus invariant under the space group \( S \) used to define the star. Let \( \phi({\bf r}) = u({\bf r}) + iv({\bf r}) \) where \( u \) and \( v \) are real functions that represent real and imaginary parts. Observe that \( u \) and \( v \) must also be invariant under \( S \). Consider the cases in which one or the other of these real functions is zero, or in which they are both nonzero. If \( u({\bf r}) \neq 0 \) and \( v({\bf r}) = 0 \), then \( \phi({\bf r}) \) is real, and \( c \) can be any real number. If \( u({\bf r}) = 0 \) and \( v({\bf r}) \neq 0 \), then \( -i\phi({\bf r}) \) is real, and \( c \) can be any pure imaginary number. If \( u({\bf r}) \neq 0 \) and \( v({\bf r}) \neq 0\), then \( u \) and \( v \) are two functions that are superpositions of waves in star \( T \) and symmetric under space group \( S \). Because the set of such functions is a vector space of dimension 1 (see <a class="el" href="user_basis_page.html#user_basis_starfunc_uniqueness_thrm">Theorem D.11</a> above), this implies that there exists a real constant \( d \) such that \( v({\bf r}) = d u({\bf r}) \) for all \( {\bf r} \), giving \( \phi({\bf r}) = (1+id)u({\bf r}) \). In this case \( \phi({\bf r})/(1+id) \) is real, giving \( c \propto 1/(1+id)\).</p>
<h1><a class="anchor" id="user_basis_open_sec"></a>
Open Stars</h1>
<p ><b> Definition (Open Sets of Wavevectors) </b>: A set of wavevectors \( T \) is <em>open</em> under inversion if, for every wavevector \( {\bf G} \in T\), \( -{\bf G} \notin T \).</p>
<p >Note that this definition does <em> not </em> define a set of wavevectors to be open under inversion if and only if it is not closed. The above definition is more restrictive: A set \( T \) is open only if, for <em> every </em> wavevector \( {\bf G} \in T\), \( -{\bf G} \notin T\). A set of wavevectors can thus be neither open nor closed if it contains a non-empty subset of wavevectors for which the inverse is also in the set, and another non-empty subset for which the inverse of each wavevector is not in the set. It turns out, however, that this hypothetical intermediate case cannot occur for a star of a space group.</p>
<p ><b> Theorem D.13 (Stars Are Either Open or Closed) </b>: Every star of a space group must be either open or closed.</p>
<p ><em> Proof </em>: First consider the special cases of stars with only one or two wavevectors. If a star \( T \) contains only one wavevector \( {\bf G} \), then \( T \) is closed under inversion if \( {\bf G} = 0 \) and open under inversion if \( {\bf G} \neq 0 \). If a star \( T \) contains exactly two wavevectors, \( T = \{ {\bf G}, {\bf G}&#39; \} \), then both wavevectors must be nonzero vectors of equal magnitude, and \( T \) is closed under inversion if \( {\bf G}&#39; = -{\bf G} \) and open otherwise. Now consider the case of a star that contains three or more nonzero wavevectors. Suppose that a star \( T \) of space group \( S \) contains three or more nonzero wavevectors, and that \( T \) is not open, so that there exists at least one wavevector \( {\bf G} \in T \) for which \( -{\bf G} \in T \). Let \( {\bf G}&#39; \) be any other wavevector in \( T \), for which \( {\bf G}&#39; \neq {\bf G} \) and \( {\bf G}&#39; \neq -{\bf G} \). There must exist a symmetry operation \( A = (R, {\bf t}) \) in \( S \) such that \( {\bf G}&#39; = R^{\dagger}{\bf G} \) (where \( R^{\dagger} \) is the <a class="el" href="user_symmetry_page.html#user_symmetry_adjoint_def_eqn">adjoint</a> of \( R \) and \( {\bf G}A = R^{\dagger}{\bf G} \)). Closure of the star under symmetry operations then implies that \( - {\bf G}&#39; \) is also in \( T \), because \( -{\bf G}&#39; = R^{\dagger}(-{\bf G}) \). This implies that a star that is not open must be closed, completing the proof.</p>
<p ><b> Definition (Inverse of a Set of Wavevectors) </b>: If \( T = \{ {\bf G}_{1}, \ldots , {\bf G}_{M} \} \) is a set of wavevectors, then \( \{ -{\bf G}_{1}, \ldots , - {\bf G}_{M} \} \) is known as the inverse of \( T \). If a star is open, then it has no intersection with its inverse. If a star is closed, it is equal to its own inverse.</p>
<p ><b> Theorem D.14 (The Inverse of an Open Star is Also a Star) </b>: If \( T \) is an open star of wavevectors for space group \( S \), then the inverse of \( T \) is also a star of \( S \).</p>
<p ><em> Proof </em>: We first prove closure of the inverse of \( T \) under \( S \): For each vector \( -{\bf G} \) in the inverse of \( T \) and each space group operation \( A = (R, {\bf t}) \) in \( S \), the vector \( (-{\bf G})A = -({\bf G}A) \) is also in the inverse of \( T \), proving closure.</p>
<p >We next prove connectivity: Suppose \( {\bf G} \) and \( {\bf G}&#39; \) are both nonzero wavevectors that belong an open star \( T \) of space group \( S \), for which there must exist a symmetry operation \( A = ( R, {\bf t}) \) in \( S \) such that \( {\bf G}&#39; = R^{\dagger}{\bf G} \). This also implies that \( -{\bf G}&#39; = -{\bf G}A \), thus implying that any two vectors \(-{\bf G}\) and \(-{\bf G}&#39;\) in the inverse of \( T \) are related by a space group symmetry.</p>
<p ><b> Theorem D.15 (Star Functions for Open Stars) </b>: If \( \phi({\bf r}) \) is a star function of space group \( S \) that is associated with an open star \( T \), then the complex conjugate \( \phi^{*}({\bf r}) \) is a star function associated with the inverse of \( T \).</p>
<p ><em> Proof </em>: Suppose that \( T = \{ {\bf G}_{0}, \ldots, {\bf G}_{M-1} \} \) is a non-cancelled open star of space group \( S \) that contains \( M \) wavevector. Suppose that \( \phi({\bf r}) \) is an associated star function, given by a superposition  </p><p class="formulaDsp">
\[
   \phi({\bf r}) = \sum_{j=0}^{M} c_{j} e^{i{\bf G}_{j}\cdot{\bf r}}
   \quad.
\]
</p>
<p> The complex conjugate \( \phi^{*}({\bf r}) \) is given by a sum  </p><p class="formulaDsp">
\[
   \phi^{*}({\bf r}) = \sum_{j=0}^{M} c_{j}^{*} e^{-i{\bf G}_{j}\cdot{\bf r}}
   \quad,
\]
</p>
<p> which is a superposition of waves with wavevectors that belong to a set \( T&#39; = \{ -{\bf G}_{0}, \ldots, -{\bf G}_{M-1} \} \) that is the inverse of \( T \). Because \( \phi({\bf r}) \) is invariant under group \( S \), so is \( \phi^{*}({\bf r}) \), by <a class="el" href="user_symmetry_page.html#user_symmetry_symmfunc_conj_thrm">Theorem C.5</a>. This implies that \( \phi^{*}({\bf r}) \) is a star function associated with \( T &#39;\), the inverse of star \( T \).</p>
<h1><a class="anchor" id="user_basis_centro_sec"></a>
Centrosymmetric Groups</h1>
<p ><a class="anchor" id="user_basis_centro_def"></a><b> Definition (Centrosymmetric Groups) </b>: A space group is centro-symmetric if it contains an operation that represents inversion through some inversion center. Inversion through an inversion center located at position \( {\bf c} \) is given explicitly by  </p><p class="formulaDsp">
\[
   i = (-I, 2 {\bf c})
\]
</p>
<p> for which  </p><p class="formulaDsp">
\[
   i({\bf r}) = -{\bf r} + 2{\bf c} \quad,
\]
</p>
<p> and for which \( i({\bf c}) = {\bf c} \).</p>
<p >The following theorem allows a particularly simple treatment of star functions of centro-symmetric groups:</p>
<p ><a class="anchor" id="user_basis_centro_closed_thrm"></a><b> Theorem D.16 (Stars of Centrosymmetric Groups) </b>: All stars of a centro-symmetric group are closed under inversion.</p>
<p ><em>Proof</em>: An inversion operation \( i = (-I, 2{\bf c}) \) with inversion center \( {\bf c} \) transforms every wavevector \( {\bf G} \) in a star into its inverse  </p><p class="formulaDsp">
\[
  {\bf G}i = -I{\bf G} = -{\bf G} \quad,
\]
</p>
<p> where we have used the fact that \( (-I)^{\dagger} = -I \). This implies that, for any centrosymmetric group, if a wavevector \( {\bf G} \) is in a star, then \( -{\bf G} \) is in the same star, and thus that every star must be closed under inversion. By <a class="el" href="user_basis_page.html#user_basis_closed_real_thrm">Theorem D.12</a>, this implies that a real star function can be defined for every star of any centro-symmetric group.</p>
<p ><a class="anchor" id="user_basis_centro_origin_thrm"></a><b> Theorem D.17 (Star Functions of Groups with with an Inversion Center at the Origin) </b>: If a group \( S \) has an inversion center at the origin of space, then it is possible to define a star function for every star of \( S \) in which the coefficients of all waves are real, and in which coefficients of waves with wavevectors \({\bf G}\) and \(-{\bf G}\) are equal.</p>
<p ><em>Proof</em>: If the group has an inversion center at the origin, it has a symmetry operation \( i = (-I,0) \) that relates an vector \({\bf G}\) to \(-{\bf G} = {\bf G}i\). The associated phase relationship requires that the coefficients of the two associated waves must be equal. By Theorem D.16, it is always possible to define a real star function associated with every star of such a group, in which coefficients of waves with wavevectors \({\bf G}\) and \(-{\bf G}\) must be complex conjugates. A pair of coefficients that are both equal and complex conjugates must both be real.</p>
<p >Comment: The conclusion that coefficients of all waves can be chosen to be real for star functions of groups that have an inversion center at the origin does not mean that the the coefficients of different waves within a star are necessarily all of the same sign, or that they can thus all be chosen to be equal positive numbers. In a group that has an inversion center at the origin but that also contains contain non-symmorphic glide plane or screw axis symmetries, it possible for phase relationships arising from these other symmetry operations to require coefficients of different waves within the same star to be of opposite sign. This occurs, for example, in star functions of the space group \( Ia\overline{3}d\) of the double gyroid phase.</p>
<p >Comment: The simplest case is that of a symmorphic group with an inversion center at the origin, such as the \( I m\overline{3}m \) space group of a BCC crystal. (Recall: The symmetry operations of a symmorphic group are all point group operations, without any nonzero translations). In this special case, all stars are closed, and coefficients of all waves in each star must all have equal values that can all be chosen to be positive by convention.</p>
<p ><br  />
 <a class="el" href="user_symmetry_page.html">Appendix: Space Group Symmetry</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_page.html">User Guide</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">Developer Information</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 20 2023 00:52:46 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
