<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Fully Fluctuating Field Theory - Incompressible Systems</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="psfts_page.html">Partial Saddle-Point Field Theoretic Simulation (PS-FTS)</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Fully Fluctuating Field Theory - Incompressible Systems</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="psfts_page.html">Partial Saddle-Point Field Theoretic Simulation (PS-FTS)</a> (Prev/Up) &#160; &#160; &#160; &#160; <a class="el" href="psfts_psa_page.html">Partial Saddle-Point Approximation</a> (Next) <br  />
</p>
<p>The PS-FTS simulation method used in PSCF is derived by applying a partial saddle-point approximation to an exact fully-fluctuating field theory formulation for an incompressible polymer fluid. The fully fluctuating field theory is discussed on this page, while the partial saddle-point approximation is considered on the next page. Throughout this discussion, as elsewhere, we use units for energy in which \( k_{B} T = 1 \).</p>
<h1><a class="anchor" id="psfts_theory_model_sec"></a>
Incompressible Particle-Based Model</h1>
<p>We consider a mixture of polymers and solvents constructed from \( M \) different types of monomer. The variable \( M \) used in this discussion is equivalent to the parameter nMonomer that appears in a PSCF parameter file. Let \( c_{i}({\bf r}) \) denote the concentration of monomers of type \( i \) at point \( {\bf r} \) within the mixture in a specific mechanical microstate of the underlying particle based model.</p>
<p>The implementation of PS-FTS in PSCF is designed for an incompressible model in which the monomer concentrations are assumed to always satisfy an incompressibility constraint,   </p><p class="formulaDsp">
\[
   \sum_{i=1}^{M} c_{i}({\bf r}) = c_{0} \quad,
\]
</p>
<p> for all \( {\bf r} \) , where \( c_{0} \) is the specified total mononer concentration. Let   </p><p class="formulaDsp">
\[
   v = 1/c_{0}
\]
</p>
<p> denote the corresponding monomer reference volume. A value for \( v \) is given in the PSCF parameter file by the parameter vMonomer.</p>
<p>The potential energy in any mechanical microstate that satisfies the incompressibility constraint is taken to be of the form    </p><p class="formulaDsp">
\[
   U = U_{\rm id} + U_{\rm int}
   \quad,
\]
</p>
<p> in which \( U_{\rm id} \) is the intramolecular potential energy of a gas of non-interacting molecules, while     </p><p class="formulaDsp">
\[
   U_{\rm int}
    =  \frac{v}{2}\sum_{i,j=1}^{M} 
   \int d{\bf r} \; \chi_{ij} c_{i}({\bf r}) c_{j}({\bf r})
\]
</p>
<p> is a non-bonded pair interaction energy with local interactions. Here, \( \chi_{ij} \) denotes an element of a symmetric \( M \times M \) matrix of dimensionless Flory-Huggins interaction parameters. <br  />
</p>
<p>The partition function \( Z \) for such an incompressible fluid can be expressed to within an irrelevant multiplicative constant as a configurational integral        </p><p class="formulaDsp">
\[
   Z =
       \int {\cal D}{\bf r} \;
        \exp \left ( -U_{\rm id} - U_{\rm int}  \right )
       \;
       \delta \left ( \sum_{i=1}^{M} c_{i}({\bf r}) - c_{0} \right )
   \quad,
\]
</p>
<p> in which \( \int {\cal D}{\bf r} \) denotes an integral over all monomer positions, and in which the \( \delta \)-functional imposes the incompressibility constraint.</p>
<h1><a class="anchor" id="psfts_theory_ideal_sec"></a>
Ideal-Gas Reference System</h1>
<p>All of the theoretical methods implemented in PSCF relate the free energy of an interacting polymer fluids to that of a hypothetical reference system of non-interacting molecules that are subjected to a set of external fields. In this ideal gas reference system, each monomer of type \( i \) is subjected to a potential field \( w_{i}({\bf r}) \), for each \( i = 1, \ldots, M \). The potential energy for this system is given by a sum   </p><p class="formulaDsp">
\[
    U = U_{\rm id} + U_{\rm c}
\]
</p>
<p> in which \( U_{\rm id} \) denotes the intramolecular potential energy of non-interacting chains, and \( U_{\rm c} \) is an energy arising from coupling to the external fields, of the form    </p><p class="formulaDsp">
\[
   U_{\rm c} = \sum_{i=1}^{M} \int \! d{\bf r} \;
   c_{i}({\bf r}) w_{i}({\bf r}) \quad.
\]
</p>
<p> Let \( Z_{\rm id}[w] \) denote the partition function for such a gas, expressed as a functional functional of the fields \( w_{1}, \ldots, w_{M} \). This is given by the configurational integral     </p><p class="formulaDsp">
\[
   Z_{\rm id}[w]
    = \int {\cal D}{\bf r} \; e^{-U_{\rm id} - U_{\rm c} }
   \quad,
\]
</p>
<p> in which \( {\cal D}{\bf r} \) denotes an integral over all monomer positions.</p>
<p>Let the notation \( \langle \cdots \rangle_{\rm id} \) denote an equilibrium ensemble average evaluated for this hypothetical ideal gas system. Because the properties of the ideal gas depend on the applied fields, the results of such an average is always a functional of the fields \( w_{1}, \ldots, w_{M} \). Let \( \phi_{i}({\bf r})\) for any \( i, \alpha = 1, \ldots, M \) denote a non-dimensionalized average concentration, or average volume fraction, given by    </p><p class="formulaDsp">
\[
    \phi_{i}({\bf r}) = v \langle c_{i}({\bf r}) \rangle_{\rm id}
    \quad,
\]
</p>
<p> where \( v \) is the monoer reference volume in the incompressible system of interest.</p>
<p>It is straightforward to show that the functional differentiation of the free energy \( -\ln Z_{\rm id}[w] \) with respect to a single field \( w_{i}({\bf r}) \) yields an average ideal-gas monomer concentration     </p><p class="formulaDsp">
\[
   -\frac{\delta \ln Z_{\rm id}[w]}{\delta w_{i}({\bf r})}
   = \langle c_{i}({\bf r}) \rangle_{\rm id}
   = \phi_{i}({\bf r})/v
\]
</p>
<p> for any \( i = 1, \ldots, M \).</p>
<h1><a class="anchor" id="psfts_theory_AB_sec"></a>
Field Theory: Standard AB Systems ( \( M=2 \))</h1>
<p>We focus first on the commonly studied case of systems with two monomer types, \( M = 2\). For simplicity, we consider a model in which the chi matrix has vanishing diagonal components, \( \chi_{11} = \chi_{22} = 0 \), and we use the symbol \( \chi \) to denote the value of either off-diagonal element,   </p><p class="formulaDsp">
\[
     \chi = \chi_{12} = \chi_{21} \quad.
\]
</p>
<p> We hereafter refer to such systems (with two monomer types and vanishing interaction matrix elements) as standard AB systems. The interaction potential energy of such a system is given by      </p><p class="formulaDsp">
\[
   U_{\rm int}
   =  v 
   \int d{\bf r} \; \chi c_{1}({\bf r}) c_{2}({\bf r})
   \quad.
\]
</p>
<p> At the time of writing of these notes (March 2024), all published PS-FTS calculations had simulated such a standard AB systems.</p>
<p>For such systems, it is convenient to define concentration components     </p><p class="formulaDsp">
\[
  C_{-}({\bf r}) = c_{1}({\bf r}) - c_{2}({\bf r})
  \quad\quad
  C_{+}({\bf r}) = c_{1}({\bf r}) + c_{2}({\bf r}) \quad.
\]
</p>
<p> Note that the incompressibility constraint requires that \( C_{+}({\bf r}) = c_{0} \) for all \( {\bf r} \), but allows \( C_{-}({\bf r}) \) to fluctuate. Rewriting \( U_{\rm int} \) in terms of these variables yields       </p><p class="formulaDsp">
\[
   U_{\rm int}
   =  \frac{v}{4}
   \int d{\bf r}  \; \chi
   [ \; c_{0}^{2} - C_{-}^{2}({\bf r}) \; ]
   \quad,
\]
</p>
<p> where we have set \( C_{+}({\bf r}) = c_{0} \) within the integrand for states that satisfy the incompressibility constraint.</p>
<p><b> Particle-Field Transformation: </b></p>
<p>We restrict our attention in the remainder of this section to standard AB systems with \( \chi &gt; 0 \). For such systems, a Hubbard-Stratonivich transformation may be used to rewrite the factor of \( \exp( -U_{\rm int} ) \) in the configurational integral that defines \( Z \) as a functional integral            </p><p class="formulaDsp">
\[
   e^{-U_{\rm int} }
   =  \frac{1}{N}
   \int {\cal D} W_{-}
   \exp \left \{ -
   \int \! d{\bf r} \; \left [  \;
    \frac{ W_{-}^{2}}{ v \chi}
          + W_{-} C_{-}
          + \frac{\chi}{4 v} \;
   \right ] \right \}
   \; ,
\]
</p>
<p> in which \( \int {\cal D} W_{-} \) denotes a functional integral over a real-valued auxiliary field \( W_{-}({\bf r}) \), and where        </p><p class="formulaDsp">
\[
   N \equiv
   \int {\cal D} W_{-}
   \exp \left \{
   - \int \! d{\bf r} \;
   \frac{ W_{-}^{2}({\bf r}) }{v \chi }
   \right \}
\]
</p>
<p> is a constant.</p>
<p>The \( \delta \)-functional that constrains the total monomer concentration in our expression for \( Z \) may also be expressed as a functional integral      </p><p class="formulaDsp">
\[
   \delta(C_{+}({\bf r}) - c_{0}) =
   \int {\cal D}\omega_{+} \exp \left \{
   - i \int d{\bf r} \; \omega_{+} [ \; C_{+} - c_{0} \; ]
   \right \}
\]
</p>
<p> in which \( \omega_{+}({\bf r}) \) is a fluctuating real-valued Lagrange multplier field that imposes the constraint, and \( \int {\cal D}\omega_{+} \) denotes a functional integral over this field.</p>
<p>By substituting the above functional integral expressions for the \( e^{-U_{\rm int}} \) and the \( \delta \)-function into the definition of the \( Z \), we obtain a functional integral over both \( W_{-} \) and \( \omega_{+} \), giving      </p><p class="formulaDsp">
\[
   Z = N^{-1}
   \int {\cal D}W_{-} \int {\cal D}\omega_{+}  \; e^{ -H_{\rm f} }
   \int \! {\cal D}{\bf r} \; e^{-U_{\rm id} - H_{\rm c}}
   \quad,
\]
</p>
<p> in which       </p><p class="formulaDsp">
\[
   H_{\rm f}  =
   \int \! d{\bf r} \; \left \{
   \frac{W_{-}^{2}({\bf r}) }{v \chi}
   - i \omega_{+}({\bf r}) c_{0}
   + \frac{\chi}{4v} \right \}
\]
</p>
      <p class="formulaDsp">
\[
   H_{\rm c}  = \int \! d{\bf r} \;
   \left [ W_{-}({\bf r}) C_{-}({\bf r})
     + i \omega_{+}({\bf r}) C_{+}({\bf r}) \right ]
   \quad.
\]
</p>
<p> Note that \( H_{\rm f} \) is an explicit harmonic functional of auxiliary fields (so that the subscript f denotes "field"), while \( H_{\rm c} \) introduces a coupling between auxiliary fields and the monomer concentrations (so that the subscript c denotes "concentration" or "coupling").</p>
<p>It is convenient for some purposes to defined a "Wick rotated" pressure-like field   </p><p class="formulaDsp">
\[
   W_{+}({\bf r}) \equiv i \omega_{+}({\bf r})
\]
</p>
<p> defined such that       </p><p class="formulaDsp">
\[
   H_{\rm f}  =
   \int \! d{\bf r} \; \left \{
   \frac{W_{-}^{2}({\bf r}) }{v \chi}
   - W_{+}({\bf r}) c_{0}
   + \frac{\chi}{4v} \right \}
\]
</p>
      <p class="formulaDsp">
\[
   H_{\rm c}  = \int \! d{\bf r} \;
   \left [ W_{-}({\bf r}) C_{-}({\bf r})
     +  W_{+}({\bf r}) C_{+}({\bf r}) \right ]
   \quad.
\]
</p>
<p> Hamiltonian component \( H_{\rm c} \) can also be expressed in terms of the original monomer concentrations \( c_{1} \) and \( c_{2} \) as a sum      </p><p class="formulaDsp">
\[
   H_{\rm c}  =
   \int \! d{\bf r} \;
   \left [ w_{1}({\bf r}) c_{1}({\bf r})
     + w_{2}({\bf r}) c_{2}({\bf r}) \right ]
\]
</p>
<p> in which   </p><p class="formulaDsp">
\[
   w_{1}({\bf r}) =  W_{+}({\bf r}) + W_{-}({\bf r}) \;
\]
</p>
   <p class="formulaDsp">
\[
   w_{2}({\bf r}) =  W_{+}({\bf r}) - W_{-}({\bf r}) .
\]
</p>
<p> are complex fields that act on monomers of types \( 1 \) and \( 2 \), respectively.</p>
<p><b> Field-Theoretic Hamiltonian: </b></p>
<p>Integrating over particle positions in the above expression for \( Z \) yields a factor of \( Z_{\rm id}[w] \) within the remaining functional integral over the fields. The resulting expression for \( Z \) obtained above can be summarized as a functional integral of the form      </p><p class="formulaDsp">
\[
   Z = N^{-1}
   \int {\cal D}W_{-}
   \int {\cal D}\omega_{+} \; e^{-H}
   \quad,
\]
</p>
<p> in which   </p><p class="formulaDsp">
\[
   H  = -\ln Z_{\rm id}[w] + H_{\rm f} \quad.
\]
</p>
<p> is a field theoretic Hamiltonian that is a functional of the fields \( W_{-} \) and \( \omega_{+} \), and in which    </p><p class="formulaDsp">
\[
   Z_{\rm id}[w]
   = \int \! {\cal D}{\bf r} \; e^{-U_{\rm id} - H_{\rm c}}
\]
</p>
<p> is the partition function for a hypothetical gas of non-interacting molecules subjected to fluctuating external fields, in which monomers of type \( i \) are subjected to a field \( w_{i}({\bf r}) \), with \( w_1 = i\omega_{+} + W_{-} \) and \( w_2 = i\omega_{+} - W_{-} \).</p>
<p>The field theoretic Hamiltonian \( H \) defined above can be expressed as an analytic functional of the fields \( W_{-}({\bf r}) \) and \( W_{+}({\bf r}) \). It is straightforward to show that the functional derivatives of \( H[ W_{-}, W_{+}] \) with respect to these fields are given by        </p><p class="formulaDsp">
\[
    \quad \left . \frac{\delta H}{\delta W_{-}({\bf r})}
    \right |_{W_{+}} = \frac{1}{v}
    \left [\,
    \phi_{1}({\bf r}) - \phi_{2}({\bf r}) - \frac{2 W_{-}({\bf r})}{\chi}
     \, \right ]
    \quad
\]
</p>
       <p class="formulaDsp">
\[
   \left .  \frac{\delta H}{\delta W_{+}({\bf r}) }
   \right |_{W_{-}}
    = \frac{1}{v}
   \left [ \, \phi_{1}({\bf r}) + \phi_{2}({\bf r}) - 1 \, \right ]
   \quad.
\]
</p>
<p> A saddle-point of the Hamiltonian is defined to be a field configuration in which functional derivatives with respect to both fields vanish for all \( {\bf r} \). It is straightforward to show that the resulting saddle point equations are equivalent to the self-consistent field equations used in SCFT for such an AB system, and that the value of the Hamiltonian at such a saddle point is equal to the SCFT free energy. Saddle-point field configurations thus correspond to SCFT solutions.</p>
<h1><a class="anchor" id="psfts_theory_general_sec"></a>
Field Theory: General Case ( \( M \geq 2 \))</h1>
<p>The software implementation of PS-FTS in PSCF is based on a "symmetric" formulation of the field theory for incompressible models that is designed to allow generalization to systems with \( M &gt; 2 \). This formulation is presented in the following reference:</p>
<p><a class="anchor" id="psfts_theory_MYC_article"></a>"Polymer Field Theory for Multimonomer Incompressible Systems:
Symmetric Formation and ABC Systems", D. Morse, D. Yong, K. Chen, <em>Macromolecules</em> <b>58</b>, 816-825 (2025). <a href="https://pubs.acs.org/doi/10.1021/acs.macromol.4c02636">https://pubs.acs.org/doi/10.1021/acs.macromol.4c02636</a></p>
<p>When this general formulation is applied to a standard AB system, it <a class="el" href="#psfts_theory_general_AB_sub">can be shown</a> to reduce to the formulation for AB systems that is described above. The use of the more general symmetric formulation of field theory within the implementation of PSCF is intended to facilitate later development of PS-FTS methods for some systems with \( M &gt; 2 \). The current version of PSCF has, however, thus been used and tested primarily with standard AB systems, and some algorithms for \( M &gt; 2 \) remain incomplete. The current status of PS-FTS algorithms for systems with \( M &gt; 2 \) is discussed on the <a class="el" href="psfts_psa_page.html#psfts_psa_status">following page</a>.</p>
<p>The basic working equations of this symmetric formulation are summarized below. This summary is provided primarily as a theory reference for users who examine the source code. Further details, including analyses of the special cases of AB and ABC systems, are given in the article cited above.</p>
<p><b> Matrix Notation: </b></p>
<p>Throughout the following discussion, we use bold-faced symbols to denote column vectors and matrices in which column and row indices are associated with monomer types. Specifically, let \( {\bf c}({\bf r}) \) denote the \( M \times 1 \) column vector with elements given by the monomer concentrations \( c_{1}({\bf r}), \ldots, c_{M}({\bf r}) \) at position \( {\bf r} \), and let \( {\boldsymbol \chi} \) denote the symmetric \( M \times M \) matrix of Flory-Huggins interaction parameters.</p>
<p>The incompressibility constraint can be expressed in matrix notation as a requirement that   </p><p class="formulaDsp">
\[
   {\bf e}^{T} {\bf c}({\bf r}) = c_{0} \quad,
\]
</p>
<p> in which     </p><p class="formulaDsp">
\[
  {\bf e} \equiv \left [ \begin{array}{c}
            1 \\ 1 \\ \vdots \\ 1
            \end{array} \right ]
\]
</p>
<p> is an \( M \)-component column vector with equal element values \( e_{i}=1 \) for all \( i = 1, \cdots, M \). Here \({\bf e}^{T} \) is the corresponding row vector \( {\bf e}^{T} = [1 \ldots 1] \), where a superscript \( T \) is used to denote a matrix transpose. Fluctuations of \( {\bf c}({\bf r})\) within the subspace orthogonal to \( {\bf e} \) thus preserve the incompressibility constraint.</p>
<p>The formulation of field theory for incompressible systems used in PSCF is based on a a decomposition of \( {\bf c}({\bf r}) \) into components parallel and orthogonal to \( {\bf e} \). Let \( {\bf Q} \) and \( {\bf P} \) denote the \( M \times M \) orthogonal projection matrices      </p><p class="formulaDsp">
\[
   {\bf Q} \equiv \frac{1}{M}{\bf e}{\bf e}^{T}
   \quad\quad, \quad\quad
   {\bf P} \equiv {\bf I} - {\bf Q}
   \quad,
\]
</p>
<p> where \( {\bf I} \) is the \( M \times M \) identity matrix. Note that \( {\bf Q}{\bf e} = {\bf e} \), \( {\bf P}{\bf e} = 0 \). Also note that \( {\bf Q} \) and \( {\bf P} \) are both idempotent (i.e., that \( {\bf Q}{\bf Q} = {\bf Q} \), \( {\bf P}{\bf P} = {\bf P} \)), and that \( {\bf Q}{\bf P} = {\bf P}{\bf Q} = 0 \). Multiplying any M-component column vector by \( {\bf Q} \) yields the orthogonal projection of the original vector onto \( {\bf e} \). Multiplying such a vector by \( {\bf P} \) instead yields the projection of the vector into the \( M-1 \) dimensional subspace orthogonal to \( {\bf e} \) .</p>
<p><b> Projected \( \chi \) Matrix: </b></p>
<p>Let \( \tilde{\boldsymbol\chi} \) denote a symmetric \( M \times M \) matrix defined by the matrix product     </p><p class="formulaDsp">
\[
   \tilde{\boldsymbol \chi}
   \equiv {\bf P}{\boldsymbol \chi}{\bf P} \quad,
   \quad.
\]
</p>
<p> We refer to this as the projected \( \chi \) matrix. Let \( \tilde{\chi}_{ij} \) denote the element in row i and column j of the matrix \( \tilde{\boldsymbol \chi} \) . Note that \( \tilde{\boldsymbol{\chi}} {\bf e} = 0\), implying that \( \tilde{\boldsymbol{\chi}} \) is a singular matrix for which \( {\bf e} \) is an eigenvector with a zero eigenvalue.</p>
<p>Let \( {\bf v}_{1}, \ldots, {\bf v}_{M} \) denote \( M \) orthogonal eigenvectors of the symmetric matrix \( \tilde{\boldsymbol \chi} \), and let \( \lambda_{1}, \ldots, \lambda_{M} \) be the corresponding real eigenvalues, defined such that    </p><p class="formulaDsp">
\[
   \tilde{\boldsymbol\chi} {\bf v}_{\alpha} =
   \lambda_{\alpha} {\bf v}_{\alpha}
\]
</p>
<p> for all \( \alpha = 1, \ldots, M \) . As already noted, \( {\bf e} \) is always an eigenvector with a zero eigenvalue. By convention, we take this to be the last eigenvector in the list, so that   </p><p class="formulaDsp">
\[
   {\bf v}_{M} = {\bf e}
\]
</p>
<p> and \( \lambda_{M}=0 \). We choose a normalization convention for which    </p><p class="formulaDsp">
\[
   {\bf v}_{\alpha}^{T} {\bf v}_{\beta}
   = \delta_{\alpha\beta}M
\]
</p>
<p> for all \( \alpha, \beta = 1,\ldots, M \) . This convention is chosen to be compatible with the norm of \( {\bf e} = {\bf v}_{M} \), for which \( {\bf e}^{T}{\bf e} = M \). Because eigenvectors of a real symmetric matrix with distinct eigenvalues must be orthogonal, the \( M - 1 \) eigenvectors \( {\bf v}_{1}, \ldots, {\bf v}_{M-1} \) with generally nonzero eigenvalues are all orthogonal to \( {\bf e} \), and thus span the \( M - 1 \) dimensional subspace orthogonal to \( {\bf e} \) .</p>
<p>Let \( C_{\alpha}({\bf r}) \) denote a component of the vector \( {\bf c}({\bf r}) \) in a basis of these eigenvectors, defined such that       </p><p class="formulaDsp">
\[
   {\bf c}({\bf r}) = \frac{1}{M}\sum_{\alpha = 1}^{M}
   C_{\alpha}({\bf r}) {\bf v}_{\alpha}
   \quad\quad
   C_{\alpha}({\bf r}) =
   {\bf v}^{T}_{\alpha} {\bf c}({\bf r})
\]
</p>
<p> for all \( \alpha = 1, \ldots, M \) . Here and hereafter, we use lower case Greek letters \( \alpha, \beta \) for eigenvector indices and small Latin letters \( i, j, \ldots \) for monomer type indices, and use the Einstein summation convention and/or matrix multiplication only to represent sums over repeated monomer type indices. Note that, because \( {\bf v}_{M} = {\bf e} \), the constraint requires that \( C_{M}({\bf r}) = c_{0}\) for all \( {\bf r} \).</p>
<p>By substituting the expansion of \( {\bf c} \) in eigenvectors of the projected \( \chi \) matrix into the definition of \( U_{\rm int} \), while setting \( C_{M}({\bf r}) = c_{0} \) and noting that \( {\bf P}{\bf v}_{\alpha} = {\bf v}_{\alpha} \) for all \( \alpha = 1, \ldots, M - 1 \), it is straightforward to show that         </p><p class="formulaDsp">
\[
   U_{\rm int} =
   \sum_{\alpha=1}^{M-1}
   \int d{\bf r} \;  \left \{
   \frac{v \lambda_{\alpha} }{2M} C_{\alpha}^{2} ({\bf r})
   + S_{\alpha} C_{\alpha}({\bf r})
   \right \}
   + U_{\rm int}^{(0)} 
\]
</p>
<p> where we have defined    </p><p class="formulaDsp">
\[
   S_{\alpha} \equiv
   \frac{1}{M^2} {\bf v}_{\alpha}^{T} {\boldsymbol \chi} {\bf e}
\]
</p>
<p> for all \( \alpha = 1, \ldots, M \),   </p><p class="formulaDsp">
\[
    U_{\rm int}^{(0)} = VS_{M}/2v 
\]
</p>
<p> and \( V \) is total system volume.</p>
<p>Field components associated with positive and negative eigenvalues of \( \tilde{\boldsymbol \chi} \) must be treated differently when constructing a functional integral representation of \( Z \) . For each \( \alpha = 1, \ldots, M - 1\), let    </p><p class="formulaDsp">
\[
   \lambda_{\alpha}  = - \sigma_{\alpha}^{2} |\lambda_{\alpha}|
   \quad,
\]
</p>
<p> with \( \sigma_{\alpha} = 1 \) for all \( \lambda_{\alpha} &lt; 0 \) and \( \sigma_{\alpha} = i \) for \( \lambda_{\alpha} &gt; 0 \). By convention, we also define \( \sigma_{M} = i \) . Let \( L \) denote the number of negative eigenvalues of \( \tilde{\boldsymbol \chi} \) . By convention, for systems with \( 0 &lt; L &lt; M - 1 \), we take the first \( L \) eigenvalues \( \lambda_1, \ldots, \lambda_{L} \) to be negative and take eigenvalues \( L+1, \ldots, M - 1 \) to be non-negative, while \( \lambda_{M} = 0 \) .</p>
<p><b> Particle-Field Transformation: </b></p>
<p>A Hubbard-Stratonovich transformation may used to transform the Boltzmann factor \( \exp( -U_{\rm int} ) \) given above into a functional integral over \( M - 1 \) real-valued auxiliary fields \( \omega_{1}({\bf r}), \ldots, \omega_{M-1}({\bf r}) \), of the form            </p><p class="formulaDsp">
\[
   e^{-U_{\rm int} }
   =  \frac{ e^{-U_{\rm int}^{(0)} }}{N}
   \int {\cal D}\omega&#39;
   \exp \left \{ - \sum_{\alpha=1}^{M-1}
   \int \! d{\bf r} \; \left [
    \frac{ M \omega_{\alpha}^{2}}{ 2 v |\lambda_{\alpha}| }
          + \sigma_{\alpha} \omega_{\alpha} C_{\alpha}
          + S_{\alpha} C_{\alpha}
   \right ] \right \}
   \; ,
\]
</p>
<p> where \( \int {\cal D} \omega&#39; \) denotes a functional integral over the \( M-1 \) auxiliary fields \( \omega_{1}, \ldots, \omega_{M-1} \),         </p><p class="formulaDsp">
\[
   N \equiv
   \int {\cal D}\omega&#39;
   \exp \left \{  -
   \sum_{\alpha=1}^{M-1}
   \int \! d{\bf r} \;
   \frac{M \omega_{\alpha}^{2}}{ 2 v |\lambda_{\alpha}| }
   \right \}
\]
</p>
<p> is a constant.</p>
<p>The \( \delta \)-function that constrains the total monomer concentration may also be expressed as a functional integral      </p><p class="formulaDsp">
\[
   \delta(c({\bf r}) - c_{0}) =
   \int {\cal D}\omega_{M} \exp \left \{
   - i \int d{\bf r} \; \omega_{M} [ \; C_{M} - c_{0} \; ]
   \right \}
\]
</p>
<p> in which \( \omega_{M}({\bf r}) \) is a fluctuating Lagrange multplier field that imposes the constraint requiring that \( C_{M}({\bf r}) = c_{0} \), for all \( {\bf r} \), and \( \int {\cal D}\omega_{M} \) is a functional integral over this field.</p>
<p>Substituting the field-theoretic expressions for \( e^{-U_{\rm int}} \) and the \( \delta \)-function into the definition of the \( Z \) for an incompressible system, we obtain      </p><p class="formulaDsp">
\[
   Z = N^{-1}
   \int {\cal D}\omega \; e^{ -H_{\rm f} }
   \int \! {\cal D}{\bf r} \; e^{-U_{\rm id} - H_{\rm c}}
   \quad,
\]
</p>
<p> in which \( \int {\cal D}\omega \) denotes an integral over all \( M \) real fields \( \omega_{1}, \ldots, \omega_{M} \) (including the Lagrange multiplier field \( \omega_{M} \) ), and       </p><p class="formulaDsp">
\[
   H_{\rm f}  =
   \int \! d{\bf r} \; \left \{
   - \sum_{\alpha=1}^{M-1}
     \frac{M \omega_{\alpha}^{2} }{ 2 v |\lambda_{\alpha}|}
   - i \omega_{M}c_{0} \right \}  + U_{\rm int}^{(0)} \quad
\]
</p>
       <p class="formulaDsp">
\[
   H_{\rm c}  =
   \sum_{\alpha=1}^{M}
   \int \! d{\bf r} \;
    W_{\alpha} ({\bf r}) C_{\alpha}({\bf r})
   \quad.
\]
</p>
<p> The fields \( W_{1}, \ldots, W_{M} \) used to define \( H_{\rm c} \) are given by     </p><p class="formulaDsp">
\[
   W_{\alpha}({\bf r}) \equiv
   + \sigma_{\alpha} \omega_{\alpha}({\bf r})
   + S_{\alpha}
\]
</p>
<p> for all \( \alpha = 1, \ldots, M - 1 \) and    </p><p class="formulaDsp">
\[
   W_{M}({\bf r}) \equiv i\omega_{M}({\bf r})
   \quad,
\]
</p>
<p> for \( \alpha = M \). Note that Hamiltonian component \( H_{\rm f} \) depends only on the auxiliary fields (where the subscript f denotes "field"), while \( H_{\rm c} \) introduces a coupling between the auxiliary fields and monomer concentrations (where the subscript c thus denotes "concentration" or "coupling").</p>
<p>The energy \( H_{\rm c} \) can also be expressed as a sum      </p><p class="formulaDsp">
\[
   H_{\rm c}  =
   \sum_{i=1}^{M} \int \! d{\bf r} \;
   w_{i}({\bf r})c_{i}({\bf r})
   \quad,
\]
</p>
<p> in which \( w_{1}({\bf r}), \ldots w_{M}({\bf r}) \) denote potential fields associated with specific monomer types, given by       </p><p class="formulaDsp">
\[
   w_{i}({\bf r}) =
   \sum_{\alpha=1}^{M} W_{\alpha}({\bf r}) v_{\alpha i}
   \quad \quad
   W_{\alpha}({\bf r}) =
   \frac{1}{M} \sum_{j=1}^{M} v_{\alpha j} w_{j}({\bf r})
\]
</p>
<p> for all \( i = 1, \ldots, M \) and \( \alpha = 1, \ldots, M \) . The fields \( w_{1}, \ldots, w_{M} \) are the monomer chemical potential fields used within the solution of the modified diffusion equation to compute single-polymer partition functions for chains in an external field.</p>
<p><b> Field-Theoretic Hamiltonian: </b></p>
<p>The functional integral expression for \( Z \) obtained above may expressed as an integral   </p><p class="formulaDsp">
\[
  Z = N^{-1} \int {\cal D}\omega \; e^{-H}
\]
</p>
<p> in which   </p><p class="formulaDsp">
\[
  H = H_{\rm f} - \ln Z_{\rm id}[w]
\]
</p>
<p> is an effective Hamiltonian, and    </p><p class="formulaDsp">
\[
  Z_{\rm id}[w] =
  \int {\cal D}{\bf r} \; e^{-U_{\rm id} - H_{\rm c} } \\
\]
</p>
<p> is the partition function of a hypothetical gas of non-interacting molecules in which monomers of type \( i \) are subjected to a field \( w_{i}({\bf r}) \) . The result is a straightforward generalization of that obtained for standard AB systems, after generalizing the definitions of both \( H_{\rm f} \) and \( H_{\rm c} \).</p>
<p><em> Comment (for users that read the source code) </em>: Many of the data structures and algorithms that are required to implement this symmetric formulation of polymer field theory, but that are not needed for SCFT, are provided by the Simulator class template defined in either the <a class="el" href="namespacePscf_1_1Rpc.html" title="Real periodic fields, SCFT and PS-FTS (CPU).">Pscf::Rpc</a> and <a class="el" href="namespacePscf_1_1Rpg.html" title="SCFT and PS-FTS with real periodic fields (GPU)">Pscf::Rpg</a> namespaces. These two closely analogous class templates each takes the dimension D of space as a template parameter, and only differ in that <a class="el" href="classPscf_1_1Rpc_1_1Simulator.html" title="Field theoretic simulator (base class).">Pscf::Rpc::Simulator</a> is designed for a CPU, while <a class="el" href="classPscf_1_1Rpg_1_1Simulator.html" title="Field theoretic simulator (base class).">Pscf::Rpg::Simulator</a> is designed to use a GPU. In either namespace, the Simulator class template provides code to construct and diagonalize the projected chi matrix, and to compute the field theoretic Hamiltonian \( H \) and its functional derivatives. Instances of the Simulator template are used as base classes for <a class="el" href="rpc_BdSimulator_page.html">BdSimulator</a> and <a class="el" href="rpc_McSimulator_page.html">McSimulator</a> classes that provide more specialized algorithms and data structures that are needed for Brownian dynamics (BD) or Monte Carlo (MC) samplying algorithms, respectively.</p>
<p><a class="anchor" id="psfts_theory_general_AB_sub"></a><b> Standard AB Systems (Revisited): </b></p>
<p>For any system with \( M = 2 \), the fact that \( {\bf v}_{M} = {\bf v}_{2} = {\bf e} \), and that distinct eigenvectors of \( \tilde{\boldsymbol \chi} \) must be orthogonal, immediately implies that \( {\bf v}_{1} = [1 -1]^{T} \). For a standard AB system with \( \chi_{11} = \chi_{22} = 0 \), it is straightforward to use knowledge of eigenvector \( {\bf v}_{1} \) to show that    </p><p class="formulaDsp">
\[
    \lambda_1 = -\chi \quad\quad 
    S_{1} = 0  \quad,
\]
</p>
<p> and that \( U^{(0)}_{\rm int} = V \chi /(4 v) \). For \( \chi &gt; 0 \), this yields \( \lambda_{1} &lt; 0 \) and thus \( \sigma_{1} = 1 \). Substituting these values into the general expressions for \( H_{\rm f} \) and \( H_{\rm c} \) is then found to reproduce the expressions given previously for a standard AB system. The general symmetric formulation for incompressible systems thus includes the above formulation for standard AB systems with \( \chi &gt; 0 \) as a special case.</p>
<p><br  />
 <a class="el" href="psfts_page.html">Partial Saddle-Point Field Theoretic Simulation (PS-FTS)</a> (Prev, Up) &#160; &#160; &#160; &#160; <a class="el" href="psfts_psa_page.html">Partial Saddle-Point Approximation</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Apr 14 2025 16:24:04 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
