<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Field File - Symmetrized Basis (Periodic)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="index.html">PSCF - Polymer Self-Consistent Field</a></li><li class="navelem"><a href="scft_page.html">Self-Consistent Field Theory</a></li><li class="navelem"><a href="scft_field_page.html">Field Files</a></li><li class="navelem"><a href="scft_field_periodic_page.html">Field File - Periodic Fields (pscf_pc and pscf_pg)</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Field File - Symmetrized Basis (Periodic) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="scft_field_periodic_page.html">Field File - Periodic Fields (pscf_pc and pscf_pg)</a> (Prev/Up) &#160; &#160; &#160; &#160; <a class="el" href="scft_field_rgrid_page.html">Field File - R-Grid (Periodic)</a> (Next) <br  />
</p>
<p>The basis file format is one of three formats used by the pscf_pc and pscf_pg programs to describe spatially periodic fields in systems with a specified crystal lattice type and space group symmetry. This file format is basis on a symmetry-adapted Fourier basis in which each field is expanded using a set of basis functions that are invariant under all symmetry operations in a specified space group. This file format can be used to describe either chemical potential fields (w fields) or concentration / volume fraction fields (c fields).</p>
<p>Consider the basis file format for the chemical potential fields in a system with N_monomer monomer types. Let \( w_{\alpha}(\textbf{r}) \) denote the monomer chemical potential field associated with monomer type \( \alpha \) , for any integer \( \alpha = 0, \ldots, \) N_monomer - 1 . The basis file format for such a field contains the coefficients for an expansion of each such field as a generalized Fourier series    </p><p class="formulaDsp">
\[   w_{\alpha}(\textbf{r}) =
   \sum_{i=0}^{N_{\rm b}-1} a_{i\alpha} f_{i}(\textbf{r})
\]
</p>
<p> in which \( f_{i}(\textbf{r}) \) is a real basis function with the prescribed symmetry, \( a_{i\alpha} \) is an associated real coefficient, and \( N_{\rm b} \) is the number of basis functions used in the expansion.</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_fourier_sec"></a>
Symmetry-Adapted Fourier Basis</h1>
<p>The symmetry-adapted Fourier basis used by the pscf_pc and pscf_pg programs is a finite sequence of of real orthogonal basis functions, denoted here by    </p><p class="formulaDsp">
\[  f_{0}(\textbf{r}), f_{1}(\textbf{r}), \ldots, f_{N_{\rm b}-1}(\textbf{r})
  \quad,
\]
</p>
<p> such that every function in the sequence is invariant (i.e., symmetric) under all the symmetry operations in a specified space group. The number of functions in this basis, denoted by \( N_{\rm b} \), depends upon the space group and the dimensions of the mesh that is used to discretize all fields in these programs (i.e., the number of grid points in each direction). The name of the relevant space group is specified both in the parameter file and the field file header. The mesh dimensions are specified in the parameter file.</p>
<p>Each of these symmetry-adapted basis functions is equal to a sum of plane waves with wavevectors \( {\bf G}_{0}, {\bf G}_{1}, \ldots \) that belong to the reciprocal lattice for the crystal, and that are related to to one another either by symmetry operations of the space group or (for non-centrosymmetric groups) by the inversion operation \( {\bf G} \rightarrow -{\bf G} \), or both. These relationships imply that the wavevectors in such a set must all be vectors of equal magnitude \( |{\bf G}_{0}| = |{\bf G}_{1}| = \cdots \). Each basis function \( f_{i}({\bf r}) \) can thus be expressed as a sum of the form     </p><p class="formulaDsp">
\[    f_{i}({\bf r}) =
    \sum_{a=0}^{M_{i}-1} d_{ia} e^{i{\bf G}_{a}\cdot {\bf r}}
    \quad,
\]
</p>
<p> in which \( M_{i} \) is the number of plane waves in the expansion, and \( d_{ia} \) is a complex coefficient of the plane wave with wavevector \( {\bf G}_{a} \) in the expansion of basis function \( f_{i}({\bf r}) \).</p>
<p>The basis functions used by PSCF form satisfy an orthonormality condition that requires that     </p><p class="formulaDsp">
\[   \frac{1}{V} \int \! d^{D}r \;
   f_{i}(\textbf{r}) f_{j}(\textbf{r})
   = \delta_{ij}
\]
</p>
<p> where the integral is taken over one unit cell of a periodic structure in D-dimensional space and \( V \) is the generalized volume (3D volume, 2D area, or 1D length) of the unit cell. Here, \( \delta_{ij} \) denotes the Kronecker delta function, which is defined to be \( \delta_{ij} = 1 \) for \( i=j \) and 0 for \( i \neq j \). A corresponding condition for functions that are defined on the points of a regular grid replaces the average over space, given in the above expression as an integeral divided by a volume, by an average over all grid points.</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_format_sec"></a>
File Format</h1>
<p>This basis field file format consists of a header section followed by a data section. Readers may find it useful to also refer to the examples of field files given below for a <a class="el" href="#scft_field_basis_lamellar_sec">lamellar</a> and <a class="el" href="#scft_field_basis_gyroid_sec">gyroid</a> phase.</p>
<h2 class="doxsection"><a class="anchor" id="scft_field_basis_format_header_sub"></a>
Header Section</h2>
<p>Each field file begins with a header section that contains information about the crystallographic unit cell, space group, the number of monomers and the number of basis functions that is required to interpret the data section. The format of the header is similar for r-grid, k-grid, and basis file formats, and is described <a class="el" href="scft_field_periodic_page.html#scft_field_periodic_header_sec">here</a> . The last parameter in the header section of a basis field file is a parameter "N_basis" that gives the number of basis functions in the symmetry-adapted Fourier series.</p>
<h2 class="doxsection"><a class="anchor" id="scft_field_basis_format_data_sub"></a>
Data Section</h2>
<p>The data section of a basis field file contains exactly N_basis rows of data, each of which contains information associated with one basis function in the symmetry-adapated basis used by the program that wrote the file. Each row contains N_monomer + dim + 1 numbers. The first N_monomer values in each row are real (floating point) numbers, while the remaining values are integers.</p>
<p>As an example, consider the format of a row in the data section that is associated with basis function number \( i \). Let a[j] denote the coefficient of basis function \( i \) in the expansion of the field associated with monomer type \( j \). The format of each such row is </p><div class="fragment"><div class="line">a[N_monomer] wave[dim] size</div>
</div><!-- fragment --><p> in which:</p>
<ul>
<li>a[N_monomer] denotes a list of N_monomer floating point numbers that represent the coefficients of basis function i in the expansions of fields associated with monomer types 0, ..., N_monomer - 1.</li>
<li>wave[dim] denotes a list of dim (or D) integers that give the integer components of the reciprocal lattice wavevector for one of the waves that is superposed to construct basis function i.</li>
<li>size is the number of inequivalaent plane waves within a <a class="el" href="#scft_field_basis_star_sec">star</a> of waves that are related by space group symmetries among the waves that are superposed to construct the relevant basis function.</li>
</ul>
<p>Each of the first N_monomer columns of the data section thus contains a list of the coefficients of the expansion of the field associated with a corresponding monomer type. The coefficient in column j of row i of the data section gives the coefficient of basis function \( f_{i}({\bf r} \) i in the expansion of the field associated with monomer with type index j, for j in the range 0 to N_monomer - 1 and i in the range 1 to N_basis - 1.</p>
<p>The next dim values in each row, after the N_monomer floating point coefficients, give the integer indices of a specific reciprocal lattice wavevector that belongs to the set of wavevectors associated with that basis function. The program that reads this file uses this list of wavevector indices to uniquely identify the family of wavevectors associated with the basis function represented by a particular row in the data section, and thus uniquely identify the relevant basis function. The use of such identifier for each basis function in this file format is required by the fact that basis functions are generally not listed in any fixed order, as discussed in more detail <a class="el" href="#scft_field_basis_order_sec">below</a>.</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_lamellar_sec"></a>
Example: 1D Lamellar Phase</h1>
<p>Below is an example the concentration / volume fraction field file output for a small simulation of a centro-symmetric lamellar phase of a diblock copolymer melt that was simulated using a 1D mesh with 40 grid points:</p>
<div class="fragment"><div class="line">format  1  0</div>
<div class="line">dim</div>
<div class="line">                   1</div>
<div class="line">crystal_system</div>
<div class="line">            lamellar</div>
<div class="line">N_cell_param</div>
<div class="line">                   1</div>
<div class="line">cell_param</div>
<div class="line">    1.3835952906E+00</div>
<div class="line">group_name</div>
<div class="line">                  -1</div>
<div class="line">N_monomer</div>
<div class="line">                   2</div>
<div class="line">N_basis</div>
<div class="line">                  21</div>
<div class="line">  5.600000000000E-01  4.400000000000E-01       0     1</div>
<div class="line">  2.179734275940E-01 -2.179734275841E-01       1     2</div>
<div class="line"> -1.523969262415E-02  1.523969262143E-02       2     2</div>
<div class="line"> -5.575240954520E-03  5.575240954490E-03       3     2</div>
<div class="line">  1.108470498335E-03 -1.108470498556E-03       4     2</div>
<div class="line">  1.455449531056E-04 -1.455449530934E-04       5     2</div>
<div class="line"> -6.218980135235E-05  6.218980146350E-05       6     2</div>
<div class="line"> -8.059872486808E-07  8.059872753625E-07       7     2</div>
<div class="line">  2.826732709838E-06 -2.826732713547E-06       8     2</div>
<div class="line"> -2.194238294935E-07  2.194238338772E-07       9     2</div>
<div class="line"> -1.060764766149E-07  1.060764782164E-07      10     2</div>
<div class="line">  1.946388906884E-08 -1.946388995126E-08      11     2</div>
<div class="line">  3.010764186682E-09 -3.010764203812E-09      12     2</div>
<div class="line"> -1.161872573075E-09  1.161872692383E-09      13     2</div>
<div class="line"> -3.137859071779E-11  3.137865228352E-11      14     2</div>
<div class="line">  5.685537948359E-11 -5.685537190418E-11      15     2</div>
<div class="line"> -3.817653721188E-12  3.817577312625E-12      16     2</div>
<div class="line"> -2.332684668702E-12  2.332625641218E-12      17     2</div>
<div class="line">  4.053664853576E-13 -4.051318636739E-13      18     2</div>
<div class="line">  3.071545504276E-14 -3.077687877704E-14      19     2</div>
<div class="line"> -1.475930488937E-13 -4.916067553040E-14      20     1</div>
</div><!-- fragment --><p> <br  />
</p>
<p>The description of a unit cell for a 1D lamellar phase requires only a single unit cell parameter, and so a value of N_cell_parameter = 1 is specified in the field file header. The required parameter is the repeat period, given here as approximately 1.3859 . The program that wrote this file used theorist units in which the total length of the diblock copolymer (the sum of the block lengths) was set to 1.0 and statistical segment lengths for both monomer types were also set to 1.0, thus implicitly setting the unperturbed root-mean-squared end of the polymer equal to 1.0. The repeat period for this crystal was thus 1.3859 times the unperturbed r.m.s. end-to-end length of the block copolymer.</p>
<p>The group_name identifier of "-1" given in the field file header specifies that this is a centrosymmetric 1D crystal in which all fields are symmetric under the inversion operation, \( x \rightarrow -x \), where \( x \) denotes a 1D coordinate measured along the direction normal to the layers. This symmetry requires that the volume fraction field \( \phi_{\alpha}(x) \) for monomer type \( \alpha \) at 1D coordinate \( x \) must be even in \( x \), such that   </p><p class="formulaDsp">
\[   \phi_{\alpha}(-x) = \phi_{\alpha}(-x)
\]
</p>
<p> for each monomer type \( \alpha = 0, 1 \).</p>
<p>The symmetry-adapted basis that is automatically constructed by PSCF programs to expand functions with this symmetry is a cosine basis. To define such a basis for a function that is defined on the nodes of a grid, we define wavenumbers   </p><p class="formulaDsp">
\[   k_{n} = 2\pi n /L
\]
</p>
<p> for \( n = 0, 1, 2, 3, ..., N/2 \) where \( L \) is the lamellar period, and \( N \) is the number of nodes (i.e., grid points) in the mesh used by the program that wrote this file. The program that wrote the above file used a grid with \( N = 40 \) nodes, for which even functions can be described by a basis of 21 cosine functions. The basis function with index \( n = 0 \) is a homogeneous function   </p><p class="formulaDsp">
\[   f_{0}(x) = e^{i k_{0}x} = 1 \quad.
\]
</p>
<p> Functions for \( n = 1, 2, \ldots, 19 \) in this expansion are normalized cosines    </p><p class="formulaDsp">
\[   f_{i}(x) = \sqrt{2} \cos( k_{n} x)
   = \frac{1}{2} \left ( e^{ik_{n}x} + e^{-ik_{n}x} \right )
\]
</p>
<p> that can each be be written as a sum of two plane waves with wavenumbers \( \pm k_{n} \). The basis function with index \( n = N/2 \) is a function   </p><p class="formulaDsp">
\[   f_{N/2}(x) = \cos( k_{N/2} x) = e^{ i \pi x/L } \quad.
\]
</p>
<p> This last basis function is somewhat special, as discussed below.</p>
<p>The differences between the basis function with index \( n = N/2 = 20 \) and those with \( 0 &lt; n &lt; N/2 \) are a consequences of the fact that that periodic functions are defined internally in the pscf_pc and pscf_pg programs only on the nodes of a regular grid, rather than at arbitrary points in a continuum. The Fourier representation of each field is thus based on a discrete Fourier transform (DFT) with a finite number of waves rather than an infinite Fourier series. The function \( f_{N/2}(x) \) with an even value of \( N \) has alternating values of \( \pm 1 \) at values of \( x \) that lie on the nodes of a grid, corresponding to values \( x_{m} = m L / N \) for integers \( m = 0, \ldots, N -1 \). Values of this basis function at values of \( x \) that lie on the nodes of this grid can be expressed as a single complex exponential wave, rather than a sum of two distinct waves, because, on this grid, wavenumbers \( k_{n} \) and \( k_{-n} \) with \( n = N/2 \) are "aliases" or "images" of one another that yield equal values for \( e^{ik_{n}x_{m} } = e^{ -ik_{n}x_{m} } \) if evaluated at any position \( x_{m} \) that corresponds to one of the nodes. Generally, wavenumbers (in 1D) or wavevectors (in 2D or 3D) for which the indices associated with a particular direction differ by integer multiples of the number of grid points along each that direction are aliases of one another, and thus equivalent for this purpose, as discussed in more detail in <a class="el" href="scft_fourier_page.html#scft_fourier_dft_alias_sub">appendix</a>. Waves that are aliases of one another in this sense are counted as equivalent by the algorithm that constructs basis functions for functions that are defined on a lattice.</p>
<p>The integer that appears in the third column of each row in the data section of the above example gives the integer index \( n \) for an associated wavenumber \( k_{n} \), which ranges from 0 to 20 in this example.</p>
<p>The integer that appears in the fourth colum of each row in this example is the number of inequivalent waves used in the expansion of the associated basis function. This number has a value of \( 1 \) for \( n = 0 \) (or \( k_{n} = 0 \) ), a value of \( 2 \) for the 19 cosine basis functions with \( n =1, \ldots, 19 \), and a value of \( 1 \) for the cosine function with \( n = N/2 = 20 \) as a result of aliasing of wavenumbers used in a discrete Fourier transform.</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_gyroid_sec"></a>
Example: 3D Gyroid Phase</h1>
<p>Below is an example of a c field output from a simulation of a gyroid phase for a diblock copolymer melt. A long section of the middle of the data section of this file has been removed, as indicated by vertical dots. </p><div class="fragment"><div class="line"> format  1  0</div>
<div class="line">dim</div>
<div class="line">                   3</div>
<div class="line">crystal_system</div>
<div class="line">               cubic</div>
<div class="line">N_cell_param</div>
<div class="line">                   1</div>
<div class="line">cell_param</div>
<div class="line">    3.6735414146E+00</div>
<div class="line">group_name</div>
<div class="line">           I_ a_-3_d</div>
<div class="line">N_monomer</div>
<div class="line">                   2</div>
<div class="line">N_basis</div>
<div class="line">                 235</div>
<div class="line">  3.000000000000E-01  7.000000000000E-01       0   0   0     1</div>
<div class="line"> -2.942897932802E-01  2.942897932848E-01       2   1   1    24</div>
<div class="line"> -9.425546329793E-02  9.425546327223E-02       2   2   0    12</div>
<div class="line"> -3.864399409689E-03  3.864399436086E-03       3   2   1    48</div>
<div class="line"> -1.483047814338E-02  1.483047815806E-02       4   0   0     6</div>
<div class="line"> -3.546446264855E-02  3.546446265383E-02       4   2   0    24</div>
<div class="line">  3.138519869858E-02 -3.138519870524E-02       3   3   2    24</div>
<div class="line">  2.003121375277E-02 -2.003121374994E-02       4   2   2    24</div>
<div class="line">  1.572048423239E-02 -1.572048424396E-02       4   3   1    48</div>
<div class="line"> -1.376822797257E-02  1.376822798292E-02       5   2   1    48</div>
<div class="line"> -1.063353913450E-02  1.063353913935E-02       4   4   0    12</div>
<div class="line">         .                   .                 .   .   .    .</div>
<div class="line">         .                   .                 .   .   .    .</div>
<div class="line">         .                   .                 .   .   .    .</div>
<div class="line"> -7.575067702553E-05  7.575067344206E-05      13  13  10    24</div>
<div class="line"> -2.570604494615E-05  2.570604263390E-05      14  12  10    24</div>
<div class="line"> -5.627606758688E-05  5.627606408758E-05      14  14   8     6</div>
<div class="line">  5.879116047898E-05 -5.879115755266E-05      14  14  12     6</div>
</div><!-- fragment --><p> <br  />
</p>
<p>Data in the header section of this file is analogous to that given above in the simpler lamellar example. Because this is a cubic crystal, only a single unit cell parameter is again required to specify the size of the unit cell, and so N_cell_parameter is again equal to 1. The unit cell parameter for a cubic crystal is the length of any edges of a conventional cubic unit cell along any of three orthogonal directions. The group_name identifier I_a_-3_d is an ascii identifer for space group \( Ia\overline{3}d \), the space group of the gyroid phase.</p>
<p>The \( Ia\overline{3}d \) space group is a centro-symmetric cubic group with an inversion center at the origin of space. Each of the symmetry-adapted basis functions used to expand functions with this space group symmetry are superpositions of waves with wavevectors that belong to a family or star of wavevectors with integer indices are related to a set of integers {hkl} by permutations of the order in which indices are listed and/or changes in the sign of one or more indices. The number of wavevectors in each such star is less than or equal to 48, with 48 wavevectors in the star for stars in which the integers h, k, and l are all unequal and nonzero.</p>
<p>Consider the above example of 3D gyroid phase for a system with N_monomer = 2. The first two columns in the data section contain expansion coefficients. In the first row of the data section, columns 3-5 contain the indices "0 0 0" of the wavevector k=0 that is associated with the homogeneous function, and column 6 contains a multiplicity of 1. The second row contains the coefficients for the basis function associated with the {211} family or "star" of wavevectors, which is identified in columns 3-5 by the label "2 1 1". This star contains 24 distinct wavevectors, which can be generated by allowing for changes in sign of each index and choosing from among 3 possible locations of the unique index of absolute magnitude 2. As a result, column 6 contains a multiplicity of 24.</p>
<p>The {211} family is the first star of non-zero wavevectors from which it possible to construct a nonzero basis function that is invariant under all of the symmetries of space group of the gyroid structure. The stars that can be used to construct a nonzero basis function are precisely those that satisfy the reflection rules for allowed reflections in scattering from a crystal with a particular space group symmetry. For any crystal with space group \( Ia\overline{3}d\), {211} family gives the first allowed family of scattering reflections in small angle X-ray or neutron scattering. The symmetry-adapated Fourier series expansion for functions that are invariant under elements of a space groups that leads systematic cancellations only contains basis functions or "stars" that are not "cancelled" (i.e., those that obey the rules for allowed reflections).</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_star_sec"></a>
Stars and Star Functions</h1>
<p>The algorithm that the PSCF programs for periodic structures uses to generate a symmetry-adapted Fourier basis is based on:</p>
<ul>
<li>Grouping of all distinguishable wavevectors used in a discrete Fourier transform (DFT) into sets of wavectors that are related by symmetries of the space group, which we refer to as "stars"</li>
<li>Construction of a symmetry-adapted basis function associated with each such star, which we refer to as a "star function".</li>
</ul>
<p>Each star function is constructed as a superposition of plane waves with wavevectors that all belong to a single star, and that are thus related to each other by symmetry. The resulting set of star functions form an symmetry-adapted basis in which some functions may be complex rather than real functions of position. This basis of star functions is then used to construct a closely related basis real basis functions of the type described above.</p>
<p>The remainder of this section summarizes the relationship between stars and symmetry-adapted basis functions in a form sufficient to allow users to understand the basis file format for field files. A more detailed discussion of the underlying mathematics is given as an <a class="el" href="scft_basis_page.html">appendix</a>. That appendix provides more precise notation and definitions, and includes proofs of variety of assertions about mathematical facts that are made here without proof.</p>
<p><a class="anchor" id="scft_field_basis_star_defn"></a><b> Definition (Star) </b>: A star \( T \) of a space group \( S \) is a set of reciprocal lattice wavevectors that are are all related to one another by symmetry operations in \( S \). Every wavevevector belongs to one and only one star of a specified space group.</p>
<p>Example: In the case of a cubic crystal such as the BCC or double gyroid phase, each star is a set of wavevectors with indices that are related to a triplet of integers \( (hkl) \) with \( h \geq k \geq l \geq 0 \) by permutations and changes in sign. In such a crystal, every wavevector belongs to one such star or family of wavevectors.</p>
<p><a class="anchor" id="scft_field_basis_starfunc_defn"></a><b> Definition (Star Function) </b>: A star function associated with a star \( T \) of a space group \( S \) is a nonzero function of position that is a superposition of complex exponential plane waves with wavevectors in \( T \) that yields a function that is invariant under all symmetry operations in \( S \). If \( T \) is a star with \( M \) wavevectors \( {\bf G}_{0}, \ldots, {\bf G}_{M-1} \), then a star function \( \phi({\bf r}) \) associated with \( T \) is a sum of the form   </p><p class="formulaDsp">
\[   \phi({\bf r}) = \sum_{i=0}^{M-1} c_{i} e^{i{\bf G}\cdot {\bf r}}
\]
</p>
<p> in which the coefficients \( c_{0}, \ldots, c_{M-1} \) are generally complex numbers.</p>
<p>The requirement that a star function be invariant under all elements of a space group can be expressed as a a set of homogeneous linear equation that relate the coefficients \( c_{0}, \ldots, c_{M-1} \) of different waves in the above expansion. These relationships among coefficients are discussed in detail in the associated <a class="el" href="scft_basis_page.html">appendix</a>. The form of these equations can be shown to require that these coefficients all have equal absolute magnitude   </p><p class="formulaDsp">
\[   |c_{0}| = |c_{1}| = \cdots |c_{M-1}| \quad,
\]
</p>
<p> and impose relationships among the complex phases (arguments) of different coefficients. These symmetry relationships generally only define a star function associated with a particular star to within an arbitrary multiplicative constant: If \( \phi({\bf r}) \) is a nonzero function of the above form that is invariant under all elements of a space group, then so is \( c \phi({\bf r}) \), for any complex constant \( c \).</p>
<p>In many common, relatively simple cases, it is possible to choose the coefficients \( c_{0}, \ldots, c_{M-1} \) to all be real numbers. In the case of a symmorphic space group, in which the symmetry elements only involve point group operations (i.e., reflections, rotations, and inversions) with no associated translations (i.e., no glide planes or screw axes), the coefficients associated with different wavevectors in a star must all be equal, and are always chosen by convention to be equal, positive real numbers. For any group with an inversion center at the origin, it is always possible to chose these coefficients to all be real. In the general case of a non-symmorphic space group with no inversion center at the origin, however, we must all these coefficients to be complex numbers of equal magnitude but generally unequal phase (complex argument).</p>
<h2 class="doxsection"><a class="anchor" id="scft_field_basis_cancelled_sub"></a>
Cancelled Stars</h2>
<p>There exist some stars of some space groups for which the only solution to the set of homogeneous linear equations that relate the coefficients of waves in a star function is the trivial solution   </p><p class="formulaDsp">
\[   c_{0} = \cdots = c_{M-1} = 0 \quad
\]
</p>
<p> When this occurs, it is not possible to define an associated star function. Such stars are said to be <em> cancelled </em>.</p>
<p>The uncancelled stars of a space group are always the same as those that obey the rules for allowed reflections in a scattering experiment. Conversely, the cancelled stars (if any) are those which exhibit systematic cancellations or absences in scattering experiments.</p>
<p>One common situation that leads to the existence of cancelled stars is if the Bravais lattice for a face- or body-centered 3D lattice is defined so as to give a conventional non-primitive unit cell, e.g., by using a simple cubic Bravais lattice with orthogonal Bravais basis vectors to describe a body-centered or face-centered cubic lattice. When using such a convention for the Bravais lattice, the associated space group will contain one or more symmetry operations that simply translate the lattice by a fraction of a unit cell, thus translating the origin to a body- or face-centered lattice site. The existence of this sort of purely translational symmetry generally yields selection rules that cause some stars of wavevectors in the Bravais lattice of the declared Bravais lattice to be cancelled. In this case, some families of wavevectors are cancelled because they are vectors that belong to the reciprocal lattice of the declared Bravais lattice (e.g., the simple cubic lattice) that actually do not belong to the reciprocal lattice of the primitive body- or face-centered lattice. The code used by pscf_pc and pscf_pg programs to generate basis functions currently uses a conventional Bravais lattice with orthogonal basis vectors by default for these sorts of centered lattices, which leads to the appearance of cancelled stars (i.e, systematic cancellation) of the space groups used to describe such lattices.</p>
<p>In the above example of a field file for a gyroid phase with space group \( I a \overline{3} d \), the {211} star of wavevectors is the first star of nonzero wavevectors that is not cancelled. Cancellation of the {100}, {111}, and {210} wavevectors can be understood as direct results of the fact that the \( I a \overline{3} d \) is based on body-centered-cubic lattice. Other cancellations, such as the cancellation of the {110} star, are consequences of the existence of other symmetry operations in this space group.</p>
<h2 class="doxsection"><a class="anchor" id="scft_field_basis_uncancelled_sub"></a>
Uncancelled Stars</h2>
<p>A basis for complex or real functions with the symmetry of a specified space group can be constructed from the star functions associated with all uncancelled stars of that space group.</p>
<p><a class="anchor" id="scft_field_basis_closed_defn"></a>Uncancelled stars may be either closed or open under inversion:</p>
<ul>
<li>A star \( T \) is <em> closed </em> (or, more precisely, closed under inversion) if, for every wavevector \( {\bf G} \) in \( T \), the wavevector \( -{\bf G} \) is also in \( T \).</li>
<li>A star \( T \) is <em> open </em> (or open under inversion) if, for every wavevector \( {\bf G} \) in \( T \), \(-{\bf G}\) is not in \( T \).</li>
</ul>
<p>The following theorems about uncancelled stars and star functions are proved in an <a class="el" href="scft_basis_page.html">appendix</a>:</p>
<ul>
<li>Every wavevector belongs to exactly one star.</li>
<li>If a star is not cancelled, there exists an associated star function that is unique to within an arbitrary prefactor.</li>
<li>Every uncancelled star is either open or closed.</li>
<li>It is always possible to chose a prefactor for a star function associated with an uncancelled closed star so as to obtain a real function of position.</li>
<li>If \( T \) is an uncancelled open star, there exists another star \( T&#39; \) such that, for every wavevector \( {\bf G} \in T \), \( -{\bf G} \in T&#39; \). Such pairs of open stars are said to be related by inversion.</li>
<li>If \( T \) and \( T&#39; \) are a pair of open stars that are related by inversion, then it is possible to choose prefactors of a star function \( \phi({\bf r}) \) associated with \( T \) and a star function \( \phi&#39;({\bf r}) \) associated with \( T&#39; \) such that \( \phi&#39;({\bf r}) \) and \( \phi({\bf r}) \) are complex conjugates of one another.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="scft_field_basis_starbasis_sub"></a>
Conventions for Star Functions</h2>
<p>The PSCF programs for periodic functions generates a sequence of uncancelled stars and associated star functions, such that each such star and its associated star function are both assigned an integer index in the range \( 0, \ldots , N_{\rm b} - 1 \). We denote the resulting star functions here by \( \phi_{0}({\bf r}), \ldots, \phi_{N_{\rm b}-1}({\bf r}) \) .</p>
<p>These functions are defined so as to obey the following conventions:</p>
<ul>
<li>All star functions associated with closed stars are real functions of position.</li>
<li>Star functions associated with pairs of open stars that are related by inversion are assigned consecutive indices and are defined to be complex conjugates of one another, such that, e.g.,   <p class="formulaDsp">
\[         \phi_{i+1}({\bf r}) = \phi_{i}^{*}({\bf r})
\]
</p>
 for such a pair of stars with indices \( i \) and \( i+1 \).</li>
<li>All star functions satisfy an orthonormality relation:     <p class="formulaDsp">
\[        \frac{1}{V}\int d^{D}r \;
        \phi^{*}_{i}({\bf r}) \phi_{j}({\bf r})
        = \delta_{ij}
\]
</p>
 where the integral is taken over one unit cell and \( V \) is the generalized volume per unit cell. This normalization can be shown to implies that every coefficient in the expansion of a star function for a star with \( M \) distinct waves is a complex number of modulus \( 1/\sqrt{M} \).</li>
<li>The overall sign or phase of each basis function is fixed by choosing a "characteristic wavevector" from among the wavevectors in each star, and requiring that the coefficient of the wave with that wavevector be a real positive number.</li>
<li>The characteristic wavevectors of two stars that are related by inversion must be chosen such that, if \( {\bf G} \) is the characteristic wavevector of one star in such a pair, then \( -{\bf G} \) is the characteristic wavevector of the other. This relationship is required to guarantee that the star functions associated with two such stars be complex conjugates.</li>
</ul>
<p>The conventions described above are sufficient to define a unique star function associated with each star if they are supplemented by a convention for choosing a "characteristic wavevector" from among the waves in each star. The convention for characteristic wavevectors used in PSCF is discussed below.</p>
<p>Because each star functions is a superposition of plane waves with wavevectors of equal magnitude, each of them is also an eigenfunction of the Laplacian. Each such star function \( \phi_{i}({\bf r}) \) thus satisfies an eigenvalue equation    </p><p class="formulaDsp">
\[   -\nabla^{2}\phi_{i}(\textbf{r}) = \lambda_{i} \phi_{i}(\textbf{r})
   \quad.
\]
</p>
<p> with an eigenvalue \( \lambda_{i} \geq 0 \) equal to the square magnitude \( |{\bf G}|^{2} \) of any of the wavevectors in the associated star.</p>
<p>Any complex or real field \( w({\bf r}) \) that is invariant under all elements of space group \( S \) can be expanded in a basis of such star functions as a Fourier series   </p><p class="formulaDsp">
\[   w({\bf r}) = \sum_{i=0}^{N_{\rm b} -1 } c_{i} \phi_{i}({\bf r})
\]
</p>
<p> with complex coefficients \( c_{0}, c_{1}, \ldots, c_{N-1} \), where \( N_{\rm b} \) denotes the number of basis functions used in the expansion.</p>
<h2 class="doxsection"><a class="anchor" id="scft_field_basis_waveofstar_sec"></a>
Characteristic Wavevectors</h2>
<p>By convention, the characteristic wavevector for a closed star or the first of two open stars that are related by inversion is taken to be the reciprocal lattice wavevector in the star for which the integer components are "greatest" when lists of integer components are compared while treating components that appear earlier in the list as more signficant than indices that appear later. The components of such a wavevector are its components in a basis of reciprocal lattice basis vectors, which are integers for any wavevector that belongs to the reciprocal lattice (i.e., any wavevector with a periodicity commensurate with that of the crystal Bravais lattice). According to this rule for ordering lists of integers, a list of integer components \( (i,j,k) \) for a three-dimensional wavevector is "greater" than a list \( (l,m,n) \) if \( i &gt;  l \), while a list \((i, j, k )\) is greater than \( (i, m, n) \) if \( j &gt;  m \), etc. For example, the characteristic wavevector associated with a star of 48 wavevectors in a simple cubic lattice that are related to (-2, 3, 1) by permutations and sign changes is thus the wavevector with indices (3, 2, 1).</p>
<p>Wavevectors that are used in discrete Fourier transforms of functions that are defined only on the nodes of a regular grid are normally defined only modulo changes in indices by integer multiples of the number of grid points in each direction. To define a unique list of integer components for each such wavevector, we define the components of each reciprocal lattice wavevector to be the indices of an image or alias of the wavevector that yields the minimum possible value for the wavevector norm \(|{\bf G}| \). If two or more aliases of a wavevector yield vectors of exactly equal norm, we choose the image for which the list of indices is "greatest" by the definition discussed above, in which indices that appear earlier in the list are treated as more signficant. This convention requires, for example, that in the case of a one-dimensional periodic structure with a period \(L\) that is defined on a regular grid of \( N \) grid points, for even \( N\), the distinct reciprocal lattice wavenumbers are defined to be \( G_{n} = n 2\pi /L \) where \( n \) is an integer in the range \( -N/2 &lt; n \leq N/2 \). The rules discussed above provide a natural generalization of this convention to periodic functions in two or three dimensions.</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_real_sec"></a>
Real Functions</h1>
<p>The concentration and chemical potential fields that appear in SCFT calculations are real (rather than complex) functions of position. Such functions can be expanded in a basis of complex star functions, but the resulting expansion generally requires the use of complex coefficients for some star functions. It is more convenient for most purposes to express real fields as a linear combination of real basis functions.</p>
<p>The PSCF programs for periodic functions use the following rules to construct a sequence of real basis functions denoted here by \( f_{0}({\bf r}), \ldots, f_{N_{\rm b}-1}({\bf r}) \):</p>
<ul>
<li>If \( \phi_{i}({\bf r}) \) is a star function associated with a closed star, then we define   <p class="formulaDsp">
\[         f_{i}({\bf r}) = \phi_{i}({\bf r}) \quad.
\]
</p>
</li>
<li>If \( \phi_{i}({\bf r}) \) and \( \phi_{i+1}({\bf r}) = \phi_{i}^{*}({\bf r})\) are star functions associated with a pair of open stars that are related by inversion, we define two corresponding real functions:     <p class="formulaDsp">
\[        f_{i}({\bf r})
        = [ \phi_{i}({\bf r}) + \phi^{*}_{i}({\bf r}) ]/\sqrt{2}
        \quad,
\]
</p>
 and     <p class="formulaDsp">
\[        f_{i+1}({\bf r}) =
        [ \phi_{i}({\bf r}) - \phi^{*}_{i}({\bf r}) ]/(\sqrt{2} i)
        \quad.
\]
</p>
</li>
</ul>
<p>It is straightforward to confirm that the resulting functions are real, orthonormal in the required sense, and eigenfunctions of the Laplacian. In the special case of a centro-symmetric group, for which all stars are closed, the resulting sequence of real functions is identical to the sequence of star functions, which are already all real function in this case. For non-centrosymmetric groups, however, this yields a different basis that spans the same function space as that spanned by the corresponding star functions.</p>
<p>The resulting sequence \( f_{0}, \ldots, f_{N_{\rm b}-1} \) provides a convenient basis for expanding any real function \( w({\bf r}) \) with the desired space group symmetry as a superposition   </p><p class="formulaDsp">
\[   w({\bf r}) = \sum_{i=0}^{N_{\rm b}-1} a_{i} f_{i}({\bf r})
\]
</p>
<p> with real coefficients \( a_{0}, a_{1}, \ldots, N_{\rm b} -1 \).</p>
<p>The resulting expansion of a real function in real basis functions can also be expressed as an equivalent expansion in a basis of star functions, of the form   </p><p class="formulaDsp">
\[   w({\bf r}) = \sum_{i=0}^{N_{\rm b}-1} c_{i} \phi_{i}({\bf r})
\]
</p>
<p> with the following rules for the complex coefficients \( c_{0}, \ldots, c_{N_{\rm b}-1} \):</p>
<ul>
<li>The coefficient \( c_{i} \) of any star function that is associated with a closed star is given by   <p class="formulaDsp">
\[         c_{i} = a_{i} \quad,
\]
</p>
 giving a real Fourier coefficient.</li>
<li>The coefficients \( c_{i} \) and \( c_{i+1} \) of two star functions that are associated with open stars that are related by inversion are given by   <p class="formulaDsp">
\[         c_{i} = ( a_{i} - i a_{i+1} )/\sqrt{2}
\]
</p>
 and   <p class="formulaDsp">
\[         c_{i+1} = ( a_{i} + i a_{i+1} )/\sqrt{2} \quad,
\]
</p>
 respectively, giving \( c_{i+1} = c_{i}^{*} \).</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_format2_sec"></a>
File Format (Revisited)</h1>
<p>The above discussion allows us to give a somewhat more precise description of the format of data section of a basis field file. Consider row number \( i \) of the data section, for \( i = 0, \ldots, N_{\rm b} \) for a system that contains N_monomer different monomer types.</p>
<p>Each of the first N_monomer columns of of this row contain a value for the coefficient \( a_{i} \) of the real basis function \( f_{i}({\bf r}) \) in the symmetry-adapated expansion of a field associated with a particular monomer type in a basis of real functions, with columns listed in order of increasing monomer type index.</p>
<p>The next dim entries in such a row (where dim is the dimension of space) are integers that give the integer components of the characteristic wavevector of star \( i \) (i.e., the star with index \( i \), which is associated with star function \( \phi_{i}({\bf r}) \) ), defined using the numbering scheme described above.</p>
<p>The last entry in row \( i \) is the number \( M_{i} \) of wavevectors in star \( i \). The number of waves that are superposed to create the real basis function \( f_{i}({\bf r}) \) is equal to \( M_i \) if star \( i \) is closed under inversion (in which case \( f_{i}({\bf r}) = \phi_{i}({\bf r})\) ) and is equal to \( 2M_{i} \) if star \( i \) is open under inversion (in which case \( f_{i}({\bf r}) \) is a superposition of \( \phi_{i}({\bf r}) \) and its complex conjugate).</p>
<h1 class="doxsection"><a class="anchor" id="scft_field_basis_order_sec"></a>
Ordering of Basis Functions</h1>
<p>The order in which star functions or associated real basis functions are listed and assigned indices by a pscf_pc or pscf_pg program is chosen so as to give eigenvalues of the operator \( - \nabla^{2} \) that were ordered in increasing (or at least non-decreasing) order when the basis was constructed. The eigenvalues of \( -\nabla^{2} \) for a given basis function are given by the square magnitudes of associated wavevectors, generally depend on the values of unit cell parameters. The order of the eigenvalues of the Laplacian for a set of symmetry-adapted basis is actually independent of the values of the unit cell parameter for several common, highly symmetric lattice systems, including all 1D lamellar, 2D square or hexagonal, and 3D cubic crystals. For less symmetric crystal systems, however, such as oblique or rectangular 2D crystals and tetragonal, orthorhombic, triclinic or monoclinic 3D crystals, the order in which basis functions are listed in such an ordered sequence generally does depend on the values of unit cell parameters such as the unit cell lengths along different axes.</p>
<p>The set of basis functions that is created to describe functions with a specified space group only depends on the space group and the numerical discretization mesh (i.e., the number of grid points in each direction. The order in which basis functions are assigned indices and stored internally generally depends, however, upon the values of the unit cell parameters that were available when the basis was constructed.</p>
<p>The pscf_pc and pscf_pg programs normally create a symmetry-adapted basis immediately after the first time the program reads a set of values for unit cell parameters from a file. This usually happens the first time the program executes a command that reads a chemical potential or concentration field from file. All of the field file formats used by pscf_pc and pscf_pg programs contain a complete description of the unit cell, including unit cell parameter values. The space group name and mesh dimensions are given in the parameter file, which is read before the command file or any field files, but the parameter file does not contain values of unit cell parameters. The space group and mesh specified in the parameter file cannot be changed after they are initialized with values provided in the parameter file. Similarly, the symmetry-adapted Fourier basis is normally initialized only once during each execution of a program, when the program first obtains access to a set of unit cell parameters, and remains unchanged during the rest of the program execution.</p>
<p>This order in which the basis functions are assigned indices during construction of the basis determines the order in which rows associated with different basis functions are written to an output file when a pscf_pc or pscf_pg program writes any field to a file in basis format. Values of unit cell parameters can be modified during execution of a SCFT program, after the basis is constructed, by iteration algorithms that adjust these parameters so as to minimize free energy. The order in which rows associated with different basis functions are written to such a field file thus may not orrespond to the order in which they would be listed if the basis were re-constructed using the unit cell parameters listed in the header of the field file. When such a file is read, the code that reads the file thus cannot assume that fows associated with different basis functions will appear in any particular order, and must instead use the wavevector indices that appear in each row of the data section to identity the associated basis function.</p>
<p><br  />
 <a class="el" href="scft_field_periodic_page.html">Field File - Periodic Fields (pscf_pc and pscf_pg)</a> (Prev/Up) &#160; &#160; &#160; &#160; <a class="el" href="scft_field_rgrid_page.html">Field File - R-Grid (Periodic)</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
