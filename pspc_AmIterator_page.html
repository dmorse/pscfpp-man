<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Pspc::AmIterator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="user_page.html">3 User Guide</a></li><li class="navelem"><a class="el" href="user_param_page.html">3.3 Parameter Files</a></li><li class="navelem"><a class="el" href="user_param_pc_page.html">3.3.7 pscf_pc (Periodic Problems, CPU)</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Pspc::AmIterator </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The AmIterator algorithm used by the pscf_pc programs solves the SCFT equations for a periodic system using the Anderson Mixing algorithm. The variant of this algorithm used here is almost identical to that described by Arora et al., which is also implemented in the Fortran version of PSCF. This algorithm varies the fields by adjusting the compoments of the field in a basis of symmetry adapated basis functions, thus preserving the space-group symmetry of the fields throughout the iteration process. The algorithm can be used to either solve the SCFT equations for a rigid unit cell or to solve the SCFT equations and also optimize the unit cell parameters of a flexible unit cell so as to minimize the free energy density, depending on the value of a boolean flag named "isFlexible".</p>
<p >An example of the parameter file format for this iterator is shown below: </p><div class="fragment"><div class="line">AmIterator{</div>
<div class="line">  maxItr       100</div>
<div class="line">  epsilon      1e-8</div>
<div class="line">  maxHist      50</div>
<div class="line">  errorType    relNormResid</div>
<div class="line">  isFlexible   1</div>
<div class="line">}</div>
</div><!-- fragment --><p> The format of this block is described more formally below: </p><div class="fragment"><div class="line">AmIterator{</div>
<div class="line">   maxItr         <span class="keywordtype">int</span></div>
<div class="line">   epsilon        real </div>
<div class="line">   maxHist        <span class="keywordtype">int</span>  </div>
<div class="line">   errorType*     enumeration (<span class="stringliteral">&quot;normResid&quot;</span>, <span class="stringliteral">&quot;maxResid&quot;</span>, or <span class="stringliteral">&quot;relNormResid&quot;</span>, <span class="stringliteral">&quot;relNormResid&quot;</span> by <span class="keywordflow">default</span>)</div>
<div class="line">   isFlexible*    bool (0 or 1, 0/<span class="keyword">false</span> by <span class="keywordflow">default</span>)   </div>
<div class="line">   scaleStress*   real (10.0 by <span class="keywordflow">default</span>)</div>
<div class="line">}</div>
</div><!-- fragment --><p> Here, as elsewhere, labels followed by an asterisk (*) represent optional parameters. The meaning of the various parameters are described below: </p><table class="doxtable">
<tr>
<td><b> Label </b>  </td><td><b> Description </b>   </td></tr>
<tr>
<td>maxIter  </td><td>Maximum number of iterations that will be attempted   </td></tr>
<tr>
<td>epsilon  </td><td>Desired tolerance for convergence - iteration stops if the magnitude of the error drops below epsilon.   </td></tr>
<tr>
<td>maxHist  </td><td>Maximum number of previous trial solultions that will be retained in memory for used by the AM algorithm.   </td></tr>
<tr>
<td>errorType  </td><td>Identifer for the type of variable used to define scalar error . The only allowed values are "maxResid", "normResid", and "relNormResid", as discussed below. Optional, and equal to "relNormResid" by default.   </td></tr>
<tr>
<td>isFlexible  </td><td>Set isFlexible true to enable or false to disable iterative optimization of the unit cell parameters so as to minimize the free energy. <br  />
 Optional and false by default.   </td></tr>
<tr>
<td>scaleStress  </td><td>Constant factor by which stress components are multipled in the definition of the residual attempted if isFlexible is true (optional).   </td></tr>
</table>
<p>The iterative loop exits if the number of iterations has reaches maxItr or if the magnitude of the scalar error drops below epsilon.</p>
<p ><b> errorType </b>: Several different definitions may be used for the scalar error, depending on the value of the identifier errorType.</p>
<ul>
<li>If errorType == maxResid, then the scalar error is take to be the maximum of the absolute magnitude of the elements of the residual vector (the L infinity norm of the residual vector).</li>
<li>If errorType == normResid, then the scalar error is take to be the L2 norm of the residual vector.</li>
<li>If errorType == normResid, then the scalar error is take to be the ratio of the L2 norm of the residual vector to the L2 norm of the w field, as in Stasiak and Matsen, Eur. Phys, Journel E, 2012.</li>
</ul>
<p ><b> scaleStress </b>: If isFlexible is true, the choice of a value for the parameter scaleStress determines how strongly the definition of the scalar error weights errors that arise from nonzero derivatives of the free energy with respect to the unit cell parameters, relative to errors arising from errors in the SCFT equations for the w fields in a fixed unit cell. This variable is irrelevant if isFlexible is false, and should normally be ommitted in this case. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 26 2022 14:10:42 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
