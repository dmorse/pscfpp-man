<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Appendix: Periodic Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="user_page.html">User Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Appendix: Periodic Functions </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="user_theory_page.html">Appendix: Self-Consistent Field Theory</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_symmetry_page.html">Appendix: Space Group Symmetry</a> (Next) <br  />
</p>
<p >This page describes the different numerical representations used in the pscf_pc and pscf_pg programs describe fields (functions of position) with the periodicity of a Bravais lattice. We will also consider a symmetry-adapted Fourier expansion appropriate for periodic fields that are also known to be invariant under all symmetry operations of a specified space group. Throughout these notes, let \( D \) denote the number of directions in which the field of interest are taken to be periodic, which is the dimensionality of the space in which these fields are defined. Allowed values of \( D \) are \( D = 1 \) for lamellar structures, \( D = 2 \) for structures such as those involving two-dimensionally periodic arrangements of cylinders (e.g., hexagonally packed cylinders), and \( D = 3 \) for crystals with full three-dimensional periodicity (e.g., arrangements of spheres and 3D network structures).</p>
<h1><a class="anchor" id="user_fourier_bravais_sec"></a>
Bravais Lattice</h1>
<p >Consider a D-dimensional crystal with a Bravais lattice defined by lattice basis vectors \( {\bf a}_{0}, \ldots, {\bf a}_{D-1} \). The Bravais lattice is defined to be the infinite set containing every vector \( {\bf R} \) that can be expressed as a sum  </p><p class="formulaDsp">
\[
   {\bf R} = \sum_{\alpha=0}^{D-1} m_{\alpha} {\bf a}_{\alpha}
\]
</p>
<p> with arbitrary integer values of the indices \( m_{0},\ldots,m_{D-1} \). A field \( f({\bf r}) \) is said to have the periodicity of this lattice if it is invariant under translation by any Bravais lattice vector, i.e., if  </p><p class="formulaDsp">
\[
  f({\bf r} + {\bf R}) = f({\bf r})
\]
</p>
<p> for any D-dimensional position vector \( {\bf r} \) and any translation vector \( {\bf R} \) that belongs to the Bravais lattice.</p>
<h1><a class="anchor" id="user_fourier_reciprocal_sec"></a>
Reciprocal Lattice</h1>
<p >Let vectors \( {\bf b}_{0}, \ldots, {\bf b}_{D-1} \) denote \( D \) reciprocal lattice basis vectors that are defined such that  </p><p class="formulaDsp">
\[
  {\bf a}_{\alpha} \cdot {\bf b}_{\beta} = 2\pi \delta_{\alpha \beta}
\]
</p>
<p> for \( \alpha, \beta \in [0,..,D-1] \), where \( \delta_{\alpha \beta}\) is a Kronecker delta function. The reciprocal lattice associated with this Bravais lattice is defined to be the infinite set containing every vector \( {\bf } \) that can be expressed as a sum <a class="anchor" id="user_fourier_Gofn_eqn"></a> </p><p class="formulaDsp">
\[
   {\bf G}(n_{0}, \ldots, n_{D-1})
   = \sum_{\alpha=0}^{D-1} n_{\alpha} {\bf b}_{\alpha}
\]
</p>
<p> with integer values of \( n_{0}, \ldots, n_{D-1} \). In what follows, we will sometimes refer to the integer indices \( n_{0}, \ldots, n_{D-1}\) that appear in this expansion of a reciprocal lattice vector as Miller indices for that wavevector.</p>
<p >Any field with the periodicity of a Bravais lattice may be expanded as a Fourier series<a class="anchor" id="user_fourier_fourierR_eqn"></a> </p><p class="formulaDsp">
\[
  f({\bf r}) = \sum_{{\bf G}} \tilde{f}({\bf G})
  e^{i {\bf G} \cdot {\bf r}}
  \quad,
\]
</p>
<p> in which \( {\bf G} \) denotes a reciprocal lattice vector, the sum is taken over the infinite set of all reciprocal lattice vectors, and \( \tilde{f}({\bf G}) \) is a complex Fourier coefficient associated with reciprocal lattice vector \( {\bf G} \). The Fourier coefficient \( \tilde{f}({\bf G}) \) is equal to the value of the integral  </p><p class="formulaDsp">
\[
  \tilde{f}({\bf G}) =  \frac{1}{V_{\rm cell}}
  \int\limits_{{\rm cell}} d^{D}r \;
  e^{-i {\bf G} \cdot {\bf r}} f({\bf r}) \quad,
\]
</p>
<p> in which the integral is a D-dimensional integral over one unit cell, and \( V_{\rm cell} \) is the general volume of the unit cell (e.g., the length for D=1, area for D=2, or volume for D=3).</p>
<p >The general Fourier series given above can be used to expand either real- or complex valued periodic functions of position. If \( f \) is a real-value function, then its Fourier coefficients must satisfies the condition  </p><p class="formulaDsp">
\[
   \tilde{f}(-{\bf G}) = \tilde{f}^{*}({\bf G})
\]
</p>
<p> for any reciprocal lattice vector \( {\bf G} \). Here and hereafter, we use \( C^{*} \) to denote the complex conjugate of any complex number \( C \). Note that this constraint requires that that \( \tilde{f}({\bf G}) \) be real in the specal case \( {\bf G} = 0 \).</p>
<h1><a class="anchor" id="user_fourier_reduced_sec"></a>
Reduced Coordinates</h1>
<p >It is convenient to introduce dimensionless reduced coordinates \( r_{0}, \ldots, r_{D-1} \) associated with any Cartesian position vector \( {\bf r} \) within a crystal, which are defined such that  </p><p class="formulaDsp">
\[
   {\bf r}(r_0, \ldots, r_{D-1})
   = \sum_{\alpha = 0}^{D-1} {\bf a}_{\alpha} r_{\alpha}
  \quad.
\]
</p>
<p> The reduced coordinates are thus the components of \( {\bf r} \) in a basis of Bravais lattice basis vectors. The primary unit cell of a crystal is defined to be a region in which \( 0 \leq r_{\alpha} &lt; 1 \) for all \( \alpha = 0, \ldots, D-1 \). This corresponds to a unit domain in the space of reduced coordinates that is give by the domain \( [0,1) \) for D=1, a unit square for D=2 or a unit cube for D=3. This maps onto a unit cell in Cartesian coordinates that is a parallelogram for D=2 or a parallelopiped for D=3, and for which the vectors connecting neighboring corners are Bravais lattice basis vectors.</p>
<p >Suppose that \( f({\bf r}) \) is a periodic function of the Cartesian position vector \( {\bf r} \) and that \( F(r_{0}, \ldots, r_{D-1}) \) is an equivalent function of the reduced coordinates \( r_{0}, \ldots, r_{D-1} \), defined such that  </p><p class="formulaDsp">
\[
 F(r_{0}, \ldots, r_{D-1}) =
 f({\bf r}(r_{0},\ldots,r_{D-1}))
\]
</p>
<p> for any list of reduced coordinates. The requirement that a function \( f({\bf r})\) be periodic under translations by Bravais lattice vector is equivalent to a requirement that \( F \) be invariant under changes of any reduced coordinate by addition of arbitrary integer. That is, for any periodic function \( F \) of the reduced coordinates,  </p><p class="formulaDsp">
\[
   F(r_{0} + k_{0}, \ldots, r_{D-1} + k_{D-1} )
   = F(r_{0}, \ldots, r_{D-1} )
\]
</p>
<p> for arbitrary integer values of \( k_{0}, \ldots, k_{D-1} \).</p>
<p >Using the above expressions for \( {\bf r}(r_{0}, \ldots, r_{D-1}) \) and \( {\bf G}(n_{0}, \ldots, n_{D-1}) \) and the bi-orthogonality relation for Bravais and reciprocal basis vectors, it is straightforward to show that  </p><p class="formulaDsp">
\[
   \exp \left (  i{\bf G} \cdot {\bf r} \right )
   =
   \exp \left ( 2\pi i \sum_{\alpha = 0}^{D-1} n_{\alpha} r_{\alpha} \right )
\]
</p>
<p> for any choice of reciprocal lattice vector \( {\bf G}(n_{0}, \ldots, n_{D-1}) \) and any position vector \( {\bf r}(r_{0}, \ldots, r_{D-1}) \). Upon substituting this into the general Fourier series expansion for a periodic function \( f({\bf r})\) given <a class="el" href="user_fourier_page.html#user_fourier_fourierR_eqn">above</a>, we find that the corresponding function \( F(r_{1}, \ldots, r_{D-1}) \) of the reduced coordinates may be expressed as an infinite series <a class="anchor" id="user_fourier_fourierX_eqn"></a> </p><p class="formulaDsp">
\[
  F(r_{0}, \ldots, r_{D-1}) =
  \sum_{n_{0} = -\infty}^{\infty} \cdots
  \sum_{n_{D-1} = -\infty}^{\infty}
  \tilde{F}(n_{0},\ldots,n_{D-1})
  \exp \left ( 2\pi i \sum_{\alpha = 0}^{D-1} n_{\alpha} r_{\alpha} \right )
\]
</p>
<p> in which the sum is taken over all integer values of each of the Miller indices, and in which \( \tilde{F}(n_{0}, \ldots, n_{D-1}) \) is a Fourier amplitude defined such that  </p><p class="formulaDsp">
\[
   \tilde{f}({\bf G}(n_{0},\ldots,n_{D-1}) \equiv
   \tilde{F}(n_{0}, \ldots, n_{D-1})
\]
</p>
<p> for the wavevector \( {\bf G}(n_{0}, \ldots, n_{D-1}) \). This form for the expansion of a periodic function of the reduced coordinates can also be justified as a special case of the general Fourier expansion applied to a function \( F(r_{0}, \ldots, r_{D-1}) \) which has the periodicity of a generalized cubic lattice with orthogonal Bravais lattice basis vectors of unit magnitude.</p>
<h1><a class="anchor" id="user_fourier_grid_sec"></a>
Mesh Discretization</h1>
<p >All fields in the pscf_pc and pscf_pg programs are represented internally using values of fields on a regular D-dimensional mesh in the space of the reduced coordinates \( r_{0}, \ldots, r_{D-1} \). Let \( M_{\alpha} \) denote the number of mesh points per unit cell along direction \( \alpha \) for each integer direction index \( \alpha = 0, \ldots, D-1 \). The values of \( M_{0}, \ldots, M_{D-1} \) are specified in the paramter file for a pscf_pc or pscf_pg program as values for elements of the parameter "mesh", whose value is a vector with integer-valued elements. Nodes on this mesh correspond to points at which each coordinate \( r_{\alpha} \) with \( \alpha \in [0, \ldots, D-1]\) has a value given by  </p><p class="formulaDsp">
\[
    r_{\alpha} = m_{\alpha}/M_{\alpha}
\]
</p>
<p> for some integer \( m_{\alpha} \in [0,\ldots,M_{\alpha}-1] \) for nodes within the primary unit cell.</p>
<h1><a class="anchor" id="user_fourier_dft_sec"></a>
Discrete Fourier Transform (DFT)</h1>
<p >Let \( F \) denote a function that is defined only on the nodes of such a regular grid, where \( F(m_{0}, \ldots, m_{D-1}) \) denotes the value of \( F \) on the grid node with integer indices \( m_{0}, \ldots, m_{D-1} \).</p>
<h2><a class="anchor" id="user_fourier_dft_forward_sub"></a>
Forward DFT</h2>
<p >Let \( \tilde{F} \) denote the discrete Fourier transform (DFT) of \( F \), which we define here by a sum <a class="anchor" id="user_fourier_dftdef_eqn"></a> </p><p class="formulaDsp">
\[
  \tilde{F} (n_0, \ldots, n_{D-1}) =
  \frac{1}{M_{\rm tot}}
  \sum_{m_{0}=0}^{M_{0}-1} \cdots
  \sum_{m_{D-1}=0}^{M_{D-1}-1}
  F(m_{0},\ldots,m_{D-1})
  \exp \left (
  -2\pi i \sum_{\alpha = 0}^{D-1} n_{\alpha} m_{\alpha}/M_{\alpha}
  \right )
\]
</p>
<p> in which \( M_{\rm tot} \) denotes the total number of grid points in the primary unit cell of the mesh, given by the product  </p><p class="formulaDsp">
\[
   M_{\rm tot} = M_{0} \cdots M_{D-1} \quad.
\]
</p>
<p> of the numbers of grid points in each direction.</p>
<h2><a class="anchor" id="user_fourier_dft_inverse_sub"></a>
Inverse DFT</h2>
<p >A periodic function \( F \) that is defined on the nodes of grid can can be expanded in terms of its DFT \( \tilde{F} \) by applying an inverse discrete Fourier transform <a class="anchor" id="user_fourier_dftinverse_eqn"></a> </p><p class="formulaDsp">
\[
  F(m_0, \ldots, m_{D-1}) =
  \sum_{n_{0}=0}^{M_{0}-1} \cdots
  \sum_{n_{D-1}=0}^{M_{D-1}-1}
  \tilde{F}(n_{0},\ldots,n_{D-1})
  \exp \left (
  2\pi i \sum_{\alpha = 0}^{D-1} n_{\alpha} m_{\alpha}/M_{\alpha}
  \right )
\]
</p>
<p> Here, as elsewhere in this discussion \( F(m_0, \ldots, m_{D-1}) \) denotes the value of the function \( F \) at the grid point with integer mesh indices \( m_{0}, \ldots, m_{D-1} \). Note that the sums over the indices \( n_{0}, \ldots, n_{D-1} \) in an inverse discrete DFT extend only over a finite number of values \( n_{\alpha} = 0, \ldots, M_{\alpha}-1 \) for each index, giving a finite rather than an infinite sum.</p>
<p ><em> Relationship to source code: </em> The D-dimensional forward and inverse DFT, defined using the conventions given above, are implemented for the field container classes used by pscf_pc programs by the member functions forwardTransform and inverseTransform defined in the class Pscf::Pspc::FFT&lt;D&gt;, respectively. The class Pscf::Pspc::FFT&lt;D&gt; is an instantiation of the class template Pscf::Pscf::FFT, in which D=1, 2, or 3 is a template parameter that represents the dimensionality of space. These member functions are simple wrappers around functions provided by the open source FFTW package. Equivalent operations are implemented for the field container classes used by the pscf_pg programs by corresponding functions of the class Pscf::Pspg::FFT&lt;D&gt;, whch are wrappers around functions provided by the cuFFT CUDA library, which implements FFTs on a GPU.</p>
<h2><a class="anchor" id="user_fourier_dft_alias_sub"></a>
Wavevector Aliasing</h2>
<p >The discrete Fourier transform \( \tilde{f} (n_0, \ldots, n_{D-1}) \) is a function of \( D \) integer indices, and is thus itself defined on a lattice in reciprocal space. It is straightforward to show that the DFT \( \tilde{F} \) defined above is itself a periodic function in reciprocal space, for which \( \tilde{F} \) is invariant under a shift of the Miller index \( n_{\alpha} \) associated with direction \( \alpha \) by any multiple of the number of grid points \( M_{\alpha} \) along direction \( \alpha \). That is, for any DFT \( \tilde{F} \),  </p><p class="formulaDsp">
\[
  \tilde{F}(n_{0} + k_{0}M_{0}, \ldots, n_{D-1} + k_{D-1}M_{D-1}
  = \tilde{F}(n_{0}, \ldots, n_{D-1})
\]
</p>
<p> for any choice of integers \( k_{0}, \ldots, k_{D=1} \). To show this, we simply note that the effect of changing \( n_{\alpha}\) to \( n_{\alpha} + k_{\alpha} M_{\alpha} \) within the <a class="el" href="user_fourier_page.html#user_fourier_dftdef_eqn">sum</a> that defines \( \tilde{f} \) is to shift the argument of the exponential by a corresponding integer multiple \( m_{\alpha}k_{\alpha}2\pi i \) of \( 2\pi i \), which has no effect on the value of the exponential.</p>
<p >This periodic property of discrete Fourier transforms is sometimes referred to as "aliasing" of wavevectors. Any list of D Miller indices \( n_{0}, \ldots, n_{D-1} \) can be used to construct an associated reciprocal lattice wavevector \( {\bf G}(n_0, \ldots, n_{D-1}) \) in which the Miller indices are components of the vector in a basis of reciprocal lattice basis vectors, as <a class="el" href="user_fourier_page.html#user_fourier_Gofn_eqn">above</a>. Two lists of integer Miller indices are referred to as "aliases" of one another if these lists contain values for each index \( n_{i} \) that are either equal or differ by some nonzero integer multiple of the number \( N_{i} \) of grid points along direction \( i \), for each \( i = 0, \ldots , D-1 \) . Reciprocal lattice vectors for which the Miller indices are aliases are also said to be aliases of one another. Reciprocal lattice vectors that are aliases of one another yield values for the complex exponential \( \exp( i {\bf G}\cdots {\bf r} ) \) that are equal for any position vector \( {\bf r} \) that is a node of the relevant grid, but that are generally unequal for values of \( {\bf r} \) that do not lie on this grid. Wavevectors that are aliases of one another are thus treated as equivalent within forward and inverse DFT operations, in which values of the underlying field are only defined on the nodes of a grid.</p>
<h1><a class="anchor" id="user_fourier_kindex_sec"></a>
Wavevector Indexing Schemes</h1>
<p >The phenomena of aliasing of wavevectors for fields that are defined on a grid means that there are infinite number of ways of defining Miller indices so as to generate aliases of a particular wavevector, by adding or subtracting integer multiples of the number of grid points to each index. Two different conventions are used in PSCF assign a unique list of indices to each wavevector within a DFT. We refer to the resulting conventions for lists of indices here as (1) discrete Fourier transform or DFT indices and (2) Minimal indices.</p>
<h2><a class="anchor" id="user_fourier_dftindex_sub"></a>
Standard or DFT Indices</h2>
<p >The DFT indices of a wavevector are defined such that the index \( n_{i} \) associated with reduced coordinate \( i \) is required to be in the range \( 0, \ldots, N_{i} - 1 \), where \( N_{i} \) is the number of grid points in direction \( i \). This is the indexing scheme used in the above definitions of the forward and inverse DFT operations.</p>
<h2><a class="anchor" id="user_fourier_minindex_sub"></a>
Minimal or Brillouin Zone (BZ) Indices</h2>
<p >The minimal indices of a wavevector are indices that are chosen so as to give a corresponding Cartesian wavevector \( {\bf G}(n_{0}, \ldots, n_{D-1}) \) as defined <a class="el" href="user_fourier_page.html#user_fourier_Gofn_eqn">above</a> for which the magnitude \( |{\bf G}| \) is minimum. The indices obtained using this convention are referred to in parts of the PSCF source code as "Brillouin zone" indices because the underlying geometrical construction is analogous to that used to define the first Brillouin zone for crystal wavevectors in band theories electronic state in crystalline solids.</p>
<p >If two or more equivalent choices of indices for a wavevector yield wavevector aliases for which \( |{\bf G}| \) is equal to its minimum possible value, then the minimal indices are defined to be the choice which for which the indices are "maximum" when lists of indices are compared while giving priority to indices that appear earlier in a list \( (n_{0}, \ldots, n_{D-1}) \), thus ordering first by \( n_{0} \), then ordering choices with equal values of \( n_{0} \) in order of increasing \( n_{1} \), etc.</p>
<p ><em> Relationship to source code: </em> The standard (or DFT) and minimal (or Brillouin zone) indexes of each wavevector used in a DFT are assigned to each wavevector within the Pscf::Basis&lt;D&gt; class.</p>
<p ><br  />
 <a class="el" href="user_theory_page.html">Appendix: Self-Consistent Field Theory</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_page.html">User Guide</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_symmetry_page.html">Appendix: Space Group Symmetry</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Mar 4 2023 17:08:24 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
