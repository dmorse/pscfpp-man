<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: Pscf::Prdc::Cpu::WaveList&lt; D &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v1.3.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',false);
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a href="namespacePscf.html">Pscf</a></li><li class="navelem"><a href="namespacePscf_1_1Prdc.html">Prdc</a></li><li class="navelem"><a href="namespacePscf_1_1Prdc_1_1Cpu.html">Cpu</a></li><li class="navelem"><a href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">WaveList</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Pscf::Prdc::Cpu::WaveList&lt; D &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class to calculate and store properties of wavevectors.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="cpu_2WaveList_8h_source.html">WaveList.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3f09b8cd793b6a0cd026cb812dc69361" id="r_a3f09b8cd793b6a0cd026cb812dc69361"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f09b8cd793b6a0cd026cb812dc69361">WaveList</a> (bool <a class="el" href="#a5e358a6610517aba9a890f67120f048f">isRealField</a>=true)</td></tr>
<tr class="memdesc:a3f09b8cd793b6a0cd026cb812dc69361"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="memitem:a44796a8710696c879fd86ecc31ea0a79" id="r_a44796a8710696c879fd86ecc31ea0a79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44796a8710696c879fd86ecc31ea0a79">~WaveList</a> ()</td></tr>
<tr class="memdesc:a44796a8710696c879fd86ecc31ea0a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="memitem:a50ee7736fe34abc1db0065ab78856a10" id="r_a50ee7736fe34abc1db0065ab78856a10"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50ee7736fe34abc1db0065ab78856a10">allocate</a> (<a class="el" href="classPscf_1_1Mesh.html">Mesh</a>&lt; D &gt; const &amp;m, <a class="el" href="classPscf_1_1Prdc_1_1UnitCell.html">UnitCell</a>&lt; D &gt; const &amp;c)</td></tr>
<tr class="memdesc:a50ee7736fe34abc1db0065ab78856a10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory and set association with a <a class="el" href="classPscf_1_1Mesh.html" title="Description of a regular grid of points in a periodic domain.">Mesh</a> and <a class="el" href="classPscf_1_1Prdc_1_1UnitCell.html" title="Base template for UnitCell&lt;D&gt; classes, D=1, 2 or 3.">UnitCell</a> object.  <br /></td></tr>
<tr class="memitem:a206b13933d1170f1355972a65b75fc6d" id="r_a206b13933d1170f1355972a65b75fc6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a206b13933d1170f1355972a65b75fc6d">clearUnitCellData</a> ()</td></tr>
<tr class="memdesc:a206b13933d1170f1355972a65b75fc6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all internal data that depends on lattice parameters.  <br /></td></tr>
<tr class="memitem:a4efe117979d5215925bc7560ff36bffa" id="r_a4efe117979d5215925bc7560ff36bffa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4efe117979d5215925bc7560ff36bffa">computeMinimumImages</a> ()</td></tr>
<tr class="memdesc:a4efe117979d5215925bc7560ff36bffa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute minimum images of wavevectors.  <br /></td></tr>
<tr class="memitem:a5202623529f429c346dd92481482de05" id="r_a5202623529f429c346dd92481482de05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5202623529f429c346dd92481482de05">computeKSq</a> ()</td></tr>
<tr class="memdesc:a5202623529f429c346dd92481482de05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute sq.  <br /></td></tr>
<tr class="memitem:a37594f5ed3e4dca3d2dbaeb69ae28446" id="r_a37594f5ed3e4dca3d2dbaeb69ae28446"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37594f5ed3e4dca3d2dbaeb69ae28446">computedKSq</a> ()</td></tr>
<tr class="memdesc:a37594f5ed3e4dca3d2dbaeb69ae28446"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute derivatives of |k|^2 w/ respect to unit cell parameters.  <br /></td></tr>
<tr class="memitem:a289226cc7e48c32d7ae4b47d8287c4b9" id="r_a289226cc7e48c32d7ae4b47d8287c4b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classUtil_1_1DArray.html">DArray</a>&lt; <a class="el" href="classPscf_1_1IntVec.html">IntVec</a>&lt; D &gt; &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a289226cc7e48c32d7ae4b47d8287c4b9">minImages</a> () const</td></tr>
<tr class="memdesc:a289226cc7e48c32d7ae4b47d8287c4b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the array of minimum image vectors by const reference.  <br /></td></tr>
<tr class="memitem:a93295f47317abe89da3c7edc0d06c288" id="r_a93295f47317abe89da3c7edc0d06c288"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93295f47317abe89da3c7edc0d06c288">kSq</a> () const</td></tr>
<tr class="memdesc:a93295f47317abe89da3c7edc0d06c288"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the kSq array on the device by const reference.  <br /></td></tr>
<tr class="memitem:acb71510541b9d1c58fb3b7140853a187" id="r_acb71510541b9d1c58fb3b7140853a187"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acb71510541b9d1c58fb3b7140853a187">dKSq</a> (int i) const</td></tr>
<tr class="memdesc:acb71510541b9d1c58fb3b7140853a187"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get derivatives of kSq with respect to unit cell parameter i.  <br /></td></tr>
<tr class="memitem:ae0c216ade9a6dc6ccd874ad4f6cb3bdd" id="r_ae0c216ade9a6dc6ccd874ad4f6cb3bdd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classUtil_1_1DArray.html">DArray</a>&lt; <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0c216ade9a6dc6ccd874ad4f6cb3bdd">dKSq</a> () const</td></tr>
<tr class="memdesc:ae0c216ade9a6dc6ccd874ad4f6cb3bdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get all derivatives of kSq with respect to unit cell parameters.  <br /></td></tr>
<tr class="memitem:af72d71ad6d6a3514b16c5801ff6acb56" id="r_af72d71ad6d6a3514b16c5801ff6acb56"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classUtil_1_1DArray.html">DArray</a>&lt; bool &gt; const &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af72d71ad6d6a3514b16c5801ff6acb56">implicitInverse</a> () const</td></tr>
<tr class="memdesc:af72d71ad6d6a3514b16c5801ff6acb56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the implicitInverse array by reference.  <br /></td></tr>
<tr class="memitem:aa89a56492640635cc76e0d36dd3f01e7" id="r_aa89a56492640635cc76e0d36dd3f01e7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa89a56492640635cc76e0d36dd3f01e7">isAllocated</a> () const</td></tr>
<tr class="memdesc:aa89a56492640635cc76e0d36dd3f01e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has memory been allocated for arrays?  <br /></td></tr>
<tr class="memitem:a50a7d8767f2e792684d9c7b687282444" id="r_a50a7d8767f2e792684d9c7b687282444"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a50a7d8767f2e792684d9c7b687282444">hasMinImages</a> () const</td></tr>
<tr class="memdesc:a50a7d8767f2e792684d9c7b687282444"><td class="mdescLeft">&#160;</td><td class="mdescRight">Have minimum images been computed?  <br /></td></tr>
<tr class="memitem:a6e81add8ff9faaa06baf7d60490058b6" id="r_a6e81add8ff9faaa06baf7d60490058b6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e81add8ff9faaa06baf7d60490058b6">hasKSq</a> () const</td></tr>
<tr class="memdesc:a6e81add8ff9faaa06baf7d60490058b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has the kSq array been computed?  <br /></td></tr>
<tr class="memitem:ab80dafa6da6cd4ff16a4daa6d3db00dc" id="r_ab80dafa6da6cd4ff16a4daa6d3db00dc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab80dafa6da6cd4ff16a4daa6d3db00dc">hasdKSq</a> () const</td></tr>
<tr class="memdesc:ab80dafa6da6cd4ff16a4daa6d3db00dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Has the dKSq array been computed?  <br /></td></tr>
<tr class="memitem:a5e358a6610517aba9a890f67120f048f" id="r_a5e358a6610517aba9a890f67120f048f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e358a6610517aba9a890f67120f048f">isRealField</a> () const</td></tr>
<tr class="memdesc:a5e358a6610517aba9a890f67120f048f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does this <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html" title="Class to calculate and store properties of wavevectors.">WaveList</a> correspond to real-valued fields?  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;int D&gt;<br />
class Pscf::Prdc::Cpu::WaveList&lt; D &gt;</div><p>Class to calculate and store properties of wavevectors. </p>
<p>In particular, minimum images, square norms of wavevectors (kSq), and derivatives of the square norms of wavevectors with respect to the lattice parameters (dKSq) are calculated and stored by this class.</p>
<p>Any time the lattice parameters change the <a class="el" href="#a206b13933d1170f1355972a65b75fc6d" title="Clear all internal data that depends on lattice parameters.">clearUnitCellData()</a> method should be called, which will effectively reset the <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html" title="Class to calculate and store properties of wavevectors.">WaveList</a> object so that the wavevector properties will need to be recalculated before being used.</p>
<p>This object calculates these wavevector properties for a mesh of grid points in k-space. If a calculation only requires real-valued fields, PSCF uses a reduced-size k-space mesh, as output by FFTW. However, a full-sized k-space mesh (the same size as the real-space mesh) is necessary when dealing with complex-valued fields. The k-space mesh used by a <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html" title="Class to calculate and store properties of wavevectors.">WaveList</a> object is determined by the parameter isRealField, which is assigned in the constructor and cannot later be changed. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00046">46</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>
</div><a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3f09b8cd793b6a0cd026cb812dc69361" name="a3f09b8cd793b6a0cd026cb812dc69361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f09b8cd793b6a0cd026cb812dc69361">&#9670;&#160;</a></span>WaveList()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::WaveList </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>isRealField</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">isRealField</td><td>Will this <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html" title="Class to calculate and store properties of wavevectors.">WaveList</a> be used for real-valued fields? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8tpp_source.html#l00029">29</a> of file <a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="cpu_2WaveList_8h_source.html#l00191">isRealField()</a>.</p>

</div>
</div>
<a id="a44796a8710696c879fd86ecc31ea0a79" name="a44796a8710696c879fd86ecc31ea0a79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44796a8710696c879fd86ecc31ea0a79">&#9670;&#160;</a></span>~WaveList()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::~<a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">WaveList</a> </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8tpp_source.html#l00043">43</a> of file <a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a>.</p>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a50ee7736fe34abc1db0065ab78856a10" name="a50ee7736fe34abc1db0065ab78856a10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50ee7736fe34abc1db0065ab78856a10">&#9670;&#160;</a></span>allocate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::allocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPscf_1_1Mesh.html">Mesh</a>&lt; D &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPscf_1_1Prdc_1_1UnitCell.html">UnitCell</a>&lt; D &gt; const &amp;</td>          <td class="paramname"><span class="paramname"><em>c</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory and set association with a <a class="el" href="classPscf_1_1Mesh.html" title="Description of a regular grid of points in a periodic domain.">Mesh</a> and <a class="el" href="classPscf_1_1Prdc_1_1UnitCell.html" title="Base template for UnitCell&lt;D&gt; classes, D=1, 2 or 3.">UnitCell</a> object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>spatial discretization mesh (input) </td></tr>
    <tr><td class="paramname">c</td><td>crystallographic unit cell (input) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8tpp_source.html#l00050">50</a> of file <a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="MeshIterator_8h_source.html#l00141">Pscf::MeshIterator&lt; D &gt;::atEnd()</a>, <a class="el" href="MeshIterator_8tpp_source.html#l00061">Pscf::MeshIterator&lt; D &gt;::begin()</a>, <a class="el" href="cpu_2WaveList_8tpp_source.html#l00103">clearUnitCellData()</a>, <a class="el" href="cpu_2FFT_8tpp_source.html#l00262">Pscf::Prdc::Cpu::FFT&lt; D &gt;::computeKMesh()</a>, <a class="el" href="cpu_2FFT_8h_source.html#l00271">Pscf::Prdc::Cpu::FFT&lt; D &gt;::hasImplicitInverse()</a>, <a class="el" href="UnitCellBase_8h_source.html#l00307">Pscf::Prdc::UnitCellBase&lt; D &gt;::nParameter()</a>, <a class="el" href="MeshIterator_8h_source.html#l00122">Pscf::MeshIterator&lt; D &gt;::position()</a>, <a class="el" href="MeshIterator_8h_source.html#l00136">Pscf::MeshIterator&lt; D &gt;::rank()</a>, <a class="el" href="Mesh_8h_source.html#l00229">Pscf::Mesh&lt; D &gt;::size()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="a206b13933d1170f1355972a65b75fc6d" name="a206b13933d1170f1355972a65b75fc6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a206b13933d1170f1355972a65b75fc6d">&#9670;&#160;</a></span>clearUnitCellData()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::clearUnitCellData </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear all internal data that depends on lattice parameters. </p>
<p>Sets hasKSq_ and hasdKSq_ to false. Sets hasMinImages_ to false only if the unit cell type has variable angles. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8tpp_source.html#l00103">103</a> of file <a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="namespacePscf_1_1Prdc.html#a2a0af186f09223ed95696594f988b448">Pscf::Prdc::hasVariableAngle()</a>.</p>

<p class="reference">Referenced by <a class="el" href="cpu_2WaveList_8tpp_source.html#l00050">allocate()</a>.</p>

</div>
</div>
<a id="a4efe117979d5215925bc7560ff36bffa" name="a4efe117979d5215925bc7560ff36bffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4efe117979d5215925bc7560ff36bffa">&#9670;&#160;</a></span>computeMinimumImages()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::computeMinimumImages </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute minimum images of wavevectors. </p>
<p>(Also calculates kSq.)</p>
<p>The minimum images may change if a lattice angle in the unit cell is changed, so this method should be called whenever such changes occur.</p>
<p>In the process of computing the minimum images, the square norm |k|^2 for all wavevectors is also calculated and stored, so it is not necessary to call computeKSq after calling this method. computeKSq is provided to allow calculation of kSq without recalculating minimum images. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8tpp_source.html#l00116">116</a> of file <a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="MeshIterator_8h_source.html#l00141">Pscf::MeshIterator&lt; D &gt;::atEnd()</a>, <a class="el" href="MeshIterator_8tpp_source.html#l00061">Pscf::MeshIterator&lt; D &gt;::begin()</a>, <a class="el" href="MeshIterator_8h_source.html#l00122">Pscf::MeshIterator&lt; D &gt;::position()</a>, <a class="el" href="MeshIterator_8h_source.html#l00136">Pscf::MeshIterator&lt; D &gt;::rank()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

<p class="reference">Referenced by <a class="el" href="cpu_2WaveList_8tpp_source.html#l00175">computedKSq()</a>, and <a class="el" href="cpu_2WaveList_8tpp_source.html#l00143">computeKSq()</a>.</p>

</div>
</div>
<a id="a5202623529f429c346dd92481482de05" name="a5202623529f429c346dd92481482de05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5202623529f429c346dd92481482de05">&#9670;&#160;</a></span>computeKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::computeKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute sq. </p>
<p>norm |k|^2 for all wavevectors, using existing min images. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8tpp_source.html#l00143">143</a> of file <a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="MeshIterator_8h_source.html#l00141">Pscf::MeshIterator&lt; D &gt;::atEnd()</a>, <a class="el" href="MeshIterator_8tpp_source.html#l00061">Pscf::MeshIterator&lt; D &gt;::begin()</a>, <a class="el" href="cpu_2WaveList_8tpp_source.html#l00116">computeMinimumImages()</a>, <a class="el" href="MeshIterator_8h_source.html#l00136">Pscf::MeshIterator&lt; D &gt;::rank()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="a37594f5ed3e4dca3d2dbaeb69ae28446" name="a37594f5ed3e4dca3d2dbaeb69ae28446"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37594f5ed3e4dca3d2dbaeb69ae28446">&#9670;&#160;</a></span>computedKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::computedKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute derivatives of |k|^2 w/ respect to unit cell parameters. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8tpp_source.html#l00175">175</a> of file <a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a>.</p>

<p class="reference">References <a class="el" href="MeshIterator_8h_source.html#l00141">Pscf::MeshIterator&lt; D &gt;::atEnd()</a>, <a class="el" href="MeshIterator_8tpp_source.html#l00061">Pscf::MeshIterator&lt; D &gt;::begin()</a>, <a class="el" href="cpu_2WaveList_8tpp_source.html#l00116">computeMinimumImages()</a>, <a class="el" href="MeshIterator_8h_source.html#l00136">Pscf::MeshIterator&lt; D &gt;::rank()</a>, and <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="a289226cc7e48c32d7ae4b47d8287c4b9" name="a289226cc7e48c32d7ae4b47d8287c4b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a289226cc7e48c32d7ae4b47d8287c4b9">&#9670;&#160;</a></span>minImages()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classUtil_1_1DArray.html">DArray</a>&lt; <a class="el" href="classPscf_1_1IntVec.html">IntVec</a>&lt; D &gt; &gt; const  &amp; <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cpu::WaveList</a>&lt; D &gt;::minImages </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the array of minimum image vectors by const reference. </p>
<p>This function returns an array in which each element is an <a class="el" href="classPscf_1_1IntVec.html" title="An IntVec&lt;D, T&gt; is a D-component vector of elements of integer type T.">IntVec&lt;D&gt;</a> containing the integer coordinates of the minimum image of one wavevector in the k-space mesh used for the DFT. If isRealField is true, this k-space mesh is smaller than the real-space mesh. Otherwise, it is the same size. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00260">260</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="a93295f47317abe89da3c7edc0d06c288" name="a93295f47317abe89da3c7edc0d06c288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93295f47317abe89da3c7edc0d06c288">&#9670;&#160;</a></span>kSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const  &amp; <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::kSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the kSq array on the device by const reference. </p>
<p>This function returns an array in which each element is the square magnitude |k|^2 of a wavevector k in the k-space mesh used for the DFT. If isRealField is true, this k-space mesh is smaller than the real-space mesh. Otherwise, it is the same size. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00269">269</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="acb71510541b9d1c58fb3b7140853a187" name="acb71510541b9d1c58fb3b7140853a187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb71510541b9d1c58fb3b7140853a187">&#9670;&#160;</a></span>dKSq() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; const  &amp; <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::dKSq </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>i</em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get derivatives of kSq with respect to unit cell parameter i. </p>
<p>Each element contains the derivative of the square-wavevector with respect to unit cell parameter i, multiplied by a prefactor. The prefactor is 2.0 for waves that have an implicit inverse and 1.0 otherwise. The choice of prefactor is designed to simplify use of the array to compute stress.</p>
<p>Each element corresponds to one wavevector k in the k-space mesh used for the DFT. If isRealField is true, this k-space mesh is smaller than the real-space mesh. Otherwise, it is the same size. In the latter case, there are no implicit waves, so the prefactor is always 1.0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>index of lattice parameter </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00278">278</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="ae0c216ade9a6dc6ccd874ad4f6cb3bdd" name="ae0c216ade9a6dc6ccd874ad4f6cb3bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0c216ade9a6dc6ccd874ad4f6cb3bdd">&#9670;&#160;</a></span>dKSq() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classUtil_1_1DArray.html">DArray</a>&lt; <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html">RField</a>&lt; D &gt; &gt; const  &amp; <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cpu::WaveList</a>&lt; D &gt;::dKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get all derivatives of kSq with respect to unit cell parameters. </p>
<p>Element i of the <a class="el" href="classUtil_1_1DArray.html" title="Dynamically allocatable contiguous array template.">DArray</a> is the <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1RField.html" title="Field of real double precision values on an FFT mesh.">RField&lt;D&gt;</a> that can also be obtained from member function dKSq(int i). </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00287">287</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="af72d71ad6d6a3514b16c5801ff6acb56" name="af72d71ad6d6a3514b16c5801ff6acb56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af72d71ad6d6a3514b16c5801ff6acb56">&#9670;&#160;</a></span>implicitInverse()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPscf_1_1DeviceArray.html">DeviceArray</a>&lt; bool &gt; const  &amp; <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cuda::WaveList</a>&lt; D &gt;::implicitInverse </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the implicitInverse array by reference. </p>
<p>This array is defined on a k-grid mesh, with a boolean value for each gridpoint. The boolean represents whether the inverse of the wave at the given gridpoint is an implicit wave. Implicit here is used to mean any wave that is outside the bounds of the k-grid.</p>
<p>This method will throw an error if isRealField == false, because there are no implicit inverses in such a case. </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00296">296</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

<p class="reference">References <a class="el" href="global_8h_source.html#l00068">UTIL_CHECK</a>.</p>

</div>
</div>
<a id="aa89a56492640635cc76e0d36dd3f01e7" name="aa89a56492640635cc76e0d36dd3f01e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89a56492640635cc76e0d36dd3f01e7">&#9670;&#160;</a></span>isAllocated()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cpu::WaveList</a>&lt; D &gt;::isAllocated </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Has memory been allocated for arrays? </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00167">167</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

</div>
</div>
<a id="a50a7d8767f2e792684d9c7b687282444" name="a50a7d8767f2e792684d9c7b687282444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50a7d8767f2e792684d9c7b687282444">&#9670;&#160;</a></span>hasMinImages()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cpu::WaveList</a>&lt; D &gt;::hasMinImages </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Have minimum images been computed? </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00173">173</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

</div>
</div>
<a id="a6e81add8ff9faaa06baf7d60490058b6" name="a6e81add8ff9faaa06baf7d60490058b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e81add8ff9faaa06baf7d60490058b6">&#9670;&#160;</a></span>hasKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cpu::WaveList</a>&lt; D &gt;::hasKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Has the kSq array been computed? </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00179">179</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

</div>
</div>
<a id="ab80dafa6da6cd4ff16a4daa6d3db00dc" name="ab80dafa6da6cd4ff16a4daa6d3db00dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab80dafa6da6cd4ff16a4daa6d3db00dc">&#9670;&#160;</a></span>hasdKSq()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cpu::WaveList</a>&lt; D &gt;::hasdKSq </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Has the dKSq array been computed? </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00185">185</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

</div>
</div>
<a id="a5e358a6610517aba9a890f67120f048f" name="a5e358a6610517aba9a890f67120f048f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e358a6610517aba9a890f67120f048f">&#9670;&#160;</a></span>isRealField()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int D&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html">Pscf::Prdc::Cpu::WaveList</a>&lt; D &gt;::isRealField </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Does this <a class="el" href="classPscf_1_1Prdc_1_1Cpu_1_1WaveList.html" title="Class to calculate and store properties of wavevectors.">WaveList</a> correspond to real-valued fields? </p>

<p class="definition">Definition at line <a class="el" href="cpu_2WaveList_8h_source.html#l00191">191</a> of file <a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="cpu_2WaveList_8tpp_source.html#l00029">WaveList()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cpu_2WaveList_8h_source.html">cpu/WaveList.h</a></li>
<li><a class="el" href="cpu_2WaveList_8tpp_source.html">cpu/WaveList.tpp</a></li>
<li><a class="el" href="cuda_2WaveList_8h_source.html">cuda/WaveList.h</a></li>
<li><a class="el" href="cuda_2WaveList_8tpp_source.html">cuda/WaveList.tpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on <span class="timestamp"></span> for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
