<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: 3.3.6 pscf_fd (1D Problems)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v0.9</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="user_page.html">3 User Guide</a></li><li class="navelem"><a class="el" href="user_param_page.html">3.3 Parameter Files</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">3.3.6 pscf_fd (1D Problems) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="user_param_sweep_page.html">3.3.5 Parameter Sweeps</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_param_pc_page.html">3.3.7 pscf_pc (Periodic Problems, CPU)</a> (Next) <br  />
</p>
<p >The pscf_fd program allows the solution of the SCFT field equations for problems in which all fields depend only on a single coordinate in a planar planar (Cartesian), cylindrical or spherical geometry. This program may be used to treat a flat interface or thin film by using a planar geometry, or can treat curved interfaces and a cylindrical or spherical micelles by using a cylindrical or spherical coordinate by using a cylindrical or spherical geometry. An example of a parameter file for an pscf_fd program was given <a class="el" href="user_param_example_page.html">previously</a> as an example of the syntax. Please consult this example when looking at this discussion of the file format.</p>
<p >The overall format for a pscf_fd parameter file is shown below in skeleton form: </p><div class="fragment"><div class="line">System{</div>
<div class="line">  Mixture{ ...  }</div>
<div class="line">  Interaction{ ...  }</div>
<div class="line">  Domain{ ...  }</div>
<div class="line">  Iterator#{ ... }</div>
<div class="line">  Sweepr#*{ ... }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The purposes of each of these top-level blocks have been discussed previously. The Mixture and Interaction blocks use the same format for all PSCF programs, and have also been discussed previously. We thus focus below on the contents of the Domain, Iterator, and Sweep blocks.</p>
<h1><a class="anchor" id="user_param_fd_domain_section"></a>
Domain Block</h1>
<p >The domain block describes the spatial domain over which the SCFT equations should be solved. The parameter file syntax is described in detail <a class="el" href="fd1d_Domain_page.html">here</a>, and also discussed below.</p>
<p >The example parameter file shown <a class="el" href="user_param_example_page.html">previously</a> was designed to describe a planar geometry. As another example, here is the Domain block for a simulation of a spherical micelle</p>
<div class="fragment"><div class="line">Domain{</div>
<div class="line">  mode   spherical</div>
<div class="line">  xMax   8.0</div>
<div class="line">  nx     201</div>
<div class="line">}</div>
</div><!-- fragment --><p> This example omits an optional parameter xMin that, when present, would appear immediately before xMax.</p>
<p >The value of the mode parameter is an enumuration that specifies the coordinate system. The allowed values for the value of this parameter "planar", "cylindrical" or "spherical".</p>
<p >The parameters xMin and xMax specify the minimum and maximum values of the relevant spatial coordinate. The parameter xMin is optional, and is set to 0.0 default when the parameter is omitted. In "planar" mode, xMin and xMax are the minimum and maximum values of a Cartesian coordinate, defining a slit bounded bounded by constant values of this coordinate. In "cylindrical" and "spherical" mode, these are minimum and maximum values of a radial coordinate. In cylindrical or spherical mode, xMin can be omitted to define a simply connected circular or spherical domain of radius equal to xMax, or included and assigned a positive value to define a cylindrical or spherical annular region of inner radius xMin and outer radius xMax.</p>
<p >The parameter nx specifies the number of equally spaced grid points that will be used to discretize the spatial domain. Because this includes both end-points, the number of grid points is is one greater than the number of spatial steps. The distance between grid points in the underlying finite difference discretization, denoteed by dx, is thus given by dx = (xMax - xMin)/(nx-1).</p>
<p >The pscf_fd program solves the modified diffusion equation subject to von Neumann boundary conditions that require derivatives with respect to the relevant Cartesian or radial normal coordinate must vanish at the lower and upper bounds, xMin and xMax. In the special case of a cylindrical or spherical geometry, for which xMin = 0.0, the requirement of a vanishing radial derivative at x=0 is necessary to guarantee that the solution is differential at the origin.</p>
<h1><a class="anchor" id="user_param_fd_iterator_sec"></a>
Iterators</h1>
<p >The Iterator block provides data required by the iterator used to solve the nonlinear self-consistent field (SCF) equations. <br  />
</p>
<p >The default iterator for pscf_fd is a Newton-Raphson iterator that is implemented by a class named NrIterator. Because this is the default iterator, it may be chosen by including an iterator block in which the first line contains either the generic label "Iterator" or the specific class name "NrIterator". <br  />
</p>
<p >The only other iterator currently provided for us in pscf_fd is a simple relaxation iterator for systems with only two types of monomer. This iterator uses the algorithm presented by F. Drolet and G.H. Fredrickson and is implemented by a class named FdIterator.</p>
<p >More detailed documentation of the input format for each available iterator is given in the links in the table below:</p>
<table class="doxtable">
<tr>
<td>Class  </td><td>Description   </td></tr>
<tr>
<td><a class="el" href="fd1d_NrIterator_page.html">NrIterator</a>  </td><td>Newton-Raphson iterator   </td></tr>
<tr>
<td><a class="el" href="fd1d_FdIterator_page.html">FdIterator</a>  </td><td>Relaxation algorithm for AB (two monomer) systems, as described by Fredrickson and Drolet   </td></tr>
</table>
<p >This Newton-Raphson iterator requires only one input parameter, the real parameter epsilon, which gives the desired tolerance in the solution of the SCF equations. The iterative loop stops when the scalar error (computed as the maximum absolute value of an element of the residual vector) becomes less then epsilon.</p>
<p >The NrIterator parameter block is also described <a class="el" href="fd1d_NrIterator_page.html">here</a>.</p>
<h1><a class="anchor" id="user_param_fd_sweep_sec"></a>
Sweep</h1>
<p >The default sweep for pscf_fd is a linear sweep algorithm that can be invoked using a block that starts either with the generic label Sweep or the specific label LinearSweep. The required parameter file format has been described <a class="el" href="user_param_sweep_page.html#user_param_sweep_linear_sec">here</a>.</p>
<p ><br  />
 <a class="el" href="user_param_sweep_page.html">3.3.5 Parameter Sweeps</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_param_page.html">3.3 Parameter Files</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_param_pc_page.html">3.3.7 pscf_pc (Periodic Problems, CPU)</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 26 2022 14:10:42 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
