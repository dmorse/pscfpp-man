<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PSCF: 3.2.2 Parameter Files for pscf_fd</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PSCF<span id="projectnumber">&#160;v0.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">PSCF - Polymer Self-Consistent Field Theory</a></li><li class="navelem"><a class="el" href="user_page.html">3 User Guide</a></li><li class="navelem"><a class="el" href="user_param_page.html">3.2 Parameter Files</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">3.2.2 Parameter Files for pscf_fd </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="el" href="user_param_page.html">3.2 Parameter Files</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_param_pc_page.html">3.2.3 Parameter files for pscf_pcNd</a> (Next) <br  />
</p>
<h1><a class="anchor" id="user_param_fd_section"></a>
Example</h1>
<p >An example of a parameter file for an pscf_fd program is shown below.</p>
<p >This example gives parameters for a calculation of a ternary mixture of two hompolymers of types A and B, and an AB diblock copolymer in a slit geometry. The system contains 40% of each hopolymer and 20% copopolymer by volume. All three chains are of length 1.0 in the system of units used in this input file, and the diblock copolymer is symmetric (each block has length 1/2). The AB interaction parameter has a value of 10, which is high enough to guarantee that homopolymer phase separate and the copolymer will self-assemble along an interface between A and B. The simulation uses a 1D planar geometry, in which variation occurs only along one axis of a Cartesian coordinate system. The natural equilibrium state for this system would be a monolayer of AB diblock copolymer along an interface between regions of nearly pure A and B homopolymer, with the interface near the middle of the slit. The syntax for specifying polymer structures and other aspects of the parameter file is described in detail below.</p>
<div class="fragment"><div class="line">System{</div>
<div class="line">  Mixture{</div>
<div class="line">     nMonomer   2</div>
<div class="line">     monomers   A   1.0  </div>
<div class="line">                B   1.0 </div>
<div class="line">     nPolymer   2</div>
<div class="line">     Polymer{</div>
<div class="line">        type    linear</div>
<div class="line">        nBlock  1</div>
<div class="line">        blocks  0   1.0</div>
<div class="line">        phi     0.4</div>
<div class="line">     }</div>
<div class="line">     Polymer{</div>
<div class="line">        type    linear</div>
<div class="line">        nBlock  1</div>
<div class="line">        blocks  1   1.0</div>
<div class="line">        phi     0.4</div>
<div class="line">     }</div>
<div class="line">     Polymer{</div>
<div class="line">        nBlock  2</div>
<div class="line">        blocks  0   0.5</div>
<div class="line">                1   0.5</div>
<div class="line">        phi     0.2</div>
<div class="line">     }</div>
<div class="line">     vMonomer   1.0</div>
<div class="line">     ds   0.01</div>
<div class="line">  }</div>
<div class="line">  ChiInteraction{</div>
<div class="line">     chi   0    1    10.0</div>
<div class="line">           0    0     0.0</div>
<div class="line">           1    1     0.0</div>
<div class="line">  }</div>
<div class="line">  Domain{</div>
<div class="line">     mode planar</div>
<div class="line">     xMin 0.0</div>
<div class="line">     xMax 8.0</div>
<div class="line">     nx   401</div>
<div class="line">  }</div>
<div class="line">  NrIterator{</div>
<div class="line">     epsilon   0.00000001</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="user_param_fd_syntax_section"></a>
Syntax</h1>
<p >Any PSCF parameter file, including the above example one, contains a series of nested blocks that are delimited by opening and closing curly braces. The syntax is thus reminiscent of that of a C program (without semicolons). Each block begins with a capitalized label for the block followed by an opening curly bracket on the same line and ends with a closing bracket on a line by itself, as in as in </p><div class="fragment"><div class="line">BlockName{</div>
<div class="line">   ....</div>
<div class="line">}</div>
</div><!-- fragment --><p> Each block may contain a combination of parameter values and nested subblocks. Most parameters are given on a single line containing the parameter name followed by a value, or a list of several related values. The order of elements within each block of a parameter file is generally predefined, though some elements may be optional.</p>
<p >Names of blocks in a parameter file generally correspond to names of classes or class templates in the underlying C++ code. The nesting of blocks reflects ownership or "has a" relationships among C++ classes: Each subblock generally corresponds to an object of is either a member of the parent class or a dynamically created object that the parent object is responsible for creating and destroying. The outermost block in the above example is a "System" block, reflecting the fact that main object in the underlying code for a 1D finite-difference program is an instance of class <a class="el" href="classPscf_1_1Fd1d_1_1System.html" title="Main class in SCFT simulation of one system.">Pscf::Fd1d::System</a>.</p>
<p >Names of individual parameters within a parameter file block generally correspond to names of member variables in the relevant class, i.e., member variables of the class whose name is specfied by the name of the innermost enclosing parameter file block. Parameters that represent primitive C data types (e.g., integers or floating point numbers) or strings are represented by a label (the variable name) followed by a single value on the same line. Parameters that represent instances of a user defined type that has an overloaded "&gt;&gt;" input operator are displayed as a label followed by the text representation of that type, as defined by the implementation of the "&gt;&gt;" input operator for that data type. Parameters that represent arrays of values are formatted in a multi-line format in which the first row contains a label (the name of the array) and the value of the first element, and subsequent lines contain subsequent elements. Because this format does not have a distinctive delimiter after the last element, it requires that the number of elements be known before such an array is read. The number of elements in an array-valued parameter is thus always specified by the the value of a parameter that appears before that array in the file format.</p>
<h1><a class="anchor" id="user_param_fd_overview_section"></a>
File Structure</h1>
<p >The structure of the main required blocks of a pscf_fd parameter file is shown below in skeleton form. </p><div class="fragment"><div class="line">System{</div>
<div class="line">  Mixture{</div>
<div class="line">     ...</div>
<div class="line">  }</div>
<div class="line">  ChiInteraction{</div>
<div class="line">     ...</div>
<div class="line">  }</div>
<div class="line">  Domain{</div>
<div class="line">     ...</div>
<div class="line">  }</div>
<div class="line">  NrIterator{</div>
<div class="line">     ...</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The purposes of each main block is discussed below. </p><ul>
<li>
Mixture: The Mixture block contains a description of the desired mixture of containing one or more polymer species. This includes a description of the structure of each molecular species and a specification of either the volume fraction phi or chemical mu of each species.  </li>
<li>
ChiInteraction: This block contains values for the Flory-Huggins chi parameters between all pairs of monomers types.  </li>
<li>
Domain: The domain block specifies the coordinate system and domain over which the SCFT equations should be solved, and the number of grid points used for spatial discretization.  </li>
<li>
NrIterator: The NrIterator block gives parameters required by the Newton-Raphson iteration algorithm used to solve the nonlinear SCFT equations.  </li>
</ul>
<p>The parameter files for the pscf_pcNd and Pscf_pgNd programs have a similar structure, with analogous top level blocks. Parameter files for all three types of program contain Mixture and ChiInteraction blocks with identical syntax.</p>
<h1><a class="anchor" id="user_param_fd_mixture_section"></a>
Mixture Block</h1>
<p >The Mixture block describes the chemical constituents of the system of interest, which is generally a mixture of one or more molecular species.</p>
<p >The first part of the Mixture block contains information about monomers The parameter nMonomer and the array give information about monomer types. The value of the parameter labelled "nMonomer" gives the number of distinct types of monomer in the system. Parameter "monomers" represents an array in which each element corresponds to one monomer type. The file format for this array contains nMonomer rows, each of which contains a description of one monomer type. Each such row (after the "monomers" label in the first row) contains an integer monomer index, a monomer label string, and a statistical segment length, in that order. In the above example, two monomer types with integer ids 0 and 1 are assigned labels 'A' and 'B', and are both assigned a statistical segment length of 1.0.</p>
<p >After this monomer type information, the Mixture block contains information about polymer species. The parameter nPolymer specifies the number of distinct polymer species in the mixture. This may be followed by an optional parameter nSolvent that specifies the number of small molecule solvent species. If nSolvent is absent, it is set zero by default, corresponding to a system with no small molecule solvent. The optional nSolvent parameter is absent in the above example.</p>
<p >The nPolymer and (optional) nSolvent parameters are always followed by nPolymer subblocks that each begin with a label Polymer{ ...}. Each such Polymer block describes a species of block polymer that is present in the system of interest. Homopolymer species are treated for this purpose as a block polymer that contain only one block. If the nSolvent parameter is present and greater than zero, the Polymer{...} blocks must be followed nSolvent sublocks labelled Solvent{...}, each of which describes a solvent species.</p>
<p >The Polymer and (if present) Solvent blocks may be followed by an optional parameter vMonomer that gives a value for the monomer reference volume. This optional parameter is absent in the above example. The value of vMonomer is not needed or used in the solution of the modified diffusion equations or self-consistent field equations. It can, however, be used in calculations of some physical quantities whose definition require knowledge of the total volume or total number of molecules in some aggregate, such as the total excess free energy of a micelle. If this optional parameter is absent, vMonomer is assigned a value of 1.0 by default.</p>
<p >The last entry in the Mixture block gives the value of a parameter ds. Parameter ds is the desired value of the contour length step used to discretize the length of each block during numerical solution of the modified diffusion equation. Both the contour step length ds and the block lengths for each polymer are specified in the same units, as numbers of monomers. Because PSCF is based on a model of a polymer as a continuous Gaussian thread, however, neither block lengths nor values of ds need be integers, nor must they even approximately correspond to any kind of chemical repeat unit. Thus, if ds = 0.01, then a block of length 1.0 will thus be divided into 100 steps of length 0.1. The algorithm used in all of the pscf programs actually require that each block be divided into even number of steps of equal length. The number of steps for each block is thus chosen to give an actual step size as close as possible to the value of ds input by the user, subject to this constraint. The actual step size may thus also be slightly different for different blocks.</p>
<h2><a class="anchor" id="user_param_fd_mixture_polymer_sub"></a>
Polymer Block</h2>
<p >Each Polymer subblock within the Mixture block describes a single block polymer species. Each polymer is internally assigned a unique integer id that is assigned in the order in which polymer blocks appear in the parameter file, with an index 0 for the first polymer.</p>
<p >The first parameter that may appear within a Polymer block is an optional "type" variable. This may be assigned string values "linear" or "branched". If the type variable is omitted, the polymer is assumed to be linear by default. Setting the type to "linear" declares that the polymer is a linear block polymer. Setting the type to "branched" declares that the polymer is an acyclic branched block copolymer. The set of possible acyclic branched architectures includes all linear block polymers as a subset, and the set of linear block polymer architectures includes homopolymers as a subset. <a class="el" href="namespacePscf.html" title="Classes for polymer self-consistent field theory.">Pscf</a> cannot treat polymers architectures that contain closed loops or cycles, but allows arbitrarily complex acylic branched block polymers.</p>
<p >After the optional "type" parameter, each Polymer block must contain an parameter "nBlock" with a positive integer value that gives the total number of blocks in the polymer.</p>
<p >The nBlock parameter is followed by an array parameter "blocks" that contains nBlock rows of data, each of which contains a description of one block. The data associated with the first block is given in the same line as the label "blocks", with the remaining blocks on subsequent lines. Different file formats are used for the data associated with each block for linear and branched polymers. A more compact form is possible in the common case of a linear polymer.</p>
<p >For a linear polymer, the data for each block is of the form </p><div class="fragment"><div class="line">monomerId length</div>
</div><!-- fragment --><p> where monomerId is the integer id for the monomer type, and length is the length of the block. For either a linear or branched polymer, the length parameter for each block is a real number defined as the ratio of the steric volume of the block to a reference monomer volume.</p>
<p >A longer description must be used for each block in a branched polymer in order to specify the connectivity of the blocks. A branched polymer is described as an acyclic graph containing edges (corresponding to blocks) that terminate at vertices. Each vertex is either a junction at which two or more blocks meet or a chain ends. Each vertex is assigned a unique integer vertex index. The number of vertices in any acyclic graph is always exactly one greater than the number of edges (or blocks). The blocks are thus internally assigned integer ids [0,nBlock-1] while the edges are assigned indices [0,nBlock]. In the description of a branched polymer, the data for each block is of the form </p><div class="fragment"><div class="line">monomerId length vertexId1 vertexId2</div>
</div><!-- fragment --><p> where vertexId1 and vertexId2 are the integer ids of the two vertices to which the block is attached.</p>
<p >The last parameter in the Polymer{...} block associated with each species specifies either a volume fraction for that species, given by a line "phi" followed by a value for the volume fraction, or a value of the chemical potential for the species, given by a label "mu" followed by a chemical potential label. The code allows the user to independently choose whether to specify a volume fraction (a closed ensemble) or chemical potential (an ensemble) for each species. If one or more species are assigned volume fractions (phi values), the volume fractions must be less than or equal to 1.0. If all of the species are assigned volume fractions, corresponding to canonical ensemble, the specified volume fraction must add to exactly 1.0.</p>
<p >In the above example, nPolymer = 3, and so the mixture is a ternary mixture. <br  />
 The first Polymer{...} block describes a homopolymer (nBlock = 1 and nVertex = 2) of length 1.0 containing monomers of type 0 (or A). The second describes a homopolymer of length 1.0 with monomers of type 1 (or B). The third block describes a symmetric AB diblock copolymer with blocks of equal length 0.5.</p>
<h2><a class="anchor" id="user_param_fd_mixture_solvent_sub"></a>
Solvent Block</h2>
<p >If nSolvent &gt; 0, the Polymer{...} blocks are followed within a Mixture block by nSolvent blocks labelled Solvent{...}. Each Solvent block contains the description of a small molecule solvent species. Solvents are treated as structureless particles that occupy a specified volume. The first parameter in each Solvent block is "monomerId" parameter that specifies the monomer or chemical type of the solvent. This is followed by "size" parameter that specifies the steric volume, defined as a ratio of the solvent volume to the monomer reference volume. The next parameter must then be either volume fraction "phi" or chemical potential "mu". The parameter file block for a solvent of type 0 (or A) with a size 0.1 and a specified volume fraction 0.4 would thus be </p><div class="fragment"><div class="line">Solvent{</div>
<div class="line">   monomerId  0</div>
<div class="line">   size       0.1</div>
<div class="line">   phi        0.4</div>
<div class="line">}</div>
</div><!-- fragment --><p> As for polymers, the volume fraction parameter phi for a solvent species can be replaced by a chemical potential parameter "mu" to specify an open ensemble for this species.</p>
<p >See the file pscfpp/examples/pc/solution/lam/param for an example parameter file for a simulation of a periodic lamellar phase containing an AB block copolymer dissolved in a selective solvent of type C.</p>
<h1><a class="anchor" id="user_param_fd_ChiInteraction_section"></a>
ChiInteraction Block</h1>
<p >The ChiInteraction block specifies chi interaction parameters between all distinct monomer types. The "chi" parameter is an array in which each row contains a pair of monomer type labels followed by the value of the Flory-Huggins interaction parameter for interactions between monomers of those two types. In the above example, chi is set to 10.0 for interactions between monomers of type 0 and 1 (or A and B), and is set to zero for interactions between monomers of the same type.</p>
<h1><a class="anchor" id="user_param_fd_Domain_section"></a>
Domain Block</h1>
<p >The domain block describes the spatial domain over which the SCFT equations should be solved.</p>
<p >The pscf_fd program allows the solution of the SCFT field equations for a problem in which all fields depend only on a single coordinate in either planar (Cartesian), cylindrical or spherical geometry. The mode parameter specifies the coordinate system, and may have values "planar", "cylindrical" or "spherical".</p>
<p >The parameters xMin and xMax specify the minimum and maximum values of the relevant spatial coordinate. In "planar" mode, these are the minimum and maximum values of a Cartesian coordinate, defining a slit bounded by constant values of this coordinate. In "cylindrical" and "spherical" mode, these are minimum and maximum values of a radial coordinate. In general, the domain for a computation in cylindrical or spherical mode can be a cylindrical or spherical annulus, but a complete cylindrical or spherical region can be simulated by setting the value of xMin to 0.0.</p>
<p >The parameter nx specifies the number of equally spaced grid points to use to discretize the spatial domain. Because this includes both end-points, this is one greater than the number of spatial steps. In cylindrical and spherical mode, the program interprets any value xMin that is less than the step size (xMax - xMin/(nx-1) as equivalent to zero, and interprets that as a cylindrical or spherical domain that includes the origin rather than cylindrical or spherical annulus.</p>
<p >The pscf_fd program solves the modified diffusion equation subject to von Neumann boundary conditions that require derivatives with respect to the relevant Cartesian or radial normal coordinate must vanish at the lower and upper bounds, xMin and xMax. In the special case of a cylindrical or spherical geometry with xMin = 0.0, this is equivalent to a requirement that the corresponding three dimensional solution be differentiable at the origin.</p>
<h1><a class="anchor" id="user_param_fd_NrIterator_section"></a>
NrIterator Block</h1>
<p >The NrIterator block provides data required by the iterator used to solve the nonlinear self-consistent field (SCF) equations. The only iteration algorithm that is currently available is Newton-Raphson iteration, implemented by the NrIterator class. This class requires only one input parameter, the parameter epsilon, which gives the desired tolerance in the solution of the SCF equations. The iterative loop stops when the maximum error drops below epsilon.</p>
<p ><br  />
 <a class="el" href="user_param_page.html">3.2 Parameter Files</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_param_pc_page.html">3.2.3 Parameter files for pscf_pcNd</a> (Next) </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 31 2022 13:32:18 for PSCF by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
